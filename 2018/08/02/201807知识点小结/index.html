<!doctype html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="月报," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="关闭隐式动画1234CATransaction.begin()CATransaction.setDisableActions(true)self.layer.frame = self.boundsCATransaction.commit()">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS开发月报#1|201807">
<meta property="og:url" content="http://zhangferry.github.io/2018/08/02/201807知识点小结/index.html">
<meta property="og:site_name" content="zhangferry`s blog">
<meta property="og:description" content="关闭隐式动画1234CATransaction.begin()CATransaction.setDisableActions(true)self.layer.frame = self.boundsCATransaction.commit()">
<meta property="og:image" content="https://ws2.sinaimg.cn/large/006tKfTcgy1ftvc9rh18lj30gu080wk9.jpg">
<meta property="og:updated_time" content="2018-12-02T13:37:23.125Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS开发月报#1|201807">
<meta name="twitter:description" content="关闭隐式动画1234CATransaction.begin()CATransaction.setDisableActions(true)self.layer.frame = self.boundsCATransaction.commit()">
<meta name="twitter:image" content="https://ws2.sinaimg.cn/large/006tKfTcgy1ftvc9rh18lj30gu080wk9.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主大人'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://zhangferry.github.io/2018/08/02/201807知识点小结/"/>





  <title> iOS开发月报#1|201807 | zhangferry`s blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?afe60f79e35ee3c65b92d9a2ff459653";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">zhangferry`s blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/08/02/201807知识点小结/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="zhangferry">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/zhangferry.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="zhangferry`s blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="zhangferry`s blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS开发月报#1|201807
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-08-02T14:22:32+08:00">
                2018-08-02
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2018/08/02/201807知识点小结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/08/02/201807知识点小结/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/08/02/201807知识点小结/" class="leancloud_visitors" data-flag-title="iOS开发月报#1|201807">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">Visitors </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="关闭隐式动画"><a href="#关闭隐式动画" class="headerlink" title="关闭隐式动画"></a>关闭隐式动画</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="type">CATransaction</span>.begin()</div><div class="line"><span class="type">CATransaction</span>.setDisableActions(<span class="literal">true</span>)</div><div class="line"><span class="keyword">self</span>.layer.frame = <span class="keyword">self</span>.bounds</div><div class="line"><span class="type">CATransaction</span>.commit()</div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="AVPlayer出现一直缓存，缓存一段时间之后才开始播放的问题"><a href="#AVPlayer出现一直缓存，缓存一段时间之后才开始播放的问题" class="headerlink" title="AVPlayer出现一直缓存，缓存一段时间之后才开始播放的问题"></a>AVPlayer出现一直缓存，缓存一段时间之后才开始播放的问题</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">player.automaticallyWaitsToMinimizeStalling = <span class="literal">false</span><span class="comment">//延迟播放，默认开</span></div></pre></td></tr></table></figure>
<p>关于这个属性的一些说明：</p>
<blockquote>
<p>In versions of iOS prior to iOS 10.0 and versions of OS X prior to 10.12, this property is unavailable, and the behavior of the AVPlayer corresponds to the type of content being played. For streaming content, including HTTP Live Streaming, the AVPlayer acts as if automaticallyWaitsToMinimizeStalling is YES. For file-based content, including file-based content accessed via progressive http download, the AVPlayer acts as if automaticallyWaitsToMinimizeStalling is NO.</p>
</blockquote>
<p>大致是说在iOS10之前的客户端，虽然这个参数不可用，但是非流媒体类型的播放这个配置默认为false，所以在iOS10下建议这个属性值为false。</p>
<h2 id="AVPlayer是否正在播放的判断"><a href="#AVPlayer是否正在播放的判断" class="headerlink" title="AVPlayer是否正在播放的判断"></a>AVPlayer是否正在播放的判断</h2><p>当我们使用KVO监听player.rate来判断player的是否正在播放时，会发现这个值是不准的。其实准确的说是<code>player.rate=1</code>不代表正在播放，<code>player.rate=0</code>是可以代表正在暂停的。所以<code>player.rate=0</code>代表暂停，正在播放的状态可以这样判断：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">self</span>.timeObserve = <span class="keyword">self</span>.player.addPeriodicTimeObserver(forInterval: <span class="type">CMTimeMake</span>(<span class="number">1</span>, <span class="number">1</span>),</div><div class="line">queue: <span class="type">DispatchQueue</span>.main,</div><div class="line">using: &#123;(time) <span class="keyword">in</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">self</span>.player.timeControlStatus == <span class="type">AVPlayerTimeControlStatus</span>.playing &#123;</div><div class="line"><span class="comment">//AVPlayerTimeControlStatus为iOS之后的API</span></div><div class="line"><span class="keyword">self</span>.state = .playing</div><div class="line">&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="下载时URLSessionConfiguration的配置"><a href="#下载时URLSessionConfiguration的配置" class="headerlink" title="下载时URLSessionConfiguration的配置"></a>下载时URLSessionConfiguration的配置</h2><p>使用Alamofire下载时，我们通常需要一个<code>SessionManager</code>配置下载参数：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> configuration = <span class="type">URLSessionConfiguration</span>.<span class="keyword">default</span></div><div class="line">configuration.timeoutIntervalForRequest = <span class="number">50</span><span class="comment">//50s超时</span></div><div class="line"><span class="comment">/** 最大同时下载数 ---- iOS对于同一个IP服务器的并发最大默认为4，OS X为6 */</span></div><div class="line">configuration.httpMaximumConnectionsPerHost = <span class="number">4</span></div><div class="line"><span class="comment">/** A Boolean value that indicates whether TCP connections should be kept open when the app moves to the background. */</span></div><div class="line">configuration.shouldUseExtendedBackgroundIdleMode = <span class="literal">true</span><span class="comment">//为true支持后台下载</span></div><div class="line">manager = <span class="type">Alamofire</span>.<span class="type">SessionManager</span>(configuration: configuration)</div></pre></td></tr></table></figure></p>
<h2 id="不要存储沙盒绝对地址"><a href="#不要存储沙盒绝对地址" class="headerlink" title="不要存储沙盒绝对地址"></a>不要存储沙盒绝对地址</h2><p>当我们向沙盒写入数据时，将该绝对路径保存下来，下次再打开该地址并不会获取到我们存入的数据。原因如下：</p>
<p>iOS8之后，苹果添加的新特性，将每次打开app内的沙盒［唯一编码路径］（红框部分）重新生成，并保持上一次的沙盒文件（Documents、Library、tmp）移到新生成的文件内，旧文件删除，就是说，你保存的文件都在，只不过每次打开后，都会有一个新的绝对路径。<br><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1ftvc9rh18lj30gu080wk9.jpg" alt="localPath.png"><br>所以存储路径应该存相对路径：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//这两个都代表document的相对路径</span></div><div class="line"><span class="keyword">let</span> rootPath = <span class="type">NSHomeDirectory</span>() + <span class="string">"/Documents/"</span></div><div class="line"><span class="keyword">let</span> rootPath = <span class="type">NSSearchPathForDirectoriesInDomains</span>(.documentDirectory, .userDomainMask, <span class="literal">true</span>).first</div></pre></td></tr></table></figure></p>
<h2 id="childViewController的viewDidAppear方法调用"><a href="#childViewController的viewDidAppear方法调用" class="headerlink" title="childViewController的viewDidAppear方法调用"></a>childViewController的viewDidAppear方法调用</h2><p>如果一个ViewController中嵌套了多个childViewController。当宿主VC（我们暂且这么称呼它）调用viewDidAppear等方法时，其中的childViewController都会默认调用对应方法。如果我们不想childViewController调用该方法可以重写该VC的属性：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="keyword">var</span> shouldAutomaticallyForwardAppearanceMethods: <span class="type">Bool</span> &#123;</div><div class="line"><span class="keyword">return</span> <span class="literal">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="图片切换渐入渐出的方法"><a href="#图片切换渐入渐出的方法" class="headerlink" title="图片切换渐入渐出的方法"></a>图片切换渐入渐出的方法</h2><p>通过<code>UIImageView</code>展示图片和<code>layer.contents</code>展示图片都可以使用以下方法：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">let transition = <span class="built_in">CATransition</span>()</div><div class="line">transition.duration = <span class="number">0.5</span></div><div class="line">transition.type = kCATransitionFade</div><div class="line"><span class="keyword">self</span>.view.layer.add(transition, forKey: <span class="string">"layer.contents"</span>)</div><div class="line"><span class="keyword">self</span>.view.layer.contents = image.cgImage<span class="comment">//适用于imageView</span></div></pre></td></tr></table></figure>
<h2 id="cell移出视图，移入视图的方法"><a href="#cell移出视图，移入视图的方法" class="headerlink" title="cell移出视图，移入视图的方法"></a>cell移出视图，移入视图的方法</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//TableViewCell</span></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">prepareForReuse</span><span class="params">()</span></span> &#123;</div><div class="line"><span class="keyword">super</span>.prepareForReuse()<span class="comment">//使用重用池的cell,显示过的cell移至可视范围</span></div><div class="line">&#125;</div><div class="line"><span class="comment">//TableView</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, didEndDisplaying cell: UITableViewCell, forRowAt indexPath: IndexPath)</span></span> &#123;</div><div class="line"><span class="comment">//cell移出视图时调用</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="tableview-collectionView数据reload之后的操作"><a href="#tableview-collectionView数据reload之后的操作" class="headerlink" title="tableview,collectionView数据reload之后的操作"></a>tableview,collectionView数据reload之后的操作</h2><p>我们如果要想实现在reload之后弹出alertView，或者滚动到特定一行，可能会直接写：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tableView.reloadData()</div><div class="line">tableView.scrollToRow(at: indexPath, at: .middle, animated: <span class="literal">true</span>)</div></pre></td></tr></table></figure></p>
<p>看似没问题，但是滚动没起作用，因为reloadData是立即返回的，不会等tableview刷新完成。<br>解决办法就是需要等reload完成之后再做我们需要的操作，reload是否完成有几种方式监听：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//collectionView</span></div><div class="line">collectionView.performBatchUpdates(<span class="literal">nil</span>) &#123; (finished) <span class="keyword">in</span></div><div class="line">    <span class="comment">//reload完成</span></div><div class="line">&#125;</div><div class="line"><span class="comment">//tableView方法只有iOS11可用</span></div><div class="line">tableView.performBatchUpdates(<span class="literal">nil</span>) &#123; (finished) <span class="keyword">in</span></div><div class="line">    <span class="comment">//reload完成</span></div><div class="line">&#125;<span class="comment">//替代func beginUpdates()，func endUpdates()</span></div><div class="line"><span class="comment">//tableView等reload完成还可以使用</span></div><div class="line">tableView.reloadData()</div><div class="line"><span class="type">DispatchQueue</span>.main.async &#123;</div><div class="line">    <span class="comment">//reload完成</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div></div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/wechat-reward-image.jpg" alt="zhangferry WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
    </div>
  </div>


      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/月报/" rel="tag"># 月报</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/07/17/UIButton-detail/" rel="next" title="可能被忽略的UIButton细节">
                <i class="fa fa-chevron-left"></i> 可能被忽略的UIButton细节
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/08/06/201807summary/" rel="prev" title="七月小结">
                七月小结 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2018/08/02/201807知识点小结/"
           data-title="iOS开发月报#1|201807" data-url="http://zhangferry.github.io/2018/08/02/201807知识点小结/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/zhangferry.png"
               alt="zhangferry" />
          <p class="site-author-name" itemprop="name">zhangferry</p>
          <p class="site-description motion-element" itemprop="description">只有频率相同的人，才能看见彼此内心深处不为人知的优雅。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">21</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">categories</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/zhangferry" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/2947186387/profile?topnav=1&wvr=6&is_all=1" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#关闭隐式动画"><span class="nav-number">1.</span> <span class="nav-text">关闭隐式动画</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AVPlayer出现一直缓存，缓存一段时间之后才开始播放的问题"><span class="nav-number">2.</span> <span class="nav-text">AVPlayer出现一直缓存，缓存一段时间之后才开始播放的问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AVPlayer是否正在播放的判断"><span class="nav-number">3.</span> <span class="nav-text">AVPlayer是否正在播放的判断</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#下载时URLSessionConfiguration的配置"><span class="nav-number">4.</span> <span class="nav-text">下载时URLSessionConfiguration的配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#不要存储沙盒绝对地址"><span class="nav-number">5.</span> <span class="nav-text">不要存储沙盒绝对地址</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#childViewController的viewDidAppear方法调用"><span class="nav-number">6.</span> <span class="nav-text">childViewController的viewDidAppear方法调用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#图片切换渐入渐出的方法"><span class="nav-number">7.</span> <span class="nav-text">图片切换渐入渐出的方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cell移出视图，移入视图的方法"><span class="nav-number">8.</span> <span class="nav-text">cell移出视图，移入视图的方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tableview-collectionView数据reload之后的操作"><span class="nav-number">9.</span> <span class="nav-text">tableview,collectionView数据reload之后的操作</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhangferry</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"zhangferry"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("DuOwsJ3GAgOVpEsgoXwPefXF-gzGzoHsz", "e7aUnrStHzmE0hGJXLsLxHpk");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


</body>
</html>
