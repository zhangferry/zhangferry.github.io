<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>zhangferry</title>


    <meta name="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
<meta property="og:type" content="website">
<meta property="og:title" content="zhangferry">
<meta property="og:url" content="http://zhangferry.github.io/index.html">
<meta property="og:site_name" content="zhangferry">
<meta property="og:description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://zhangferry.github.io/images/og_image.png">
<meta property="article:author" content="zhangferry">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://zhangferry.github.io/images/og_image.png">







<link rel="icon" href="/images/favicon.ico">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/tomorrow-night-bright.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    


<link rel="stylesheet" href="/css/style.css">
<link rel="alternate" href="/atom.xml" title="zhangferry" type="application/atom+xml">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo_2.svg" alt="zhangferry" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item is-active"
                href="/">主页</a>
                
                <a class="navbar-item"
                href="/archives">归档</a>
                
                <a class="navbar-item"
                href="/tags">标签</a>
                
                <a class="navbar-item"
                href="/about">关于</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/zhangferry">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main">
    
<div class="card">
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/05/10/swifter_question/"><i class="fas fa-angle-double-right"></i>Swift黄金选手鉴定手册</a>
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-05-09T16:00:34.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2020-05-10</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2020-05-11T16:01:42.054Z"><i class="far fa-calendar-check">&nbsp;</i>2020-05-12</time>
                                
                
                
                <span class="level-item has-text-grey">
                    
                    
                    40 分钟 读完 (大约 6048 个字)
                </span>
                
                
            </div>
        </div>
        
        <!-- <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/05/10/swifter_question/">Swift黄金选手鉴定手册</a>
            
        </h1> -->
        <div class="content">
            <p><img src="https://cdn.jsdelivr.net/gh/zhangferry/Images/blog/image-20200511230812677.png" alt="image-20200511230812677"></p>
<p>这篇是对<a href="https://juejin.im/post/5e96f898e51d4546c27bcf81">一文鉴定是Swift的王者，还是青铜</a>文章中问题的解答。这些问题仅仅是表层概念，属于知识点，在我看来即使都很清楚也并不能代表上了王者，如果非要用段位类比的话，黄金还是合理的😄。</p>
<p>Swift是一门上手容易，但是精通较难的语言。即使下面这些内容都不清楚也不妨碍你开发业务需求，但是了解之后它能够帮助我们写出更加Swifty的代码。</p>
<h2 id="一、-协议-Protocol"><a href="#一、-协议-Protocol" class="headerlink" title="一、 协议 Protocol"></a>一、 协议 Protocol</h2><h3 id="ExpressibleByDictionaryLiteral"><a href="#ExpressibleByDictionaryLiteral" class="headerlink" title="ExpressibleByDictionaryLiteral"></a>ExpressibleByDictionaryLiteral</h3><p><code>ExpressibleByDictionaryLiteral</code>是字典的字面量协议，该协议的完整写法为：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">ExpressibleByDictionaryLiteral</span> </span>&#123;</span><br><span class="line">    <span class="comment">/// The key type of a dictionary literal.</span></span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Key</span></span><br><span class="line">    <span class="comment">/// The value type of a dictionary literal.</span></span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Value</span></span><br><span class="line">    <span class="comment">/// Creates an instance initialized with the given key-value pairs.</span></span><br><span class="line">    <span class="keyword">init</span>(dictionaryLiteral elements: (<span class="type">Self</span>.<span class="type">Key</span>, <span class="type">Self</span>.<span class="type">Value</span>)...)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先字面量（Literal）的意思是：<strong>用于表达源代码中一个固定值的表示法（notation）</strong>。</p>
<p>举个例子，构造字典我们可以通过以下两种方式进行：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法一：</span></span><br><span class="line"><span class="keyword">var</span> countryCodes = <span class="type">Dictionary</span>&lt;<span class="type">String</span>, <span class="type">Any</span>&gt;()</span><br><span class="line">countryCodes[<span class="string">"BR"</span>] = <span class="string">"Brazil"</span></span><br><span class="line">countryCodes[<span class="string">"GH"</span>] = <span class="string">"Ghana"</span></span><br><span class="line"><span class="comment">// 方法二：</span></span><br><span class="line"><span class="keyword">let</span> countryCodes = [<span class="string">"BR"</span>: <span class="string">"Brazil"</span>, <span class="string">"GH"</span>: <span class="string">"Ghana"</span>]</span><br></pre></td></tr></table></figure>

<p>第二种构造方式就是通过字面量方式进行构造的。</p>
<p>其实基础类型基本都是通过字面量进行构造的：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num: <span class="type">Int</span> = <span class="number">10</span></span><br><span class="line"><span class="keyword">let</span> flag: <span class="type">Bool</span> = <span class="literal">true</span></span><br><span class="line"><span class="keyword">let</span> str: <span class="type">String</span> = <span class="string">"Brazil"</span></span><br><span class="line"><span class="keyword">let</span> array: [<span class="type">String</span>] = [<span class="string">"Brazil"</span>, <span class="string">"Ghana"</span>]</span><br></pre></td></tr></table></figure>

<p>而这些都有对应的字面量协议：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ExpressibleByNilLiteral</span> <span class="comment">// nil字面量协议</span></span><br><span class="line"><span class="type">ExpressibleByIntegerLiteral</span> <span class="comment">// 整数字面量协议</span></span><br><span class="line"><span class="type">ExpressibleByFloatLiteral</span> <span class="comment">// 浮点数字面量协议</span></span><br><span class="line"><span class="type">ExpressibleByBooleanLiteral</span> <span class="comment">// 布尔值字面量协议</span></span><br><span class="line"><span class="type">ExpressibleByStringLiteral</span> <span class="comment">// 字符串字面量协议</span></span><br><span class="line"><span class="type">ExpressibleByArrayLiteral</span> <span class="comment">// 数组字面量协议</span></span><br></pre></td></tr></table></figure>

<h3 id="Sequence"><a href="#Sequence" class="headerlink" title="Sequence"></a>Sequence</h3><p>Sequence翻译过来就是序列，该协议的目的是一系列相同类型的值的集合，并且提供对这些值的迭代能力，这里的迭代可以理解为遍历，也即<code>for-in</code>的能力。可以看下该协议的定义：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Sequence</span> </span>&#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Iterator</span>: <span class="type">IteratorProtocol</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">makeIterator</span><span class="params">()</span></span> -&gt; <span class="type">Iterator</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>Sequence</code>又引入了另一个协议<code>IteratorProtocol</code>，该协议就是为了提供序列的迭代能力。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">IteratorProtocol</span> </span>&#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Element</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">next</span><span class="params">()</span></span> -&gt; <span class="type">Self</span>.<span class="type">Element</span>?</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们通常用<code>for-in</code>实现数组的迭代：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> animals = [<span class="string">"Antelope"</span>, <span class="string">"Butterfly"</span>, <span class="string">"Camel"</span>, <span class="string">"Dolphin"</span>]</span><br><span class="line"><span class="keyword">for</span> animal <span class="keyword">in</span> animals &#123;</span><br><span class="line">    <span class="built_in">print</span>(animal)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里的<code>for-in</code>会被编译器翻译成：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> animalIterator = animals.makeIterator()</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">let</span> animal = animalIterator.next() &#123;</span><br><span class="line">    <span class="built_in">print</span>(animal)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h3><p>Collection译为集合，其继承于Sequence。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Collection</span> : <span class="title">Sequence</span> </span>&#123;</span><br><span class="line">  <span class="keyword">associatedtype</span> <span class="type">Index</span> : <span class="type">Comparable</span></span><br><span class="line">  <span class="keyword">var</span> startIndex: <span class="type">Index</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">  <span class="keyword">var</span> endIndex: <span class="type">Index</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">  <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">count</span>: <span class="type">Int</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">subscript</span>(position: <span class="type">Index</span>) -&gt; <span class="type">Element</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">  <span class="keyword">subscript</span>(bounds: <span class="type">Range</span>&lt;<span class="type">Index</span>&gt;) -&gt; <span class="type">SubSequence</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>是一个元素可以反复遍历并且可以通过索引的下标访问的有限集合，注意<code>Sequence</code>可以是无限的，<code>Collection</code>必须是有限的。</p>
<p><code>Collection</code>在<code>Sequence</code>的基础上扩展了下标访问、元素个数能特性。我们常用的集合类型<code>Array</code>，<code>Dictionary</code>，<code>Set</code>都遵循该协议。</p>
<h3 id="CustomStringConvertible"><a href="#CustomStringConvertible" class="headerlink" title="CustomStringConvertible"></a>CustomStringConvertible</h3><p>这个协议表示自定义类型输出的样式。先来看下它的定义：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">CustomStringConvertible</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>只有一个<code>description</code>的属性。它的使用很简单：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span>: <span class="title">CustomStringConvertible</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> x: <span class="type">Int</span>, y: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"(\(x), \(y))"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p = <span class="type">Point</span>(x: <span class="number">21</span>, y: <span class="number">30</span>)</span><br><span class="line"><span class="built_in">print</span>(p) <span class="comment">// (21, 30)</span></span><br><span class="line"><span class="comment">//String(describing: &lt;#T##CustomStringConvertible#&gt;)</span></span><br><span class="line"><span class="keyword">let</span> s = <span class="type">String</span>(describing: p)</span><br><span class="line"><span class="built_in">print</span>(s) <span class="comment">// (21, 30)</span></span><br></pre></td></tr></table></figure>

<p>如果不实现<code>CustomStringConvertible</code>，直接打印对象，系统会根据默认设置进行输出。我们可以通过<code>CustomStringConvertible</code>对这一输出行为进行设置，还有一个协议是<code>CustomDebugStringConvertible</code>：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">CustomDebugStringConvertible</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> debugDescription: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟<code>CustomStringConvertible</code>用法一样，对应<code>debugPrint</code>的输出。</p>
<h3 id="Hashable"><a href="#Hashable" class="headerlink" title="Hashable"></a>Hashable</h3><p>我们常用的<code>Dictionary</code>，<code>Set</code>均实现了<code>Hashable</code>协议。Hash的目的是为了将查找集合某一元素的时间复杂度降低到O(1)，为了实现这一目的需要将集合元素与存储地址之间建议一种尽可能一一对应的关系。</p>
<p>我们再看Hashable`协议的定义：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Hashable</span> : <span class="title">Equatable</span> </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> hashValue: <span class="type">Int</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">hash</span><span class="params">(into hasher: <span class="keyword">inout</span> Hasher)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Equatable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> == <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意到<code>func hash(into hasher: inout Hasher)</code>，Swift 4.2 通过引入 <code>Hasher</code> 类型并采用新的通用哈希函数进一步优化 <code>Hashable</code>。</p>
<p>如果你要自定义类型实现 <code>Hashable</code> 的方式，可以重写 <code>hash(into:)</code> 方法而不是 <code>hashValue</code>。<code>hash(into:)</code> 通过传递了一个 <code>Hasher</code> 引用对象，然后通过这个对象调用 <code>combine(_:)</code> 来添加类型的必要状态信息。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Swift &gt;= 4.2</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Color</span>: <span class="title">Hashable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> red: <span class="type">UInt8</span></span><br><span class="line">    <span class="keyword">let</span> green: <span class="type">UInt8</span></span><br><span class="line">    <span class="keyword">let</span> blue: <span class="type">UInt8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Synthesized by compiler</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">hash</span><span class="params">(into hasher: <span class="keyword">inout</span> Hasher)</span></span> &#123;</span><br><span class="line">        hasher.combine(<span class="keyword">self</span>.red)</span><br><span class="line">        hasher.combine(<span class="keyword">self</span>.green)</span><br><span class="line">        hasher.combine(<span class="keyword">self</span>.blue)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Default implementation from protocol extension</span></span><br><span class="line">    <span class="keyword">var</span> hashValue: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> hasher = <span class="type">Hasher</span>()</span><br><span class="line">        <span class="keyword">self</span>.hash(into: &amp;hasher)</span><br><span class="line">        <span class="keyword">return</span> hasher.finalize()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参考：<a href="https://nshipster.cn/hashable/">Hashable / Hasher</a></p>
<h3 id="Codable"><a href="#Codable" class="headerlink" title="Codable"></a>Codable</h3><p><code>Codable</code>是可<code>Decodable</code>和<code>Encodable</code>的类型别名。它能够将程序内部的数据结构序列化成可交换数据，也能够将通用数据格式反序列化为内部使用的数据结构，大大提升对象和其表示之间互相转换的体验。处理的问题就是我们经常遇到的JSON转模型，和模型转JSON。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">Codable</span> = <span class="type">Decodable</span> &amp; <span class="type">Encodable</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Decodable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">init</span>(from decoder: <span class="type">Decoder</span>) <span class="keyword">throws</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Encodable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">encode</span><span class="params">(to encoder: Encoder)</span></span> <span class="keyword">throws</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里只举一个简单的解码过程：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//json数据</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span>: <span class="string">"1283984"</span>,</span><br><span class="line">    <span class="string">"name"</span>: <span class="string">"Mike"</span>,</span><br><span class="line">  	<span class="string">"age"</span>: <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义对象</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span>: <span class="title">Codable</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> id: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">  	<span class="keyword">var</span> age: <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// json为网络接口返回的Data类型数据</span></span><br><span class="line"><span class="keyword">let</span> mike = <span class="keyword">try</span>! <span class="type">JSONDecoder</span>().decode(<span class="type">Person</span>.<span class="keyword">self</span>, from: json)</span><br><span class="line"><span class="built_in">print</span>(mike)</span><br><span class="line"><span class="comment">//输出：Student(id: "1283984", name: "Mike", age: 18)</span></span><br></pre></td></tr></table></figure>

<p>是不是非常简单，Codable还支持各种自定义解编码过程，完全可以取代<code>SwiftyJSON</code>，<code>HandyJSON</code>等编解码库。</p>
<h3 id="Comparable"><a href="#Comparable" class="headerlink" title="Comparable"></a>Comparable</h3><p>这个是用于实现比较功能的协议，它的定义如下：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Comparable</span> : <span class="title">Equatable</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &lt; (lhs: Self, rhs: Self) -&gt; <span class="title">Bool</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="title">static</span> <span class="title">func</span> &lt;= (lhs: Self, rhs: Self) -&gt; <span class="title">Bool</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="title">static</span> <span class="title">func</span> &gt;= <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &gt; <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其继承于<code>Equatable</code>，即判等的协议。可以很清楚的理解实现了各种比较的定义就具有了比较的功能。这个不做比较。</p>
<h3 id="RangeReplaceableCollection"><a href="#RangeReplaceableCollection" class="headerlink" title="RangeReplaceableCollection"></a>RangeReplaceableCollection</h3><p><code>RangeReplaceableCollection</code>支持用另一个集合的元素替换元素的任意子范围的集合。</p>
<p>看下它的定义：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">RangeReplaceableCollection</span> : <span class="title">Collection</span> <span class="title">where</span> <span class="title">Self</span>.<span class="title">SubSequence</span> : <span class="title">RangeReplaceableCollection</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">SubSequence</span></span><br><span class="line">  </span><br><span class="line">  	<span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">append</span><span class="params">(<span class="number">_</span> newElement: <span class="keyword">Self</span>.Element)</span></span></span><br><span class="line">  	<span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">insert</span>&lt;S&gt;<span class="params">(contentsOf newElements: S, at i: <span class="keyword">Self</span>.Index)</span></span> <span class="keyword">where</span> <span class="type">S</span> : <span class="type">Collection</span>, <span class="type">Self</span>.<span class="type">Element</span> == <span class="type">S</span>.<span class="type">Element</span></span><br><span class="line">  	<span class="comment">/* 拼接、插入、删除、替换的方法，他们都具有对组元素的操作能力 */</span></span><br><span class="line">  </span><br><span class="line">  	<span class="keyword">override</span> <span class="keyword">subscript</span>(bounds: <span class="type">Self</span>.<span class="type">Index</span>) -&gt; <span class="type">Self</span>.<span class="type">Element</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">subscript</span>(bounds: <span class="type">Range</span>&lt;<span class="type">Self</span>.<span class="type">Index</span>&gt;) -&gt; <span class="type">Self</span>.<span class="type">SubSequence</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>举个例子，Array支持该协议，我们可以进行如下操作：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bugs = [<span class="string">"Aphid"</span>, <span class="string">"Damselfly"</span>]</span><br><span class="line">bugs.append(<span class="string">"Earwig"</span>)</span><br><span class="line">bugs.insert(contentsOf: [<span class="string">"Bumblebee"</span>, <span class="string">"Cicada"</span>], at: <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(bugs)</span><br><span class="line"><span class="comment">// Prints "["Aphid", "Bumblebee", "Cicada", "Damselfly", "Earwig"]"</span></span><br></pre></td></tr></table></figure>

<p>这里附一张Swift中Array遵循的协议关系图，有助于大家理解上面讲解的几个协议之间的关系：</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/5/10/171ff1f43fb51bfc?w=1075&h=369&f=svg&s=21578" alt="img"></p>
<p>图像来源：<a href="https://swiftdoc.org/v3.1/type/array/hierarchy/">https://swiftdoc.org/v3.1/type/array/hierarchy/</a></p>
<h2 id="二、-propertyWrapper"><a href="#二、-propertyWrapper" class="headerlink" title="二、@propertyWrapper"></a>二、@propertyWrapper</h2><blockquote>
<p>阅读以下代码，print 输出什么</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@propertyWrapper</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Wrapper</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> wrappedValue: <span class="type">T</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> projectedValue: <span class="type">Wrapper</span>&lt;<span class="type">T</span>&gt; &#123; <span class="keyword">return</span> <span class="keyword">self</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">foo</span><span class="params">()</span></span> &#123; <span class="built_in">print</span>(<span class="string">"Foo"</span>) &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HasWrapper</span> </span>&#123;</span><br><span class="line">    @<span class="type">Wrapper</span> <span class="keyword">var</span> x = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">foo</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(x) <span class="comment">// 0</span></span><br><span class="line">        <span class="built_in">print</span>(_x) <span class="comment">// Wrapper&lt;Int&gt;(wrappedValue: 0)</span></span><br><span class="line">        <span class="built_in">print</span>($x) <span class="comment">// Wrapper&lt;Int&gt;(wrappedValue: 0)</span></span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码看似要考察对<code>@propertyWrapper</code>的理解，但是有很多无用内容，导致代码很奇怪。</p>
<p><code>@propertyWrapper</code>的意思就是属性包装，它可以将一系列相似的属性方法进行统一处理。举个例子，如果我们需要在<code>UserDefaults</code>中加一个是否首次启动的值，正常可以这样处理：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UserDefaults</span> </span>&#123;</span><br><span class="line">  	<span class="class"><span class="keyword">enum</span> <span class="title">Keys</span> </span>&#123;</span><br><span class="line">      <span class="keyword">static</span> <span class="keyword">let</span> isFirstLaunch = <span class="string">"isFirstLaunch"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> isFirstLaunch: <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> bool(forKey: <span class="type">Keys</span>.isFirstLaunch)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            <span class="keyword">set</span>(newValue, forKey: <span class="type">Keys</span>.isFirstLaunch)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果我们需要加入很多这样属性的话，就需要写大量的<code>get</code> 、<code>set</code>方法。而<code>@propertyWrapper</code>的作用就是为属性的这种设置提供一个模板写法，以下是使用属性包装的写法。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@propertyWrapper</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">UserDefaultWrapper</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> key: <span class="type">String</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> defaultValue: <span class="type">T</span></span><br><span class="line">    <span class="keyword">init</span>(key: <span class="type">String</span>, defaultValue: <span class="type">T</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.key = key</span><br><span class="line">        <span class="keyword">self</span>.defaultValue = defaultValue</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">var</span> wrappedValue: <span class="type">T</span> &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="type">UserDefaults</span>.standard.object(forKey: key) <span class="keyword">as</span>? <span class="type">T</span> ?? defaultValue</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            <span class="type">UserDefaults</span>.standard.<span class="keyword">set</span>(newValue, forKey: key)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UserDefaults</span> </span>&#123;</span><br><span class="line">  	@<span class="type">UserDefaultWrapper</span>(key: <span class="type">Keys</span>.isFirstLaunch, defaultValue: <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">var</span> isFirstLaunch: <span class="type">Bool</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@propertyWrapper</code>约束的对象必须要定义<code>wrappedValue</code>属性，因为该对象包裹的属性会走到<code>wrappedValue</code>的实现。</p>
<p>回到实例代码，定义了<code>wrappedValue</code>却并没有添加任何实现，这是允许的。所以访问x的时候其实是访问<code>Wrapper</code>的<code>wrappedValue</code>，因为没有给出任何实现所以直接打印出<code>0</code>。而<code>_x</code>和<code>$x</code>对应的就是<code>Wrapper</code>自身。</p>
<p>参考：<a href="https://nshipster.com/propertywrapper/">Swift Property Wrappers</a></p>
<h2 id="三、关键字"><a href="#三、关键字" class="headerlink" title="三、关键字"></a>三、关键字</h2><h3 id="public-open"><a href="#public-open" class="headerlink" title="public open"></a>public open</h3><p><code>public</code> <code>open</code>为权限关键词。对于一个严格的项目来说，精确的最小化访问控制级别对于代码的维护来说相当重要的。完整的权限关键词，按权限大小排序如下：</p>
<p><code>open &gt; public &gt; internal &gt; fileprivate &gt; private</code></p>
<ul>
<li><code>open</code>权限最大，允许外部module访问，继承，重写。</li>
<li><code>public</code>允许外部module访问，但不允许继承，重写。</li>
<li><code>internal</code>为默认关键词，在同一个module内可以共用。</li>
<li><code>fileprivate</code>表示代码可以在当前文件中被访问，而不做类型限定。</li>
<li><code>private</code>表示代码只能在当前作用域或者同一文件中同一类型的作用域中被使用。</li>
</ul>
<p>这些权限关键词可以修饰，属性，方法和类型。需要注意：当一个类型的某一属性要用public修饰时，该类型至少要用public（或者open）权限的关键词修复。可以理解为数据访问是分层的，我们为了获取某一属性或方法需要先获取该类型，所以外层（类型）的访问权限要满足大于等于内层（类型、方法、属性）权限。</p>
<p>参考：<a href="https://docs.swift.org/swift-book/LanguageGuide/AccessControl.html">Swift AccessControl</a></p>
<h3 id="static-class-final"><a href="#static-class-final" class="headerlink" title="static class final"></a>static class final</h3><p>原文中<code>final</code>跟权限关键词放在一起了，其实是不合理的，就将其放到这里来讨论。</p>
<p><code>static</code>静态变量关键词，来源于C语言。</p>
<p>在Swift中常用语以下场景：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 仅用于类名前，表示该类不能被继承。仅支持class类型</span></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Manager</span> </span>&#123;</span><br><span class="line">  	<span class="comment">// 单例的声明</span></span><br><span class="line">		<span class="keyword">static</span> <span class="keyword">let</span> shared = <span class="type">Manager</span>()</span><br><span class="line">  	<span class="comment">// 实例属性，可被重写</span></span><br><span class="line">  	<span class="keyword">var</span> name: <span class="type">String</span> = <span class="string">"Ferry"</span></span><br><span class="line">  	<span class="comment">// 实例属性，不可被重写</span></span><br><span class="line">  	<span class="keyword">final</span> <span class="keyword">var</span> lastName: <span class="type">String</span> = <span class="string">"Zhang"</span></span><br><span class="line">  	<span class="comment">// 类属性，不可被重写</span></span><br><span class="line">  	<span class="keyword">static</span> <span class="keyword">var</span> address: <span class="type">String</span> = <span class="string">"Beijing"</span></span><br><span class="line">  	<span class="comment">// 类属性，可被重写。注意只能作为计算属性，而不能作为存储属性</span></span><br><span class="line">  	<span class="class"><span class="keyword">class</span> <span class="title">var</span> <span class="title">code</span>: <span class="title">String</span> </span>&#123;</span><br><span class="line">    		<span class="keyword">return</span> <span class="string">"0122"</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// 实例函数，可被重写</span></span><br><span class="line">  	<span class="function"><span class="keyword">func</span> <span class="title">download</span><span class="params">()</span></span> &#123;</span><br><span class="line">      <span class="comment">/* code... */</span></span><br><span class="line">    &#125;</span><br><span class="line">  	<span class="comment">// 实例函数，不可被重写</span></span><br><span class="line">  	<span class="keyword">final</span> <span class="function"><span class="keyword">func</span> <span class="title">download</span><span class="params">()</span></span> &#123;</span><br><span class="line">      <span class="comment">/* code... */</span></span><br><span class="line">    &#125;</span><br><span class="line">  	<span class="comment">// 类函数，可被重写</span></span><br><span class="line">  	<span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">removeCache</span>() </span>&#123;</span><br><span class="line">     	<span class="comment">/* code... */</span> </span><br><span class="line">    &#125;</span><br><span class="line">  	<span class="comment">// 类函数，不可被重写</span></span><br><span class="line">  	<span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">download</span><span class="params">()</span></span> &#123;</span><br><span class="line">      <span class="comment">/* code... */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Manager</span> </span>&#123;</span><br><span class="line">  	<span class="comment">// 单例的声明</span></span><br><span class="line">		<span class="keyword">static</span> <span class="keyword">let</span> shared = <span class="type">Manager</span>()</span><br><span class="line">  	<span class="comment">// 类属性</span></span><br><span class="line">  	<span class="keyword">static</span> <span class="keyword">var</span> name: <span class="type">String</span> = <span class="string">"Ferry"</span></span><br><span class="line">  	<span class="comment">// 类函数</span></span><br><span class="line">  	<span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">download</span><span class="params">()</span></span> &#123;</span><br><span class="line">      <span class="comment">/* code... */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>struct</code>和<code>enum</code>因为不能被继承，所以也就无法使用<code>class</code>和<code>final</code>关键词，仅能通过<code>static</code>关键词进行限定</p>
<h3 id="mutating-inout"><a href="#mutating-inout" class="headerlink" title="mutating inout"></a>mutating inout</h3><p>mutating用于修饰会改变该类型的函数之前，基本都用于<code>struct</code>对象的修改。看下面例子：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x: <span class="type">CGFloat</span></span><br><span class="line">    <span class="keyword">var</span> y: <span class="type">CGFloat</span></span><br><span class="line">		<span class="comment">// 因为该方法改变了struct的属性值（x），所以必须要加上mutating</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">moveRight</span><span class="params">(offset: CGFloat)</span></span> &#123;</span><br><span class="line">        x += offset</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  	<span class="function"><span class="keyword">func</span> <span class="title">normalSwap</span><span class="params">(a: CGFloat, b: CGFloat)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> temp = a</span><br><span class="line">        a = b</span><br><span class="line">        b = temp</span><br><span class="line">    &#125;</span><br><span class="line">		<span class="comment">// 将两个值交换，需传入对象地址。注意inout需要加载类型名前</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">inoutSwap</span><span class="params">(a: <span class="keyword">inout</span> CGFloat, b: <span class="keyword">inout</span> CGFloat)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> temp = a</span><br><span class="line">        a = b</span><br><span class="line">        b = temp</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> location1: <span class="type">CGFloat</span> = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> location2: <span class="type">CGFloat</span> = -<span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> point = <span class="type">Point</span>.<span class="keyword">init</span>(x: <span class="number">0</span>, y: <span class="number">0</span>)</span><br><span class="line">point.moveRight(offset: location1)</span><br><span class="line"><span class="built_in">print</span>(point)	<span class="comment">//Point(x: 10.0, y: 0.0)</span></span><br><span class="line"></span><br><span class="line">point.normalSwap(a: location1, b: location2)</span><br><span class="line"><span class="built_in">print</span>(location1)	<span class="comment">//10</span></span><br><span class="line"><span class="built_in">print</span>(location2)	<span class="comment">//-10</span></span><br><span class="line"><span class="comment">// 注意需带取址符&amp;</span></span><br><span class="line">point.inoutSwap(a: &amp;location1, b: &amp;location2)</span><br><span class="line"><span class="built_in">print</span>(location1)	<span class="comment">//-10</span></span><br><span class="line"><span class="built_in">print</span>(location2)	<span class="comment">//10</span></span><br></pre></td></tr></table></figure>

<p><code>inout</code>需要传入取值符，所以它的改变会导致该对象跟着变动。可以再回看上面说的<code>Hashable</code>的一个协议实现：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">hash</span><span class="params">(into hasher: <span class="keyword">inout</span> Hasher)</span></span> &#123;</span><br><span class="line">    hasher.combine(<span class="keyword">self</span>.red)</span><br><span class="line">    hasher.combine(<span class="keyword">self</span>.green)</span><br><span class="line">    hasher.combine(<span class="keyword">self</span>.blue)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>只有使用<code>inout</code>才能修改传入的hasher的值。</p>
<h3 id="infix-operator"><a href="#infix-operator" class="headerlink" title="infix operator"></a>infix operator</h3><p><code>infix operator</code>即为中缀操作符，还有prefix、postfix后缀操作符。</p>
<p>它的作用是自定义操作符。比如Python里可以用<code>**</code>进行幂运算，但是Swift里面，我们就可以利用自定义操作符来定义一个用<code>**</code>实现的幂运算。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义中缀操作符</span></span><br><span class="line"><span class="keyword">infix</span> <span class="keyword">operator</span> **</span><br><span class="line"><span class="comment">// 实现该操作符的逻辑，中缀需要两个参数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> ** <span class="params">(<span class="keyword">left</span>: Double, <span class="keyword">right</span>: Double)</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> pow(<span class="keyword">left</span>, <span class="keyword">right</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> number = <span class="number">2</span> ** <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(value) <span class="comment">//8</span></span><br></pre></td></tr></table></figure>

<p>同理我们还可以定义前缀和后缀操作符：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义阶乘操作，后缀操作符</span></span><br><span class="line"><span class="keyword">postfix</span> <span class="keyword">operator</span> ~!</span><br><span class="line"><span class="keyword">postfix</span> <span class="function"><span class="keyword">func</span> ~! <span class="params">(value: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">factorial</span><span class="params">(<span class="number">_</span> value: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> value &lt;= <span class="number">1</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value * factorial(value - <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> factorial(value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//定义输出操作，前缀操作符</span></span><br><span class="line"><span class="keyword">prefix</span> <span class="keyword">operator</span> &lt;&lt;</span><br><span class="line"><span class="keyword">prefix</span> <span class="function"><span class="keyword">func</span> &lt;&lt; (value: Any) &#123;</span></span><br><span class="line"><span class="function">    print(value)</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">let number1 = 4~!</span></span><br><span class="line"><span class="function">print(number1) // 24</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">&lt;&lt;number1 // 24</span></span><br><span class="line"><span class="function">&lt;&lt;"zhangferry" // zhangferry</span></span><br></pre></td></tr></table></figure>

<p>前缀和后缀仅需要一个操作数，所以只有一个参数即可。</p>
<p>关于操作符的更多内容可以查看这里：<a href="https://nshipster.cn/swift-operators/">Swift Operators</a>。</p>
<p>注意，因为该文章较早，其中对于操作符的一些定义已经改变。</p>
<h3 id="dynamicMemberLookup，-dynamicCallable"><a href="#dynamicMemberLookup，-dynamicCallable" class="headerlink" title="@dynamicMemberLookup，@dynamicCallable"></a>@dynamicMemberLookup，@dynamicCallable</h3><p>这两个关键词我确实没有用过，看到<code>dynamic</code>可以知道这两个特性是为了让Swift具有动态性。</p>
<p><code>@dynamicMemberLookup</code>中文叫动态查找成员。在使用<code>@dynamicMemberLookup</code>标记了对象后（对象、结构体、枚举、protocol），实现了<code>subscript(dynamicMember member: String)</code>方法后我们就可以访问到对象不存在的属性。如果访问到的属性不存在，就会调用到实现的 <code>subscript(dynamicMember member: String)</code>方法，key 作为 member 传入这个方法。 举个例子：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@dynamicMemberLookup</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">subscript</span>(dynamicMember member: <span class="type">String</span>) -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> properties = [<span class="string">"nickname"</span>: <span class="string">"Zhuo"</span>, <span class="string">"city"</span>: <span class="string">"Hangzhou"</span>]</span><br><span class="line">        <span class="keyword">return</span> properties[member, <span class="keyword">default</span>: <span class="string">"undefined"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//执行以下代码</span></span><br><span class="line"><span class="keyword">let</span> p = <span class="type">Person</span>()</span><br><span class="line"><span class="built_in">print</span>(p.city)	<span class="comment">//Hangzhou</span></span><br><span class="line"><span class="built_in">print</span>(p.nickname)	<span class="comment">//Zhuo</span></span><br><span class="line"><span class="built_in">print</span>(p.name)	<span class="comment">//undefined</span></span><br></pre></td></tr></table></figure>

<p>我们没有定义Person的<code>city</code>、<code>nickname</code>，<code>name</code>属性，却可以用点语法去尝试访问它。如果没有<code>@dynamicMemberLookup</code>这种写法会被编译器检查出来并报错，但是加了该关键词编译器就不会管它是不是存在都予以通过。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">@dynamicCallable</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 实现方法一</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">dynamicallyCall</span><span class="params">(withArguments: [String])</span></span> &#123;</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> withArguments &#123;</span><br><span class="line">            <span class="built_in">print</span>(item)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 实现方法二</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">dynamicallyCall</span><span class="params">(withKeywordArguments: KeyValuePairs&lt;String, String&gt;)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (key, value) <span class="keyword">in</span> withKeywordArguments &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\(key) --- \(value)"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="type">Person</span>()</span><br><span class="line">p(<span class="string">"zhangsan"</span>)</span><br><span class="line"><span class="comment">// 等于 p.dynamicallyCall(withArguments: ["zhangsan"])</span></span><br><span class="line">p(<span class="string">"zhangsan"</span>, <span class="string">"20"</span>, <span class="string">"男"</span>)</span><br><span class="line"><span class="comment">// 等于 p.dynamicallyCall(withArguments: ["zhangsan", "20", "男"])</span></span><br><span class="line">p(name: <span class="string">"zhangsan"</span>)</span><br><span class="line"><span class="comment">// 等于 p.dynamicallyCall(withKeywordArguments: ["name": "zhangsan"])</span></span><br><span class="line">p(name: <span class="string">"zhangsan"</span>, age:<span class="string">"20"</span>, sex: <span class="string">"男"</span>)</span><br><span class="line"><span class="comment">// 等于 p.dynamicallyCall(withKeywordArguments: ["name": "zhangsan", "age": "20", "sex": "男"])</span></span><br></pre></td></tr></table></figure>

<p><code>@dynamicCallable</code>可以理解成动态调用，当为某一类型做此声明时，需要实现<code>dynamicallyCall(withArguments:)</code>或者<code>dynamicallyCall(withKeywordArguments:)</code>。编译器将允许你调用并为定义的方法。</p>
<p>一个动态查找成员变量，一个动态方法调用，带上这两个特性Swift就可以变成彻头彻尾的动态语言了。所以作为静态语言的Swift也是可以具有动态特性的。</p>
<p>更多关于这两个动态标记的讨论可以看卓同学的这篇：<a href="https://juejin.im/post/5b24c9896fb9a00e69608a71">细说 Swift 4.2 新特性：Dynamic Member Lookup</a></p>
<h3 id="where"><a href="#where" class="headerlink" title="where"></a>where</h3><p>where一般用作条件限定。它可以用在for-in、swith、do-catch中：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> numbers <span class="keyword">where</span> item % <span class="number">2</span> == <span class="number">1</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"odd: \(item)"</span>)	<span class="comment">// 将输出1，3，5，7，9等数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">numbers.forEach &#123; (item) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">switch</span> item &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> x <span class="keyword">where</span> x % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"even: \(x)"</span>) <span class="comment">// 将输出2，4，6，8等数</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>where</code>也可以用于类型限定。</p>
<p>我们可以扩展一个字典的merge函数，它可以将两个字典进行合并，对于相同的<code>Key</code>值以要合并的字典为准。并且该方法我只想针对<code>Key</code>和<code>Value</code>都是<code>String</code>类型的字典使用，就可以这么做：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里的Key Value来自于Dictionary中定义的泛型</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Dictionary</span> <span class="title">where</span> <span class="title">Key</span> == <span class="title">String</span>, <span class="title">Value</span> == <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="comment">//同一个key操作覆盖旧值</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">merge</span><span class="params">(other: Dictionary)</span></span> -&gt; <span class="type">Dictionary</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.merging(other) &#123; <span class="number">_</span>, new <span class="keyword">in</span> new &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="autoclosure"><a href="#autoclosure" class="headerlink" title="@autoclosure"></a>@autoclosure</h3><p><code>@autoclosure</code> 是使用在闭包类型之前，做的事情就是把一句表达式自动地<strong>封装</strong>成一个闭包 (closure)。</p>
<p>比如我们有一个方法接受一个闭包，当闭包执行的结果为 <code>true</code> 的时候进行打印，分别使用普通闭包和加上<code>autoclosure</code>的闭包实现：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">logIfTrueNormal</span><span class="params">(predicate: <span class="params">()</span></span></span> -&gt; <span class="type">Bool</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> predicate() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"True"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 注意@autoclosure加到闭包的前面</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">logIfTrueAutoclosure</span><span class="params">(predicate: @autoclosure <span class="params">()</span></span></span> -&gt; <span class="type">Bool</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> predicate() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"True"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用方式</span></span><br><span class="line">logIfTrueNormal(predicate: &#123;<span class="number">3</span> &gt; <span class="number">1</span>&#125;)</span><br><span class="line">logIfTrueAutoclosure(predicate: <span class="number">3</span> &gt; <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>编译器会将<code>logIfTrueAutoclosure</code>函数参数中的<code>3 &gt; 1</code>这个表达式转成<code>{3 &gt; 1}</code>这种尾随闭包样式。</p>
<p>那这种写法有什么用处呢？我们可以从一个示例中体会一下，在Swift系统提供的几个短路运算符（即表达式左边如果已经确定结果，右边将不再运算）中均采用了<code>@autoclosure</code>标记的闭包。那<code>??</code>运算符举例，它的实现是这样的：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> ?? &lt;T&gt;<span class="params">(<span class="keyword">optional</span>: T?, defaultValue: @autoclosure <span class="params">()</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">T</span>)</span><br><span class="line">    <span class="keyword">rethrows</span> -&gt; <span class="type">T</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> <span class="keyword">optional</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> .some(<span class="keyword">let</span> value):</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">  <span class="keyword">case</span> .<span class="keyword">none</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">try</span> defaultValue()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="keyword">var</span> name: <span class="type">String</span>? = <span class="string">"ferry"</span></span><br><span class="line"><span class="keyword">let</span> currentName = name ?? getDefaultName()</span><br></pre></td></tr></table></figure>

<p>因为使用了<code>@autoclosure</code>标记闭包，所以<code>??</code>的<code>defaultValue</code>参数我们可以使用表达式，又因为是闭包，所以当<code>name</code>非空时，直接返回了该值，不会调用<code>getDefaultName()</code>函数，减少计算。</p>
<p>参考：<a href="https://swifter.tips/autoclosure/">@AUTOCLOSURE 和 ??</a>，注意因为Swift版本问题，实例代码无法运行。</p>
<h3 id="escaping"><a href="#escaping" class="headerlink" title="@escaping"></a>@escaping</h3><p><code>@escaping</code>也是闭包修饰词，用它标记的闭包被称为逃逸闭包，还有一个关键词是<code>@noescape</code>，用它修饰的闭包叫做非逃逸闭包。在Swift3及之后的版本，闭包默认为非逃逸闭包，在这之前默认闭包为逃逸闭包。</p>
<p>这两者的区别主要在于声明周期的不同，当闭包作为参数时，如果其声明周期与函数一致就是非逃逸闭包，如果声明周期大于函数就是逃逸闭包。结合示例来理解：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 非逃逸闭包</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">logIfTrueNormal</span><span class="params">(predicate: <span class="params">()</span></span></span> -&gt; <span class="type">Bool</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> predicate() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"True"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 逃逸闭包</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">logIfTrueEscaping</span><span class="params">(predicate: @escaping <span class="params">()</span></span></span> -&gt; <span class="type">Bool</span>) &#123;</span><br><span class="line">    <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">        <span class="keyword">if</span> predicate() &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"True"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第二个函数的闭包为逃逸闭包是因为其是异步调用，在函数退出时，该闭包还存在，声明周期长于函数。</p>
<p>如果你无法判断出应该使用逃逸还是非逃逸闭包，也无需担心，因为编译器会帮你做出判断。第二个函数，如果我们不声明逃逸闭包编译器会报错，警告我们：<code>Escaping closure captures non-escaping parameter &#39;predicate&#39;</code>。当然我们还是应该理解两者的区别。</p>
<h2 id="四、高阶函数"><a href="#四、高阶函数" class="headerlink" title="四、高阶函数"></a>四、高阶函数</h2><h3 id="Filter-Map-Reduce-flatmap-compactMap"><a href="#Filter-Map-Reduce-flatmap-compactMap" class="headerlink" title="Filter, Map, Reduce, flatmap, compactMap"></a>Filter, Map, Reduce, flatmap, compactMap</h3><p>这几个高阶函数都是对数组对象使用的，我们通过示例去了解他们吧：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"><span class="comment">// filter 过滤</span></span><br><span class="line"><span class="keyword">let</span> odd = numbers.<span class="built_in">filter</span> &#123; (number) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> number % <span class="number">2</span> == <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(odd) <span class="comment">// [1, 3, 5, 7, 9]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//map 转换</span></span><br><span class="line"><span class="keyword">let</span> maps = odd.<span class="built_in">map</span> &#123; (number) -&gt; <span class="type">String</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"\(number)"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(maps) <span class="comment">// ["1", "3", "5", "7", "9"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// reduce 累计运算</span></span><br><span class="line"><span class="keyword">let</span> result = odd.<span class="built_in">reduce</span>(<span class="number">0</span>, +)</span><br><span class="line"><span class="built_in">print</span>(result) <span class="comment">// 25</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// flatMap 1.数组展开</span></span><br><span class="line"><span class="keyword">let</span> numberList = [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>]， [[<span class="number">6</span>]]]</span><br><span class="line"><span class="keyword">let</span> flatMapNumber = numberList.flatMap &#123; (value) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(flatMapNumber) <span class="comment">// [1, 2, 3, 4, 5, [6]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// flatMap 2.过滤数组中的nil</span></span><br><span class="line"><span class="keyword">let</span> country = [<span class="string">"cn"</span>, <span class="string">"us"</span>, <span class="literal">nil</span>, <span class="string">"en"</span>]</span><br><span class="line"><span class="keyword">let</span> flatMap = country.flatMap &#123; (value) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(flatMap) <span class="comment">//["cn", "us", "en"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// compactMap 过滤数组中的nil</span></span><br><span class="line"><span class="keyword">let</span> compactMap = country.compactMap &#123; (value) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(compactMap) <span class="comment">// ["cn", "us", "en"]</span></span><br></pre></td></tr></table></figure>

<p>filter，reduce其实很好理解，map、flatMap、compactMap刚开始接触时确实容易搞混，这个需要多加使用和练习。</p>
<p>注意到<code>flatMap</code>有两种用法，一种是展开数组，将二维数组降为一维数组，一种是过滤数组中的<code>nil</code>。在Swift4.1版本已经将<code>flatMap</code>过滤数组中nil的函数标位<code>deprecated</code>，所以我们过滤数组中nil的操作应该使用<code>compactMap</code>函数。</p>
<p>参考：<a href="https://blog.devtang.com/2016/03/05/swift-gym-4-map-and-flatmap/#">Swift 烧脑体操（四） - map 和 flatMap</a></p>
<h2 id="五、几个Swift中的概念"><a href="#五、几个Swift中的概念" class="headerlink" title="五、几个Swift中的概念"></a>五、几个Swift中的概念</h2><h3 id="柯里化什么意思"><a href="#柯里化什么意思" class="headerlink" title="柯里化什么意思"></a>柯里化什么意思</h3><p>柯里化指的是从一个多参数函数变成一连串单参数函数的变换，这是实现函数式编程的重要手段，举个例子：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 该函数返回类型为（Int） -&gt; Bool</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">greaterThan</span><span class="params">(<span class="number">_</span> comparer: Int)</span></span> -&gt; (<span class="type">Int</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; number <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">return</span> number &gt; comparer</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义一个greaterThan10的函数</span></span><br><span class="line"><span class="keyword">let</span> greaterThan10 = greaterThan(<span class="number">10</span>)</span><br><span class="line">greaterThan10(<span class="number">13</span>)    <span class="comment">// =&gt; true</span></span><br><span class="line">greaterThan10(<span class="number">9</span>)     <span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure>

<p>所以柯里化也可以理解为批量生成一系列相似的函数。</p>
<p>参考：<a href="https://swifter.tips/currying/">柯里化 (CURRYING)</a></p>
<h3 id="POP-与-OOP的区别"><a href="#POP-与-OOP的区别" class="headerlink" title="POP 与 OOP的区别"></a><code>POP</code> 与 <code>OOP</code>的区别</h3><p>OOP(object-oriented programming)面向对象编程：</p>
<p>在面向对象编程世界里，一切皆为对象，它的核心思想是继承、封装、多态。</p>
<p>POP(protocol-oriented programming)面向协议编程：</p>
<p>面向协议编程则主要通过协议，又或叫做接口对一系列操作进行定义。面向协议也有继承封装多态，只不过这些不是针对对象建立的。</p>
<p>为什么Swift演变成了一门面向协议的编程语言。这是因为面向对象存在以下几个问题：</p>
<p>1、动态派发的安全性（这应该是OC的困境，在Swift中Xcode是不可能让这种问题编译通过的）</p>
<p>2、横切关注点（Cross-Cutting Concerns）问题。面向对象无法描述两个不同事物具有某个相同特性这一点。</p>
<p>3、菱形问题（比如C++中）。C++可以多继承，在多继承中，两个父类实现了相同的方法，子类无法确定继承哪个父类的此方法，由于多继承的拓扑结构是一个菱形，所以这个问题有被叫做菱形缺陷（Diamond Problem）。</p>
<p>参考文章：</p>
<p><a href="https://swift.gg/2018/12/03/pop-vs-oop/">Swift 中的面向协议编程：是否优于面向对象编程？</a></p>
<p><a href="https://onevcat.com/2016/11/pop-cocoa-1/">面向协议编程与 Cocoa 的邂逅 (上)</a></p>
<h3 id="Any-与AnyObject-区别"><a href="#Any-与AnyObject-区别" class="headerlink" title="Any 与AnyObject 区别"></a><code>Any</code> 与<code>AnyObject</code> 区别</h3><p><strong>AnyObject</strong>： 是一个协议，所有class都遵守该协议，常用语跟OC对象的数据转换。</p>
<p><strong>Any</strong>：它可以代表任何型別的类(class)、结构体 (struct)、枚举 (enum)，包括函式和可选型，基本上可以说是任何东西。</p>
<h3 id="rethrows-和-throws-有什么区别呢？"><a href="#rethrows-和-throws-有什么区别呢？" class="headerlink" title="rethrows 和 throws 有什么区别呢？"></a><code>rethrows</code> 和 <code>throws</code> 有什么区别呢？</h3><p>throws是处理错误用的，可以看一个往沙盒写入文件的例子：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 写入的方法定义</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">write</span><span class="params">(to url: URL, options: Data.WritingOptions = [])</span></span> <span class="keyword">throws</span></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> data = <span class="type">Data</span>()</span><br><span class="line">    <span class="keyword">try</span> data.write(to: localUrl)</span><br><span class="line">&#125; <span class="keyword">catch</span> <span class="keyword">let</span> error &#123;</span><br><span class="line">    <span class="built_in">print</span>(error.localizedDescription)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将一个会有错误抛出的函数末尾加上<code>throws</code>，则该方法调用时需要使用<code>try</code>语句进行调用，用于提示当前函数是有抛错风险的，其中<code>catch</code>句柄是可以忽略的。</p>
<p><code>rethrows</code>与<code>throws</code>并没有太多不同，它们都是标记了一个方法应该抛出错误。但是 <code>rethrows</code> 一般用在参数中含有可以 <code>throws</code> 的方法的高阶函数中（想一下为什么是高阶函数？下期给出答案）。</p>
<p>查看<code>map</code>的方法声明，我们能同时看到 <code>throws</code>,<code>rethrows</code>：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@inlinable <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">map</span>&lt;T&gt;<span class="params">(<span class="number">_</span> transform: <span class="params">(Element)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">T</span>) <span class="keyword">rethrows</span> -&gt; [<span class="type">T</span>]</span><br></pre></td></tr></table></figure>

<p>不知道你们第一次见到<code>map</code>函数本体的时候会不会疑惑，为什么<code>map</code>里的闭包需要抛出错误？为什么我们调用的时候并没有用<code>try</code>语法也可以正常通过？</p>
<p>其实是这样的，<code>transform</code>是需要我们定义的闭包，它有可能抛出异常，也可能不抛出异常。Swift作为类型安全的语言就需要保证在有异常的时候需要使用try去调用，在没有异常的时候要正常调用，那怎么兼容这两种情况呢，这就是<code>rethrows</code>的作用了。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">squareOf</span><span class="params">(x: Int)</span></span> -&gt; <span class="type">Int</span> &#123;<span class="keyword">return</span> x * x&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">divideTenBy</span><span class="params">(x: Int)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> x != <span class="number">0</span> <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="type">CalculationError</span>.<span class="type">DivideByZero</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">10.0</span> / <span class="type">Double</span>(x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> theNumbers = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>]</span><br><span class="line"><span class="keyword">let</span> squareResult = theNumbers.<span class="built_in">map</span>(squareOf(x:)) <span class="comment">// [100, 400, 9000]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> divideResult = <span class="keyword">try</span> theNumbers.<span class="built_in">map</span>(divideTenBy(x:))</span><br><span class="line">&#125; <span class="keyword">catch</span> <span class="keyword">let</span> error &#123;</span><br><span class="line">    <span class="built_in">print</span>(error)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当我们直接写<code>let divideResult = theNumbers.map(divideTenBy(x:))</code>时，编译器会报错：<code>Call can throw but is not marked with &#39;try&#39;</code>。这样就实现了根据情况去决定是否需要用<code>try-catch</code>去捕获map里的异常了。</p>
<p>参考：<a href="https://swifter.tips/error-handle/">错误和异常处理</a></p>
<h3 id="break-return-continue-fallthough-在语句中的含义（switch、while、for）"><a href="#break-return-continue-fallthough-在语句中的含义（switch、while、for）" class="headerlink" title="break return continue fallthough 在语句中的含义（switch、while、for）"></a>break return continue fallthough 在语句中的含义（switch、while、for）</h3><p>这个比较简单，只说相对特别的示例吧，在Swift的switch语句，会在每个case结束的时候自动退出该switch判断，如果我们想不退出，继续进行下一个case的判断，可以加上<code>fallthough</code>。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/04/05/ios_photo_format_compare/"><i class="fas fa-angle-double-right"></i>iOS开发图片格式选择</a>
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-04-05T14:39:34.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2020-04-05</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2020-04-11T02:57:38.545Z"><i class="far fa-calendar-check">&nbsp;</i>2020-04-11</time>
                                
                
                
                <span class="level-item has-text-grey">
                    
                    
                    34 分钟 读完 (大约 5035 个字)
                </span>
                
                
            </div>
        </div>
        
        <!-- <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/04/05/ios_photo_format_compare/">iOS开发图片格式选择</a>
            
        </h1> -->
        <div class="content">
            <p><img src="https://user-gold-cdn.xitu.io/2020/4/6/1714d8ba5edf9f51?w=1022&h=512&f=png&s=436048" alt=""></p>
<h2 id="图片是如何显示的"><a href="#图片是如何显示的" class="headerlink" title="图片是如何显示的"></a>图片是如何显示的</h2><p>在讲解如何选择图片格式之前，我感觉有必要先了解下，图片是如何展示的。如果我们要展示一张图片，一般步骤是这样的：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// Assets.xcassets中的图片，不需要后缀</span></span><br><span class="line"><span class="keyword">let</span> image = <span class="type">UIImage</span>(named: <span class="string">"icon"</span>)</span><br><span class="line"><span class="keyword">let</span> imageView = <span class="type">UIImageView</span>(frame: rect)</span><br><span class="line">imageView.image = image</span><br><span class="line">view.addSubview(imageView)</span><br></pre></td></tr></table></figure>

<p>运行程序，我们就可以在指定位置看到这个icon。看似简单的代码背后隐藏了很多细节工作。一张图片的展示，从代码执行到展示出来大致经历了这些步骤：</p>
<p><strong>1. 加载图片</strong></p>
<ul>
<li><p>从磁盘中加载一张图片；</p>
</li>
<li><p>然后将生成的 <code>UIImage</code> 赋值给 <code>UIImageView</code> ；</p>
</li>
<li><p>接着一个隐式的 <code>CATransaction</code> 捕获到了 <code>UIImageView</code> 图层树的变化；</p>
</li>
<li><p>分配内存缓冲区用于管理文件 IO 和解压缩操作，将文件数据从磁盘读到内存中；</p>
</li>
</ul>
<p><strong>2. 图片解码（解压）</strong></p>
<ul>
<li>将压缩的图片数据解码成未压缩的位图形式，这是一个非常耗时的 CPU 操作，默认在主线程进行；</li>
</ul>
<p><strong>3. 图片渲染</strong></p>
<ul>
<li><p><code>Core Animation</code> 中<code>CALayer</code>使用解压（解码）的位图数据渲染 <code>UIImageView</code> 的图层；</p>
</li>
<li><p>CPU计算好图片的Frame，对图片解压之后，就会交给GPU来做图片渲染渲染流程；</p>
</li>
<li><p>GPU获取获取图片的坐标，将坐标交给顶点着色器(顶点计算)，将图片光栅化(获取图片对应屏幕上的像素点)，片元着色器计算(计算每个像素点的最终显示的颜色值)；</p>
</li>
<li><p>从帧缓存区中渲染到屏幕上；</p>
</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2020/4/6/1714d8aa5ffda915?w=1564&h=734&f=png&s=227216" alt=""></p>
<p>这其中有个关键步骤是图片解码。那为什么要解码呢，这是因为我们平常使用的图片一般为了节约空间都会经过一些压缩算法进行封装，而使用时屏幕要精确的渲染到每个像素点，这就需要把压缩的图片解码展开，便于系统处理。</p>
<h2 id="名词解释"><a href="#名词解释" class="headerlink" title="名词解释"></a>名词解释</h2><h3 id="有损vs无损"><a href="#有损vs无损" class="headerlink" title="有损vs无损"></a>有损vs无损</h3><p><strong>有损压缩</strong>：指在压缩文件大小的过程中，损失了一部分图片的信息，也即降低了图片的质量，并且这种损失是不可逆的，我们不可能从有一个有损压缩过的图片中恢复出全来的图片。常见的有损压缩手段，是按照一定的算法将临近的像素点进行合并。</p>
<p><strong>无损压缩</strong>：只在压缩文件大小的过程中，图片的质量没有任何损耗。我们任何时候都可以从无损压缩过的图片中恢复出原来的信息。</p>
<h3 id="索引色vs直接色"><a href="#索引色vs直接色" class="headerlink" title="索引色vs直接色"></a>索引色vs直接色</h3><p><strong>索引色</strong>：用一个数字来代表（索引）一种颜色，在存储图片的时候，存储一个数字的组合，同时存储数字到图片颜色的映射。这种方式只能存储有限种颜色，通常是256种颜色，对应到计算机系统中，使用一个字节的数字来索引一种颜色。</p>
<p><strong>直接色</strong>：使用四个数字来代表一种颜色，这四个数字分别代表这个颜色中红色、绿色、蓝色以及透明度。现在流行的显示设备可以在这四个维度分别支持256种变化，所以直接色可以表示2的32次方种颜色。当然并非所有的直接色都支持这么多种，为压缩空间使用，有可能只有表达红、绿、蓝的三个数字，每个数字也可能不支持256种变化之多。</p>
<h3 id="点阵图vs矢量图"><a href="#点阵图vs矢量图" class="headerlink" title="点阵图vs矢量图"></a>点阵图vs矢量图</h3><p><strong>点阵图</strong>：也叫做位图，像素图。构成点阵图的最小单位是象素，位图就是由象素阵列的排列来实现其显示效果的，每个象素有自己的颜色信息，在对位图图像进行编辑操作的时候，可操作的对象是每个象素，我们可以改变图像的色相、饱和度、明度，从而改变图像的显示效果。点阵图缩放会失真，用最近非常流行的沙画来比喻最恰当不过，当你从远处看的时候，画面细腻多彩，但是当你靠的非常近的时候，你就能看到组成画面的每粒沙子以及每个沙粒的颜色。</p>
<p><strong>矢量图</strong>：也叫做向量图。矢量图并不纪录画面上每一点的信息，而是纪录了元素形状及颜色的算法，当你打开一张矢量图的时候，软件对图形象对应的函数进行运算，将运算结果[图形的形状和颜色]显示给你看。无论显示画面是大还是小，画面上的对象对应的算法是不变的，所以，即使对画面进行倍数相当大的缩放，其显示效果仍然相同(不失真)。</p>
<h2 id="几种格式的对比"><a href="#几种格式的对比" class="headerlink" title="几种格式的对比"></a>几种格式的对比</h2><p>一张图片，如果我们将它的每一个像素及其对应的颜色都存储起来（BMP格式），是会很大的。为了减小图片占用的存储空间，派生出了各种不同压缩算法所代表的图片格式。常见的图片格式有png、jpeg、heic、gif、webp，svg等。</p>
<h3 id="PNG"><a href="#PNG" class="headerlink" title="PNG"></a>PNG</h3><p>PNG有两种类型：PNG-8和PNG-24。</p>
<ul>
<li><p>PNG-8是无损的、索引色、点阵图。它支持透明度的调节。</p>
</li>
<li><p>PNG-24是无损的、直接色、点阵图。因为使用直接色，颜色范围更大，也占用更大的空间。他的目标是替代JPEG，但一般而言，PNG-24的文件大小是JPEG的五倍之多，而显示效果则通常只能获得一点点提升。所以如果不是对图片质量要求特别高，不建议使用PNG-24</p>
</li>
</ul>
<p>PNG是苹果推荐的图片格式，而且这些图片会被一个叫<a href="http://pmt.sourceforge.net/pngcrush/">pngcrush</a>的开源工具优化，这样iOS设备就能在显示时更快的解压和渲染图片。该工具位于目录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;Applications&#x2F;Xcode.app&#x2F;Contents&#x2F;Developer&#x2F;Platforms&#x2F;iPhoneOS.platform&#x2F;Developer&#x2F;usr&#x2F;bin</span><br></pre></td></tr></table></figure>

<h3 id="JPEG"><a href="#JPEG" class="headerlink" title="JPEG"></a>JPEG</h3><p>JPEG是有损的、采用直接色的、点阵图压缩方式。<br>JEPG目标是在不影响人类可分辨的图片质量的前提下，尽可能的压缩文件大小。一般都是用于相机图片的格式。但因为有损，会导致图片失真。iOS可以通过以下方式压缩图片：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 压缩比范围从0到1</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">jpegData</span><span class="params">(compressionQuality: CGFloat)</span></span> -&gt; <span class="type">Data</span>?</span><br></pre></td></tr></table></figure>

<p><strong>题外话</strong><br>一般来说，相同的图片采用JPEG的压缩方式会比png得到更小的尺寸，但也有例外。<br><img src="https://user-gold-cdn.xitu.io/2020/4/6/1714d8a009a4b6af?w=1052&h=520&f=png&s=132763" alt=""><br><img src="https://user-gold-cdn.xitu.io/2020/4/6/1714d8ba5f6bc8e5?w=1036&h=884&f=png&s=598026" alt=""></p>
<p>在网上查了资料说是JEPG更适合处理带有很多杂色的风景图，而对于使用数位板等<strong>电子绘制</strong>的纯色卡通系风格图片，JEPG的压缩方式会适得其反，导致体积更大。</p>
<h3 id="HEIC"><a href="#HEIC" class="headerlink" title="HEIC"></a>HEIC</h3><p>HEIC是HEIF（High Efficiency Image Format 高效率图像文件格式）的一种。它并非苹果开发，而是由运动图像专家组（MPEG）开发。它同时支持有损压缩、无损压缩、透明度等特性。HEIF规范的完成是在2015年，是这几种图片格式中最新的一种了，目前除了苹果，还没有哪家大厂去拥抱这种格式。</p>
<p>在iOS 11更新后，iPhone 7及其后硬件，在拍摄照片时的默认图像存储格式。与JPG相比，它占用的空间更小，画质更加无损。HEIC的目的就是作为JPEG的继任者，以后或许会成为一种趋势。目前可以想到的在开发中的应用是，对于一些需要下载的大图可以转成HEIC格式，供客户端使用。但是当前却很少应用，大概率是考虑到图片兼容问题吧。</p>
<p><strong>题外话</strong></p>
<p>一个有趣的现象，我用相机（iPhoneXR）拍摄一张照片，通过AirDrop传到电脑，显示为HEIC格式。当我在拍照时选择系统自带的任意一种滤镜，图片格式就变成了JPEG。这是为什么？</p>
<p>有小伙伴解答：</p>
<p>iOS拍照选择滤镜会“转”为JPEG，是因为拍照的格式还是HEIF，加滤镜和编辑图片都是相当于复制了一份再做操作的，点击复原又会“转”为HEIF。</p>
<p>经过测试确实是这样的，而且既然苹果提供复原的操作，说明原图（HEIF）并没有被覆盖。那为什么滤镜不能直接在HEIF格式下操作，猜测可能是跟滤镜的算法相关，该算法只能对JEPG格式编码的图片进行渲染，所以需要中间转成JEPG。</p>
<p><strong>Live Photo</strong></p>
<p>Live图片的实质是：一张heic格式封面图 + mov格式视频。</p>
<p>对于Live Photo的展示，在原生应用中可以使用<a href="https://developer.apple.com/documentation/photokit/phlivephoto">PHLivePhotoView</a>，在Web应用中可以使用<a href="https://developer.apple.com/documentation/livephotoskitjs">LivePhotosKit JS</a>。</p>
<h3 id="WebP"><a href="#WebP" class="headerlink" title="WebP"></a>WebP</h3><p>WebP最初由Google发布于2010年，图片格式派生自VP8视频编码，也同时支持有损压缩、无损压缩、透明度等特性。2013年低，推出了Animated WebP，还可以支持动图。</p>
<p>WebP 集合了多种图片文件格式的特点。它像 JPEG 一样适合压缩照片和其他细节丰富的图片，像 GIF 一样可以显示动态图片，像 PNG 一样支持透明图像。根据 Google 的测试，WebP 无损压缩图片比 PNG 图片少了 45％ 的文件体积，即使这些 PNG 图片在使用 <code>pngcrush</code> 和 <code>PNGOUT</code> 处理后，WebP 依旧可以减少 28％ 的文件体积。可以在<a href="https://www.upyun.com/webp?utm_source=zhihu&utm_medium=referral&utm_campaign=260228870&utm_term=webp">点击</a>这里查看WebP对其它格式转换的效果。<br><img src="https://user-gold-cdn.xitu.io/2020/4/8/17158f8ce93ba11c?w=1168&h=679&f=png&s=749382" alt=""></p>
<p>小是WebP的最大优点，小意味着更少的流量，这也是各大流量入口在意的地方。目前Google、Facebook、阿里等大厂已经在广泛使用WebP格式，国内的一些图床服务（七牛、又拍云）也支持将图片自动转成WebP格式。</p>
<p>诚然WebP非常优秀，独自完成了图片格式”大一统”的任务。但苹果对WebP的支持却很少，只Safari目前还不支持WebP显示就阻断了很多人应用WebP的决心。</p>
<p>如果我们需要在项目中显示WebP格式图片就不得不导入Google的<code>libwebp</code>解码库。当然WebP的解码任务在iOS端有些库已经封装好了，OC端可以用<a href="https://github.com/SDWebImage/SDWebImageWebPCoder">SDWebImageWebPCoder</a>，Swift端可以用<a href="https://github.com/Yeatse/KingfisherWebP">KingfisherWebP</a>。以下是使用Kingfisher展示WebP图像的事例：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局配置对WebP图片的解码（仅针对WebP格式）</span></span><br><span class="line"><span class="type">KingfisherManager</span>.shared.defaultOptions += [</span><br><span class="line">    .processor(<span class="type">WebPProcessor</span>.<span class="keyword">default</span>),</span><br><span class="line">    .cacheSerializer(<span class="type">WebPSerializer</span>.<span class="keyword">default</span>)</span><br><span class="line">]</span><br><span class="line"><span class="comment">// 本地webp图片解码</span></span><br><span class="line"><span class="keyword">let</span> localUrl = <span class="type">Bundle</span>.main.url(forResource: <span class="string">"sunset"</span>, withExtension: <span class="string">"webp"</span>)</span><br><span class="line"><span class="keyword">let</span> dataProvider = <span class="type">LocalFileImageDataProvider</span>.<span class="keyword">init</span>(fileURL: localUrl!)</span><br><span class="line">imageView.kf.setImage(with: dataProvider)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 远程webp图片解码。一些图像服务器可能期望“Accept”标头包含“image/webp”，我们还需要加上</span></span><br><span class="line"><span class="keyword">let</span> modifier = <span class="type">AnyModifier</span> &#123; request <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">var</span> req = request</span><br><span class="line">    req.addValue(<span class="string">"image/webp */*"</span>, forHTTPHeaderField: <span class="string">"Accept"</span>)</span><br><span class="line">    <span class="keyword">return</span> req</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">KingfisherManager</span>.shared.defaultOptions += [</span><br><span class="line">    .requestModifier(modifier),</span><br><span class="line">    <span class="comment">// ... other options</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="PDF"><a href="#PDF" class="headerlink" title="PDF"></a>PDF</h3><p>pdf图片通常是矢量的，它的导入方式有些特殊。我们需要在<code>Assets.xcassets</code>文件，创建一个<code>New Image Set</code>，然后将该文件的<code>Scales</code>设置为<code>Single Scale</code>，拖入1x尺寸的pdf文件即可：<br><img src="https://user-gold-cdn.xitu.io/2020/4/6/1714d8a0099633fa?w=1174&h=652&f=png&s=184826" alt=""></p>
<p>使用时我们可以把它当做普通图片对待：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> image = <span class="type">UIImage</span>(named: <span class="string">"sunset"</span>)</span><br></pre></td></tr></table></figure>

<p>在运行期间Xcode会根据屏幕的比例因子生成对应尺寸的png图像。比如导入一张100x100的pdf图片，在2x和3x的机型里面会生成对应的200x200，300x300的png（可以在Assets.car中找到）。所以pdf只不过是Xcode处理图片的中间状态，下载到手机的应用包里面是没有这张pdf的。</p>
<p>这种处理方式有一个好处就是，当苹果以后发布一款4x屏幕的手机时，使用pdf处理的图片会自适应生成对应的4x资源，不需要再手动导入。但相比优点，pdf作为图片资源的缺点更多。</p>
<p>首先是尺寸上，因为是自动生成对应的png，并没有任何优化和压缩，而且我们也并不能在这中间做什么。对比相同尺寸经过<a href="https://imageoptim.com/mac">ImageOptim</a>压缩过的png，在大小上后者会是前者的1/2，甚至1/4。</p>
<p>另外pdf对阴影和渐变的处理会存在失真的情况：</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/4/6/1714d99db8700cfb?w=747&h=535&f=png&s=245741" alt=""></p>
<p>左边是png，右边是pdf。在一些渐变和光影的图像部分可以看出明显的失真。</p>
<p>更多关于pdf和png的差别，可以看这篇：Why I don’t use PDFs for iOS assets: <a href="https://bjango.com/articles/idontusepdfs/">https://bjango.com/articles/idontusepdfs/</a></p>
<h3 id="SVG-SF-Symbol"><a href="#SVG-SF-Symbol" class="headerlink" title="SVG/SF Symbol"></a>SVG/SF Symbol</h3><p>SVG是一种无损的矢量图，是众多矢量图中的一种，它的特点是使用XML来描述图片。使用XML的优点是，任何时候你都可以把它当做一个文本文件来对待，也就是说，你可以非常方便的修改SVG图片，你所需要的只需要一个文本编辑器。</p>
<p>在iOS13之前应用中直接使用SVG的场景非常少，但从iOS13开始，苹果推出了<a href="https://developer.apple.com/design/human-interface-guidelines/sf-symbols/overview/">SF Symbol</a>，一种svg格式的矢量符号集。而且苹果还提供了多于1500多种icon模板，我们可以在这里<a href="https://developer.apple.com/design/downloads/SF-Symbols.dmg">下载</a>查看。</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/4/6/1714d8a018369cdc?w=2244&h=1310&f=png&s=682672" alt=""></p>
<p>我们可以从中选择适合自己的icon，选中之后，从File &gt; Export Custom Symbol Templete中导出svg格式图片集，然后拖到Xcode的<code>Assets.xcassets</code>。</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/4/6/1714d8c1b3fc268b?w=1362&h=516&f=png&s=115284" alt=""></p>
<p>SF Symbol有9种粗细的调节——从ultralight到black——每一种都相当于<code>San Francisco</code>系统字体的重量（weight）。(SF Symbol中的SF是<code>San Francisco</code>（旧金山）的缩写)。这种对应使您能够在符号和相邻文本之间实现精确的权重匹配，同时支持不同大小和上下文的灵活性。</p>
<p>当然如果这些图标都不能满足需求，我们还可以自定义SF图标，然后通过SF Symbol App进行验证和导出。操作细节可以看这里：<a href="https://developer.apple.com/documentation/uikit/uiimage/creating_custom_symbol_images_for_your_app">Creating Custom Symbol Images for Your App</a>。</p>
<p>SF Symbol使用起来也很简单：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> configuration = <span class="type">UIImage</span>.<span class="type">SymbolConfiguration</span>.<span class="keyword">init</span>(scale: .small)</span><br><span class="line">imageView.image = <span class="type">UIImage</span>(systemName: <span class="string">"alarm"</span>, withConfiguration: configuration)</span><br></pre></td></tr></table></figure>

<p>SF Symbol可以一次性解决相同icon，不同尺寸，不同粗细的问题，它让我们处理图片像处理字体一样方便。可以想象这就是应用图标的未来。</p>
<p>当看到SF Symbol仅支持iOS13+，watchOS6+，我又不得不退回到现实，png也挺好的。</p>
<p><strong>题外话</strong></p>
<p>我在测试SF Symbol图标时，从生成的应用包中查看图片，会得到这样的结果：</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/4/6/1714d8c263b2fb72?w=322&h=292&f=png&s=43659" alt=""></p>
<p>代码中的我将图片设置为100x100，仅有这一处地方使用。跟pdf类似我们找不到svg源文件，这好理解，svg只是中间状态，我们最终使用的还是png，但为什么会有多个小尺寸的png图像呢？</p>
<h2 id="如何选择图片格式"><a href="#如何选择图片格式" class="headerlink" title="如何选择图片格式"></a>如何选择图片格式</h2><p>我们平常开发时，使用最多的就是png了，甚至可能是不加考虑的全部使用png。其实这样是不好的，我们应该充分发挥不同格式图片的优点，从<strong>兼容性</strong>、<strong>空间占用</strong>、<strong>展示效果</strong>三方面考量选取最佳格式。</p>
<p>关于图片格式的选择，苹果的<a href="https://developer.apple.com/design/human-interface-guidelines/ios/icons-and-images/image-size-and-resolution/">Human Interface Guidelines</a>有以下说法：</p>
<blockquote>
<p>一般情况下，使用PNG图片，因为PNG支持透明性，而且是无损的，压缩工件不会模糊重要的细节或改变颜色。对于需要阴影、纹理和高光效果的复杂艺术品来说，这是一个不错的选择。<strong>使用8位的PNG图形</strong>，不需要完全24位的颜色。8位PNG可以在不降低图像质量的情况下减小文件大小。精致的应用图标最好使用png。</p>
<p>对于照片应该使用JPEG格式，它的压缩算法<strong>通常</strong>比无损格式产生更小的尺寸，而且很难在照片中辨别出来。<strong>应该尝试优化JPEG文件，在大小和质量之间找到平衡</strong>。大多数JPEG文件可以被压缩而不会导致图像明显的退化。即使是少量的压缩也可以节省大量的磁盘空间。</p>
<p>使用PDF处理字形和其他需要高分辨率缩放的平面矢量图形。</p>
</blockquote>
<p>最终可以做以下总结。</p>
<table>
<thead>
<tr>
<th>图片格式</th>
<th>适用范围</th>
<th>注意事项</th>
</tr>
</thead>
<tbody><tr>
<td>png</td>
<td>应用icon，界面icon，卡通风格的背景图</td>
<td>导入项目前可以使用ImageOptim进行压缩</td>
</tr>
<tr>
<td>jpeg</td>
<td>尺寸较大的风景图，照片</td>
<td>不支持透明度；因为可以调节压缩比，可以在大小和质量之间寻找最佳平衡。</td>
</tr>
<tr>
<td>webp</td>
<td>支持有损、无损压缩、透明度、动图等特性，因为苹果本身不支持一般只应用于服务端返回来的图片</td>
<td>无法在xcode预览，不建议内置该类型图片</td>
</tr>
<tr>
<td>pdf</td>
<td>字形，高分辨率的矢量图</td>
<td>存在展开尺寸较大，光效失真的情况</td>
</tr>
<tr>
<td>svg（sf symbol）</td>
<td>指示性icon</td>
<td>仅支持iOS13及以上，系统sf符号是有版权的，使用时要注意应用范围和苹果要求</td>
</tr>
</tbody></table>
<h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p><a href="http://blog.leichunfeng.com/blog/2017/02/20/talking-about-the-decompression-of-the-image-in-ios/">谈谈 iOS 中图片的解压缩</a></p>
<p><a href="https://zhaox.github.io/multimedia/2016/01/13/introducing-image-types">图片格式那么多，哪种更适合你</a></p>
<p><a href="https://github.com/wangzz/Blog/blob/master/iOS/iOS%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E9%80%89%E6%8B%A9.md">iOS图片格式选择</a></p>
<p><a href="https://bjango.com/articles/idontusepdfs/">Why I don’t use PDFs for iOS assets</a></p>
<p><a href="https://www.avanderlee.com/swift/sf-symbols-guide/">SF Symbols: The benefits and how to use them guide</a></p>
<p><a href="https://www.upyun.com/tech/article/252/1.html?utm_source=zhihu&utm_medium=referral&utm_campaign=260228870&utm_term=webp">WebP 的前世今生</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/03/28/interview_kuaishou/"><i class="fas fa-angle-double-right"></i>快手iOS面经</a>
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-03-28T05:11:27.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2020-03-28</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2020-03-29T00:13:34.821Z"><i class="far fa-calendar-check">&nbsp;</i>2020-03-29</time>
                                
                
                <div class="level-item">
                <i class="far fa-folder-open has-text-grey"></i>&nbsp;
                <a class="has-link-grey -link" href="/categories/iOS/">iOS</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    15 分钟 读完 (大约 2195 个字)
                </span>
                
                
            </div>
        </div>
        
        <!-- <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/03/28/interview_kuaishou/">快手iOS面经</a>
            
        </h1> -->
        <div class="content">
            <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>过完年来北京之后，有准备看看机会，也是想了解下市场行情。简历没有投太多，只定向投了头条教育部门、抖音、快手、阿里，这些公司。头条和阿里的简历都没过，肯定是亮点太少吧。只有快手简历过了，快手是三轮技术面+一轮HR面，前两轮技术都比较顺利，到第三轮却栽了，很痛心o(╥﹏╥)o。目前就不考虑换工作了，等下半年再说了，接下来的时间再好好精炼一下。</p>
<p>快手是视频面试，不支持周末，但是可以选择晚上时间，我这几次都是定在了晚上九点。视频面试是通过牛客网进行的，以下是我还记得下来的各轮面试题，对于一些iOS基础知识就不做解答了。</p>
<h2 id="一面"><a href="#一面" class="headerlink" title="一面"></a>一面</h2><p>1、用递归写一个算法，计算从1到100的和。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum</span><span class="params">(value: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> value &lt;= <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> number = value</span><br><span class="line">    <span class="keyword">return</span> value + sum(value: number - <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 计算过程</span></span><br><span class="line"><span class="keyword">let</span> result = sum(value: <span class="number">100</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>写完算法之后又围绕着问了几个问题，都是算法基础：</p>
<ul>
<li>算法的时间复杂度是多少</li>
<li>递归会有什么缺点</li>
<li>不用递归能否实现，复杂度能否降到O(1)</li>
</ul>
<p>2、<code>property</code>的作用是什么，有哪些关键词，分别是什么含义？</p>
<p>3、父类的<code>property</code>是如何查找的？</p>
<p>4、<code>NSArray</code>、<code>NSDictionary</code>应该如何选关键词？</p>
<p>5、<code>copy</code>和<code>muteCopy</code>有什么区别，深复制和浅复制是什么意思，如何实现深复制？</p>
<p>6、用<code>runtime</code>做过什么事情？<code>runtime</code>中的方法交换是如何实现的？</p>
<p>7、讲一下对KVC合KVO的了解，KVC是否会调用<code>setter</code>方法？</p>
<p>8、<code>__block</code>有什么作用</p>
<p>9、说一下对GCD的了解，它有那些方法，分别是做什么用的？</p>
<p>10、对二叉树是否了解？</p>
<p>面试官是想接着问这方面的问题的。我当时说了不了解，然后就没有后续了。</p>
<h2 id="二面"><a href="#二面" class="headerlink" title="二面"></a>二面</h2><p>1、ARC和MRC的区别，iOS是如何管理引用计数的，什么情况下引用计数加1什么情况引用计数减一？</p>
<p>2、在MRC下执行<code>[object autorelease]</code>会发生什么，<code>autorelease</code>是如何实现的？</p>
<p>3、CoreAnimation是如何绘制图像的，动画过程中的frame能否获取到？</p>
<p>4、谈一下对Runlop的了解？</p>
<p>5、OC如何实现多继承？</p>
<p>这个当时没有答好。其实借助于消息转发，<code>protocol</code>和类别都可以间接实现多继承。</p>
<p>6、对设计模式有什么了解，讲一下其中一种是如何使用的。</p>
<p>7、有没有哪个开源库让你用的很舒服，讲一下让你舒服的地方。<br>我这里说了RxSwift中的观察者模式，和响应式编程。然后面试官问，如果要用OC实现一套RxSwift那样的逻辑应该怎么做。我回答的是结合KVO，将一些需要观察的属性，通过KVO进行监听，然后通过block回调出来。</p>
<p>8、一张100*100，RGBA的png图像解压之后占多大内存空间。<br>RGBA &gt; FFFFFFFF &gt; 4字节<br>所以会占用：(100 * 100 * 4) / 1024 = 39KB</p>
<p>9、算法题</p>
<p>题目：给定一个个数字arr，判断数组arr中是否所有的数字都只出现过一次。</p>
<p>这个并没有要求写出来，说是提供思路就行了。我当时给的方案是在便利数组的时候，用一个字典把便利的元素存起来，如果在后面的便利过程中新元素在字典中存在过就说明，有重复数字出现。时间复杂度是O(n)。</p>
<p>当时也问了有没有办法进行优化，我当时想到了将数组转成<code>Set</code>，然后和原数组比较，两个集合的数量是否变化。</p>
<p>10、因为我跟他介绍自己Swift用的多一些，然后问了些Swift跟OC的区别，各自的优缺点。</p>
<p>11、为什么离职，有什么职业规划。</p>
<h2 id="三面"><a href="#三面" class="headerlink" title="三面"></a>三面</h2><p>1、给定一个Int型数组，用里面的元素组成一个最大数，因为数字可能非常大，用字符串输出。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: [3,30,34,5,9]</span><br><span class="line">输出: 9534330</span><br></pre></td></tr></table></figure>

<p>这个是leetcode的<a href="https://leetcode-cn.com/problems/largest-number/">179题</a>，难度中等。面试官让先说思路，再去做题。事先说一下这个题我没有做过。当时的思路是用冒泡法进行排序，排序的前提是将较少位数的数字进行循环补齐，例如3和30的比较，变成33和30的比较，34和4的比较变成34和44的比较，然后将结果从大到小整合成字符串输出。</p>
<p>但是做题是却发现没那么简单，位数的补齐对于2位和3位数的比较还需要求位数的最小公倍数，将他们都转成6位数才能比较。在挣扎了5分钟做了就做罢了。</p>
<p>后来再去做这道题，其实这就是一个排序而已，只不过他的规则是按高位优先级更高的原则，而这一点跟字符串的比较保持一致，如果再加一些Swift的高阶函数，就可以写成：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">largestNumber</span><span class="params">(<span class="number">_</span> nums: [Int])</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="built_in">sort</span> = nums.<span class="built_in">map</span> &#123;<span class="string">"\($0)"</span>&#125;.sorted &#123; (lStr, rStr) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">return</span> lStr + rStr &gt; rStr + lStr</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="built_in">sort</span>.joined()</span><br><span class="line">    <span class="keyword">if</span> result.<span class="keyword">prefix</span>(<span class="number">1</span>) == <span class="string">"0"</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"0"</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/zhangferry/Images/master/blog/20200328114843.png" alt=""></p>
<p>2、项目中有这么一个方法<code>func findfile(dir: String suffix: String) -&gt; [String]</code> ，可以通过输入文件夹目录，和后缀检索出所需的文件。</p>
<p>例如需要在某个文件中检索txt文件或者mp4文件，那就传入dir和suffix就行了。现在又有一些需求，例如需要检索utf8格式的txt或者h264编码的mp4，也会有一些例如查找最近一周更新过的文件这样的需求，你如何优化这个类，让它满足这些情况？</p>
<p>我首先想到的是这么多需求不可能一个方法就完成，需要根据不同场景拆出不同的方法，但是这些同属于文件操作，会有一个共同使用的方法就是检索文件。这个方法需要传入文件目录，然后递归的返回当前目录所有文件路径。外部不同场景的调用逻辑就用一个<code>enum</code>完成，不同值对应相同范围的不同种类。</p>
<p>面试官比较关注内部共用的文件检索怎么写，他说子文件如果过多怎么办，如何优化。我有点懵，查找文件至少是要遍历一遍的，子文件过多，这个应该是没法优化的啊。中间卡了一段时间，后来他给了提示说是不是可以用block实现，将文件路径返回出去，由外部决定当前文件是否可用，最终外部的调用类是这个样子。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//我的方案</span></span><br><span class="line"><span class="comment">//func findDir(_ dir: String) -&gt; [String]</span></span><br><span class="line"><span class="comment">//block方案</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findDir</span><span class="params">(<span class="number">_</span> dir: String, block: <span class="params">(<span class="params">(String)</span></span></span></span> -&gt; <span class="type">Bool</span>))</span><br></pre></td></tr></table></figure>

<p>我想来确实没毛病，用block返回内容至少不会将该目录的所有文件都由一个对象持有，而前面一堆的铺垫其实也都是为验证block方案的好处。</p>
<p>其实事后想下这个问题没啥难的，这种写法自己也有写过，但当时就是没想起来，可能前面一圈的铺垫给我带偏了吧，说亏也不亏，以后多多努力吧。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>整体来看，快手的面试题跟我在别处看到的iOS面试题对比要简单些，一面主要是基础知识，二面考察更全面一些，更多让自己谈一些对技术的理解，三面则是更偏实践一些。</p>
<p>算法虽然三轮都有，但相对比较简单，即使写不出来，有思路也是可以的。当然写出来肯定是加分项，所以大家准备面试时，应该都看一下。算法相关的，排序，数组，二叉树，这几类是重点。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/02/23/runtime_objc_class/"><i class="fas fa-angle-double-right"></i>Runtime内存模型探究</a>
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-02-23T05:28:09.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2020-02-23</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2020-04-11T02:38:53.306Z"><i class="far fa-calendar-check">&nbsp;</i>2020-04-11</time>
                                
                
                
                <span class="level-item has-text-grey">
                    
                    
                    14 分钟 读完 (大约 2081 个字)
                </span>
                
                
            </div>
        </div>
        
        <!-- <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/02/23/runtime_objc_class/">Runtime内存模型探究</a>
            
        </h1> -->
        <div class="content">
            <p><img src="https://raw.githubusercontent.com/zhangferry/Images/master/blog/laptop-2838917_1280.jpg" alt=""></p>
<blockquote>
<p>Objective-C是一种通用、高级、面向对象的编程语言。它扩展了标准的ANSI C编程语言，将Smalltalk式的消息传递机制加入到ANSI C中。</p>
</blockquote>
<p>可以这么理解，Objective-C = C + Runtime，Runtime是将C语言具有面向对象功能的推动剂，是iOS开发中的核心概念。我们可以在苹果开源的 <a href="https://opensource.apple.com/tarballs/objc4/">runtime</a>（当前的最新版本objc4-779.1.tar.gz）中可以发现一些 Objective-C 对象模型的实现细节。</p>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/02/23/runtime_objc_class/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/02/01/vscode_python/"><i class="fas fa-angle-double-right"></i>VSCode配置Python版本</a>
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-02-01T03:28:09.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2020-02-01</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2020-03-08T12:38:19.739Z"><i class="far fa-calendar-check">&nbsp;</i>2020-03-08</time>
                                
                
                
                <span class="level-item has-text-grey">
                    
                    
                    9 分钟 读完 (大约 1315 个字)
                </span>
                
                
            </div>
        </div>
        
        <!-- <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/02/01/vscode_python/">VSCode配置Python版本</a>
            
        </h1> -->
        <div class="content">
            <p>刚学习Python没多久，对VSCode也不是很熟悉，在一次解问题的过程中，加深了对这两者的印象，于是记录一下。</p>
<p>环境：Mac OS 10.15，VSCode 1.41.1</p>
<h2 id="问题定位"><a href="#问题定位" class="headerlink" title="问题定位"></a>问题定位</h2><p>我在尝试用VSCode写python爬虫，遇到一个问题<code>ImportError: No module named requests</code>。</p>
<p>通过问题描述很容易知道问题，这是因为导入了<code>requests</code>库，但是VSCode却没有找到这个库。</p>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/02/01/vscode_python/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/01/01/2019-year-summary/"><i class="fas fa-angle-double-right"></i>2019年总结</a>
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-01-01T12:10:25.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2020-01-01</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2020-03-08T12:38:41.828Z"><i class="far fa-calendar-check">&nbsp;</i>2020-03-08</time>
                                
                
                
                <span class="level-item has-text-grey">
                    
                    
                    32 分钟 读完 (大约 4786 个字)
                </span>
                
                
            </div>
        </div>
        
        <!-- <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/01/01/2019-year-summary/">2019年总结</a>
            
        </h1> -->
        <div class="content">
            <blockquote>
<p>好像随着年龄的增长，对时间的感知就变得越来越弱了。总感觉2019年还是一个很新鲜的年份，但它却已经走完了，2020年好像很遥远的样子，但它已经到来了。来个总结吧，2019年，这一年有太多的酸甜苦辣。从工作、生活和规划三个方面展开说吧。</p>
</blockquote>
<h2 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h2><p><img src="https://raw.githubusercontent.com/zhangferry/Images/master/blog/thought-catalog-505eectW54k-unsplash.jpg" alt=""></p>
<p>年初原项目组有一位很厉害的开发离职了，当时是我俩共同负责一个项目。他开发经验比我多，而且工作态度和习惯都很好，是我见过的未数不多让我称赞的程序员。曾经一起工作的将近一年多时间里，我都以他为学习榜样。对于他的离职，我纠结了很长一段时间，自认这是对我对公司的一大损失。</p>
<p>后来很长的时间里，一直都没有招到合适的人，我便一个人扛起了项目。很多之前应该是两个人一起商量的问题都需要自己一个人去思考解决方式，渐渐的我不断磨练自己的独立思考能力。大半年下来，突然感觉自己被逼着成长了许多，从一个崇拜别人，向别人学习的角色变成了一个不惧怕任何技术难题，能够帮助别人解决困难的角色。</p>
<p>2019年学会的第一个最重要的道理，<strong>很多时候有一个可以依赖的对象，是会减弱自己探索和尝试的动力，而开发很多时候对技能的理解和掌握，乃至个人进步，都是要依靠自己的探索获取的</strong>。</p>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/01/01/2019-year-summary/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/12/07/transfom_oc_to_swift/"><i class="fas fa-angle-double-right"></i>OC项目转Swift指南</a>
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-12-07T10:28:09.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2019-12-07</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2020-03-08T12:38:31.328Z"><i class="far fa-calendar-check">&nbsp;</i>2020-03-08</time>
                                
                
                
                <span class="level-item has-text-grey">
                    
                    
                    23 分钟 读完 (大约 3480 个字)
                </span>
                
                
            </div>
        </div>
        
        <!-- <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/12/07/transfom_oc_to_swift/">OC项目转Swift指南</a>
            
        </h1> -->
        <div class="content">
            <p><img src="https://raw.githubusercontent.com/zhangferry/Images/master/blog/web-3967926_1280.jpg" alt=""></p>
<blockquote>
<p>运行环境：Xcode 11.1 Swift5.0</p>
</blockquote>
<p>最近参与的一个项目需要从Objective-C（以下简称OC）转到Swift，期间遇到了一些坑，于是有了这篇总结性的文档。如果你也有将OC项目Swift化的需求，可以作为参考。</p>
<p>OC转Swift有一个大前提就是你要对Swift有一定的了解，熟悉Swift语法，最好是完整看过一遍官方的<a href="https://docs.swift.org/swift-book/LanguageGuide/TheBasics.html">Language Guide</a>。</p>
<p>转换的过程分自动化和手动转译，鉴于自动化工具的识别率不能让人满意，大部分情况都是需要手动转换的。</p>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2019/12/07/transfom_oc_to_swift/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/11/22/ios_architecture_patterns/"><i class="fas fa-angle-double-right"></i>【译】iOS 架构模式--浅析MVC, MVP, MVVM 和 VIPER</a>
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-11-22T06:39:34.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2019-11-22</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2020-03-08T12:39:27.146Z"><i class="far fa-calendar-check">&nbsp;</i>2020-03-08</time>
                                
                
                
                <span class="level-item has-text-grey">
                    
                    
                    37 分钟 读完 (大约 5554 个字)
                </span>
                
                
            </div>
        </div>
        
        <!-- <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/11/22/ios_architecture_patterns/">【译】iOS 架构模式--浅析MVC, MVP, MVVM 和 VIPER</a>
            
        </h1> -->
        <div class="content">
            <blockquote>
<p>作者：Bohdan Orlov<br>原文地址：<a href="https://medium.com/ios-os-x-development/ios-architecture-patterns-ecba4c38de52">https://medium.com/ios-os-x-development/ios-architecture-patterns-ecba4c38de52</a></p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/zhangferry/Images/master/blog/20191122154526.png" alt=""></p>
<p>在iOS开发过程中你是否对MVC的使用感觉很别扭？你是否对转向MVVM有疑惑？你听说过VIPER，但不清楚这个东西是否值得一试。</p>
<p>接着读下去，你会找到上面这些问题的答案。如果读完仍不能解惑，欢迎到评论区捶我。</p>
<p>接下来你将在iOS环境下构建关于架构模式的知识体系。我们将简要构建一些经典的例子，并在理论和实践上进行比较他们的不同。如果你需要更多关于任何一个特定的细节，请关注我。</p>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2019/11/22/ios_architecture_patterns/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/11/09/thanks_letter/"><i class="fas fa-angle-double-right"></i>感谢大家的帮助</a>
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-11-09T05:58:34.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2019-11-09</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2019-11-09T12:29:39.375Z"><i class="far fa-calendar-check">&nbsp;</i>2019-11-09</time>
                                
                
                
                <span class="level-item has-text-grey">
                    
                    
                    10 分钟 读完 (大约 1540 个字)
                </span>
                
                
            </div>
        </div>
        
        <!-- <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/11/09/thanks_letter/">感谢大家的帮助</a>
            
        </h1> -->
        <div class="content">
            <h2 id="好消息"><a href="#好消息" class="headerlink" title="好消息"></a>好消息</h2><p>开始水滴筹之后，父亲治病的消息大家就都知道了，期间收到了很多来自亲友的支持和帮助。先告诉大家好消息，父亲手术完了，并且身体恢复一切正常，已于11月8号中午从重症监护室转到无菌病房，还需要在里面待够五天才转到普通病房。关于看病所需要的筹款，也得到了解决。今天晚上7点左右，我已经终止了这次筹款。</p>
<p>看病资金问题能快速解决，除了来自水滴筹的筹款，还有就是公司的大力支持。三位老板帮助了2万元，还破格提前给我发了年终奖，算上水滴筹中的63588元，一直到出院应该是没什么问题了。</p>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2019/11/09/thanks_letter/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/11/08/shuidi/"><i class="fas fa-angle-double-right"></i>关于水滴筹</a>
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-11-07T23:08:34.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2019-11-08</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2019-11-09T12:29:39.315Z"><i class="far fa-calendar-check">&nbsp;</i>2019-11-09</time>
                                
                
                
                <span class="level-item has-text-grey">
                    
                    
                    10 分钟 读完 (大约 1556 个字)
                </span>
                
                
            </div>
        </div>
        
        <!-- <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/11/08/shuidi/">关于水滴筹</a>
            
        </h1> -->
        <div class="content">
            <p>很多朋友因为我的原因关注并参与到水滴筹中，有些小伙伴因为担心水滴筹有手续费用就直接把钱打给我。为了打消大家的顾虑，我花了些时间理解水滴筹背后的一些事情。</p>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2019/11/08/shuidi/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/page/0/">上一页</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/2/">下一页</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link is-current" href="/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/2/">2</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/6/">6</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="" src="/images/avatar.png" alt="zhangferry">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        zhangferry
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        iOS开发
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>北京</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            59
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            4
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            29
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/zhangferry" target="_blank" rel="noopener">
                关注我</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/zhangferry">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Weibo" href="https://weibo.com/2947186387/profile">
                
                <i class="fab fa-weibo"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Twitter" href="https://twitter.com">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="RSS" href="https://zhangferry.com/atom.xml">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            链接
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="http://colin1994.github.io/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">Colin</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">colin1994.github.io</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="http://www.evenvi.com/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">Evenvi</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.evenvi.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/ANCS/" style="font-size: 10px;">ANCS</a> <a href="/tags/AVPlayer/" style="font-size: 11.67px;">AVPlayer</a> <a href="/tags/Cocoapods/" style="font-size: 10px;">Cocoapods</a> <a href="/tags/DFU/" style="font-size: 10px;">DFU</a> <a href="/tags/Hexo/" style="font-size: 11.67px;">Hexo</a> <a href="/tags/Hybrid/" style="font-size: 10px;">Hybrid</a> <a href="/tags/Notification/" style="font-size: 10px;">Notification</a> <a href="/tags/Swift/" style="font-size: 10px;">Swift</a> <a href="/tags/UI/" style="font-size: 13.33px;">UI</a> <a href="/tags/git/" style="font-size: 11.67px;">git</a> <a href="/tags/iOS/" style="font-size: 20px;">iOS</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 13.33px;">博客</a> <a href="/tags/%E5%B7%A5%E4%BD%9C/" style="font-size: 10px;">工作</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">工具</a> <a href="/tags/%E6%8B%9B%E8%81%98/" style="font-size: 10px;">招聘</a> <a href="/tags/%E6%9C%88%E6%8A%A5/" style="font-size: 18.33px;">月报</a> <a href="/tags/%E6%9C%AC%E5%9C%B0%E5%8C%96/" style="font-size: 10px;">本地化</a> <a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size: 16.67px;">生活</a> <a href="/tags/%E7%A8%8B%E5%BA%8F%E5%91%98/" style="font-size: 10px;">程序员</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a> <a href="/tags/%E7%BF%BB%E8%AF%91/" style="font-size: 10px;">翻译</a> <a href="/tags/%E8%93%9D%E7%89%99/" style="font-size: 15px;">蓝牙</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">计算机网络</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 11.67px;">设计模式</a> <a href="/tags/%E9%98%85%E8%AF%BB/" style="font-size: 10px;">阅读</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 11.67px;">面试</a> <a href="/tags/%E9%BB%91%E8%8B%B9%E6%9E%9C/" style="font-size: 10px;">黑苹果</a>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2020/05/10/swifter_question/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Swift黄金选手鉴定手册">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-09T16:00:34.000Z">2020-05-10</time></div>
                    <a href="/2020/05/10/swifter_question/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Swift黄金选手鉴定手册</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/04/05/ios_photo_format_compare/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="iOS开发图片格式选择">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-04-05T14:39:34.000Z">2020-04-05</time></div>
                    <a href="/2020/04/05/ios_photo_format_compare/" class="title has-link-black-ter is-size-6 has-text-weight-normal">iOS开发图片格式选择</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/03/28/interview_kuaishou/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="快手iOS面经">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-03-28T05:11:27.000Z">2020-03-28</time></div>
                    <a href="/2020/03/28/interview_kuaishou/" class="title has-link-black-ter is-size-6 has-text-weight-normal">快手iOS面经</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/iOS/">iOS</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/02/23/runtime_objc_class/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Runtime内存模型探究">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-02-23T05:28:09.000Z">2020-02-23</time></div>
                    <a href="/2020/02/23/runtime_objc_class/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Runtime内存模型探究</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/02/01/vscode_python/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="VSCode配置Python版本">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-02-01T03:28:09.000Z">2020-02-01</time></div>
                    <a href="/2020/02/01/vscode_python/" class="title has-link-black-ter is-size-6 has-text-weight-normal">VSCode配置Python版本</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">五月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/04/">
                <span class="level-start">
                    <span class="level-item">四月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/03/">
                <span class="level-start">
                    <span class="level-item">三月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">二月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">一月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">八月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">七月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">六月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">四月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/02/">
                <span class="level-start">
                    <span class="level-item">二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/01/">
                <span class="level-start">
                    <span class="level-item">一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/10/">
                <span class="level-start">
                    <span class="level-item">十月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">九月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">八月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">七月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">八月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">六月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">十月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">九月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">八月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/03/">
                <span class="level-start">
                    <span class="level-item">三月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ANCS/">
                        <span class="tag">ANCS</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/AVPlayer/">
                        <span class="tag">AVPlayer</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Cocoapods/">
                        <span class="tag">Cocoapods</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/DFU/">
                        <span class="tag">DFU</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Hexo/">
                        <span class="tag">Hexo</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Hybrid/">
                        <span class="tag">Hybrid</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Notification/">
                        <span class="tag">Notification</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Swift/">
                        <span class="tag">Swift</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/UI/">
                        <span class="tag">UI</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/git/">
                        <span class="tag">git</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/iOS/">
                        <span class="tag">iOS</span>
                        <span class="tag is-grey">15</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/mac/">
                        <span class="tag">mac</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/python/">
                        <span class="tag">python</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%8D%9A%E5%AE%A2/">
                        <span class="tag">博客</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%B7%A5%E4%BD%9C/">
                        <span class="tag">工作</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%B7%A5%E5%85%B7/">
                        <span class="tag">工具</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%8B%9B%E8%81%98/">
                        <span class="tag">招聘</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%9C%88%E6%8A%A5/">
                        <span class="tag">月报</span>
                        <span class="tag is-grey">13</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%9C%AC%E5%9C%B0%E5%8C%96/">
                        <span class="tag">本地化</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%94%9F%E6%B4%BB/">
                        <span class="tag">生活</span>
                        <span class="tag is-grey">10</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%A8%8B%E5%BA%8F%E5%91%98/">
                        <span class="tag">程序员</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/">
                        <span class="tag">算法</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%BF%BB%E8%AF%91/">
                        <span class="tag">翻译</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%93%9D%E7%89%99/">
                        <span class="tag">蓝牙</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">
                        <span class="tag">计算机网络</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
                        <span class="tag">设计模式</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E9%98%85%E8%AF%BB/">
                        <span class="tag">阅读</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E9%9D%A2%E8%AF%95/">
                        <span class="tag">面试</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E9%BB%91%E8%8B%B9%E6%9E%9C/">
                        <span class="tag">黑苹果</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen is-sticky">
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo_2.svg" alt="zhangferry" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 zhangferry&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                共<span id="busuanzi_value_site_uv">0</span>个访客
                </span>
                <span id="busuanzi_container_site_pv">
                共<span id="busuanzi_value_site_pv">0</span>访问量
              </span>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'http://zhangferry.github.io',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>














<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>