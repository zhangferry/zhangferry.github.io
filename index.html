<!doctype html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="zhangferry`s blog" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
<meta property="og:type" content="website">
<meta property="og:title" content="zhangferry`s blog">
<meta property="og:url" content="http://zhangferry.github.io/index.html">
<meta property="og:site_name" content="zhangferry`s blog">
<meta property="og:description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="zhangferry`s blog">
<meta name="twitter:description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主大人'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://zhangferry.github.io/"/>





  <title> zhangferry`s blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?afe60f79e35ee3c65b92d9a2ff459653";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">zhangferry`s blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2019/01/02/ios-monthly-report-12/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="zhangferry">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/zhangferry.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="zhangferry`s blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="zhangferry`s blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/01/02/ios-monthly-report-12/" itemprop="url">
                  iOS开发月报#6|201812
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-01-02T10:54:57+08:00">
                2019-01-02
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2019/01/02/ios-monthly-report-12/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/01/02/ios-monthly-report-12/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2019/01/02/ios-monthly-report-12/" class="leancloud_visitors" data-flag-title="iOS开发月报#6|201812">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">Visitors </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="大事件"><a href="#大事件" class="headerlink" title="大事件"></a>大事件</h2><hr>
<p>这个月的大事件是高通与苹果之间的专利大战。高通分别在中国和德国对苹果公司提起专利诉讼，结果均胜。苹果将在中国禁售iPhoneX及之前的机型。在德国则是全面禁售。<br>加上新品手机的创新力度不够，导致苹果股票持续走低，四个月前，苹果还是首个突破万亿美元市值的上市公司，到现在股价已经下跌了 36%，市值只有 7160 亿美元，几个月内市值损失接近 3000 亿美元。<br><img src="https://upload-images.jianshu.io/upload_images/1059465-4e4811eeba166496.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="news.png"></p>
<h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><hr>
<h3 id="更换启动图不生效"><a href="#更换启动图不生效" class="headerlink" title="更换启动图不生效"></a>更换启动图不生效</h3><p><strong>现象</strong>：更换启动图，不生效，即使删除旧图，运行程序启动图仍然是之前的版本。<br>尝试了删除app重装，clean、重启Xcode，删除DriverData，还试过挪图片位置，改名字，均无效。最后尝试了重启手机-&gt;再安装才正常。</p>
<p><strong>问题分析</strong>：这个是系统问题，为了加快程序启动的速度系统会把启动图做个缓存，之后每次启动是加载缓存启动图，所以才会出现修改不生效问题。但我们也并不知道系统会什么时候更新启动图，这个就有点尴尬😓<br>stackoverflow上有关于这个问题的讨论：<br><a href="https://stackoverflow.com/questions/33002829/ios-keeping-old-launch-screen-and-app-icon-after-update" target="_blank" rel="external">iOS Keeping old launch screen and app icon after update</a></p>
<p>有人说这个不影响线上版本，从上线之后的测试来看，大部分用户没有受到影响，但还是出现了部分手机升级却未更换启动图的问题。<br>因为是系统层面控制，没有太好的解决方案，如果有人遇到这个情况，需要注意一下。</p>
<h3 id="赋值权限"><a href="#赋值权限" class="headerlink" title="赋值权限"></a>赋值权限</h3><p>在Mac 系统的终端上修改文件权限使用的是 Linux 中的 chmod 命令：<br>r：可读，表示可以读取内容<br>w:可写，表示可以编辑内容，但是不可以删除文件<br>x: 可执行，表示可以执行文件。</p>
<p>r:4<br>w:2<br>x:1<br>rwx=4+2+1=7</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1059465-078779097f1aa66f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="rwx.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ chmod 777 file</div></pre></td></tr></table></figure>
<p>这行命令的意思就是：文件所有者权限是7，同用户组的权限是7，其他非本地用户组的权限是7。同理可以出现这样的命令 chmod740.barshrc</p>
<p>再讲两个：<br>chmod u=rwx, go=rx .barshrc 这个命令中u表示拥有者，g表示group中的用户，o表示others，和上面的想对应。注意go=rx，这里go是拼接起来的，表示g和o的用户有读和执行的权限。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ chmod a+w .barshrc</div></pre></td></tr></table></figure></p>
<p>表示所有的用户（a表示all）增加写的权限。</p>
<h3 id="App图片瘦身"><a href="#App图片瘦身" class="headerlink" title="App图片瘦身"></a>App图片瘦身</h3><p>随着项目版本的不断迭代，会很容易积累越来越多的图片，对这些图片我们有两个主要方面可以优化：</p>
<h4 id="1、删除不用的图片"><a href="#1、删除不用的图片" class="headerlink" title="1、删除不用的图片"></a>1、删除不用的图片</h4><p>我们需要借助一个工具<a href="https://github.com/tinymind/LSUnusedResources" target="_blank" rel="external">LSUnusedResources</a><br>它可以检索项目中未使用的图片资源，我们可以指定检索图片的路径，后缀进行过滤。<br><strong>注意</strong>：无法区分png序列的引用。最好手动删除</p>
<h4 id="2、图片压缩"><a href="#2、图片压缩" class="headerlink" title="2、图片压缩"></a>2、图片压缩</h4><p>可以通过<a href="https://imageoptim.com/mac" target="_blank" rel="external">ImageOptim</a>，对图片进行无损压缩。使用时只需将要压缩的文件拖到程序中即可。<br>如果图片较多时，可以借助其命令行工具：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/Applications/ImageOptim.app/Contents/MacOS/ImageOptim $file_name</div></pre></td></tr></table></figure></p>
<p>对应的shell脚本:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 处理文件名出现空格问题</div><div class="line">MY_IFS=$IFS</div><div class="line">IFS=$&apos;\n&apos;</div><div class="line">for file_name in $(find &quot;$1&quot; -name &quot;*.png&quot; -type f); do</div><div class="line">echo $file_name</div><div class="line">/Applications/ImageOptim.app/Contents/MacOS/ImageOptim $file_name</div><div class="line">done</div><div class="line">IFS=$MY_IFS</div></pre></td></tr></table></figure></p>
<p>该工具还有一个Sketch插件：<a href="https://imageoptim.com/sketch" target="_blank" rel="external">Plugin for Sketch
</a>，可以在输出icon的时候直接进行压缩优化。</p>
<h3 id="后台音频耗电问题"><a href="#后台音频耗电问题" class="headerlink" title="后台音频耗电问题"></a>后台音频耗电问题</h3><p><strong>功能：</strong>一段助眠音频可以后台播放，播放完成后如果返回app，会跳到对应的完成界面。<br><strong>问题：</strong>有用户反馈，听音频睡着了，早上醒来，电量掉了很多（40%）。<br><strong>调研：</strong><br>使用Xcode中 <code>Debug Navigator</code>栏的<code>Energy Debug Gauge</code>（需真机）测试。播放完成4分钟左右的后台耗电状态如下：<br><img src="https://upload-images.jianshu.io/upload_images/1059465-4dc9ec91be8167f5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Energy Debug Gauge.png"><br>分析可知虽然此时app停止了所有行为，但是生命周期仍处于<code>Background</code>状态，耗电量也还是存在的。暂时认为问题是客户端一直处于<code>Background</code>模式，并未被<code>Suspend</code>，导致一直被系统维护着，所以一直有耗电情况。</p>
<p>再一次查看苹果关于后台模式的文档：</p>
<blockquote>
<p>When the UIBackgroundModes key contains the audio value, the system’s media frameworks automatically prevent the corresponding app from being suspended when it moves to the background. As long as it is playing audio or video content or recording audio content, the app continues to run in the background. However, if recording or playback stops, the system suspends the app.</p>
</blockquote>
<p>可知，只要播放器未被销毁，就会一直占用后台模式！<br><strong>解决方案：</strong><br>在播放完成时销毁播放器。</p>
<p><strong>检验：</strong><br>再次观察播放音频完成一段时间之后的后台耗电情况：<br><img src="https://upload-images.jianshu.io/upload_images/1059465-941fcf791ca2dc28.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>此时app被挂起，耗电量基本为0，唤醒app，仍能正常工作。问题解决。</p>
<h2 id="推荐阅读"><a href="#推荐阅读" class="headerlink" title="推荐阅读"></a>推荐阅读</h2><hr>
<p>尝试分模块整理推荐阅读的内容</p>
<h3 id="iOS开发过程中的设计模式"><a href="#iOS开发过程中的设计模式" class="headerlink" title="iOS开发过程中的设计模式"></a>iOS开发过程中的设计模式</h3><p><img src="https://upload-images.jianshu.io/upload_images/1059465-e0dc16cd94be1833.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="design pattern.jpeg"></p>
<blockquote>
<p>设计模式是一套被反复使用的、多数人知晓的、经过分类编目的、代码设计经验的总结。使用设计模式是为了重用代码、让代码更容易被他人理解、保证代码可靠性。 毫无疑问，设计模式于己于他人于系统都是多赢的，设计模式使代码编制真正工程化，设计模式是软件工程的基石，如同大厦的一块块砖石一样。项目中合理地运用设计模式可以完美地解决很多问题，每种模式在现实中都有相应的原理来与之对应，每种模式都描述了一个在我们周围不断重复发生的问题，以及该问题的核心解决方案，这也是设计模式能被广泛应用的原因。</p>
</blockquote>
<p>以上摘自<a href="http://www.runoob.com/design-pattern/design-pattern-intro.html" target="_blank" rel="external">菜鸟教程</a></p>
<p><a href="https://medium.com/flawless-app-stories/strategy-pattern-in-swift-1462dbddd9fe" target="_blank" rel="external">Swift中的策略模式</a><br>从一个小例子入手，讲解策略模式在swift中的使用。</p>
<p><a href="https://swift.gg/2018/09/10/design-pattern-creational/" target="_blank" rel="external">Swift 中的设计模式 #1 工厂方法与单例方法</a><br><a href="https://swift.gg/2018/11/26/design-pattern-behavorial/" target="_blank" rel="external">Swift 中的设计模式 #2 观察者模式与备忘录模式</a><br><a href="https://swift.gg/2018/11/29/design-pattern-structural/" target="_blank" rel="external">Swift 中的设计模式 #3 外观模式与适配器模式</a><br>SwiftGG翻译组翻译的设计模式系列文章。</p>
<p><a href="https://github.com/skyming/Trip-to-iOS-Design-Patterns" target="_blank" rel="external">设计模式资料整理</a><br>应该是目前总结最全的适合iOS开发的设计模式资料汇总。</p>
<h3 id="iOS逆向"><a href="#iOS逆向" class="headerlink" title="iOS逆向"></a>iOS逆向</h3><p><img src="https://upload-images.jianshu.io/upload_images/1059465-f0ddd03518d37a5d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="apple-hook.png"></p>
<blockquote>
<p>iOS应用逆向工程，是指从目标应用的界面及功能表现入手，使用不同的工具和理论知识去分析其实现原理，得出应用的代码结构、整体设计、功能实现、执行流程等，然后利用iOS的系统知识和语言特性，借鉴或修改原有实现流程的技术。</p>
</blockquote>
<p>推荐两篇掘金上关于iOS逆向的文章：<br><a href="https://juejin.im/post/5c19a38ae51d453e0a209256" target="_blank" rel="external">TikTok(抖音国际版)逆向，全球的小姐姐们，我来啦！</a><br><a href="https://juejin.im/post/5bc425495188255c9d564044" target="_blank" rel="external">逆向 Mac 应用 Bartender</a><br>这两篇都是通过具体实例入手，讲解逆向常用的工具和一些逆向的思路，非常适合新手。最好跟着介绍实际操作一番，第一次成功逆向一个项目之后，那种爽歪歪的感觉，你懂的！</p>
<p>另外推荐一位逆向领域的牛人刘培庆（<a href="https://www.alonemonkey.com/" target="_blank" rel="external">博客</a>，<a href="https://github.com/AloneMonkey" target="_blank" rel="external">github</a>），了解逆向的同学大多应该都不陌生，iOS方面的逆向优先参照 <strong><a href="https://github.com/AloneMonkey/MonkeyDev" target="_blank" rel="external">MonkeyDev</a></strong>。<br>刘总今年出了新书《iOS应用逆向与安全》，非常适合对逆向有兴趣的同学。</p>
<h3 id="利用脚本提高工作效率"><a href="#利用脚本提高工作效率" class="headerlink" title="利用脚本提高工作效率"></a>利用脚本提高工作效率</h3><blockquote>
<p>脚本语言（英语：Scripting language）是为了缩短传统的“编写、编译、链接、运行”（edit-compile-link-run）过程而创建的计算机编程语言。早期的脚本语言经常被称为批处理语言或工作控制语言。一个脚本通常是解释运行而非编译。脚本语言通常都有简单、易学、易用的特性，目的就是希望能让程序员快速完成程序的编写工作</p>
</blockquote>
<p><a href="https://sspai.com/post/46912" target="_blank" rel="external">AppleScript入门：探索macOS自动化</a></p>
<p>文章选自少数派，讲述了：</p>
<ul>
<li>什么是 AppleScript？</li>
<li>我使用 AppleScript 的情境</li>
<li>AppleScript 基础语法</li>
<li>AppleScript suite 之外的解法：模拟键鼠</li>
</ul>
<p>非常清晰详细的AppleScript入门文章。<br><a href="https://juejin.im/post/5bfac61ee51d454af013a900" target="_blank" rel="external">如何提高工作效率 - 自动化篇</a><br>文章选自掘金，串联Shell Script, Apple Script, Automator, Alfred &amp; WorkFlows，告诉你如果灵活应用，达到利用脚本提高工作效率的目的。</p>
<p>我写了一个利用AppleScript和Alfred的WorkFlows在命令行打开指定路径的工具。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1059465-4ada69de8b235846.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="workflow.png"></p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">on</span> <span class="built_in">run</span> argv</div><div class="line"><span class="keyword">tell</span> <span class="built_in">application</span> <span class="string">"Finder"</span></div><div class="line"><span class="comment">-- get selection path</span></div><div class="line"><span class="keyword">set</span> pathFile <span class="keyword">to</span> selection <span class="keyword">as</span> <span class="built_in">text</span></div><div class="line"><span class="keyword">set</span> pathFile <span class="keyword">to</span> <span class="keyword">get</span> <span class="keyword">POSIX path</span> <span class="keyword">of</span> pathFile</div><div class="line"><span class="comment">-- fix space problem in the directory</span></div><div class="line"><span class="keyword">set</span> pathFile <span class="keyword">to</span> <span class="keyword">quoted form</span> <span class="keyword">of</span> pathFile</div><div class="line"><span class="keyword">tell</span> <span class="built_in">application</span> <span class="string">"Terminal"</span></div><div class="line"><span class="built_in">activate</span></div><div class="line"><span class="keyword">tell</span> window <span class="number">1</span></div><div class="line">do <span class="keyword">script</span> <span class="string">"cd "</span> &amp; pathFile</div><div class="line"><span class="keyword">end</span> <span class="keyword">tell</span></div><div class="line"><span class="keyword">end</span> <span class="keyword">tell</span></div><div class="line"><span class="keyword">end</span> <span class="keyword">tell</span></div><div class="line"><span class="keyword">end</span> <span class="built_in">run</span></div></pre></td></tr></table></figure>
<p>使用方法是：点击选中文件夹，按下热键<code>CMD + T</code>。</p>
<h2 id="音视频"><a href="#音视频" class="headerlink" title="音视频"></a>音视频</h2><p><strong><a href="https://talk.swift.gg/9" target="_blank" rel="external">创业那点事：听莲叔和羊叔回忆峥嵘岁月</a></strong><br>莲叔和羊叔是 SwiftGG 翻译组的真·大佬。成绩好，学历高，思维缜密，能力很强。听过《升职加薪》那期节目的朋友应该都有印象。作为标准的技术人才，在创业大潮中自然也想试试身手，打拼一番。</p>
<p><strong><a href="https://talk.swift.gg/8" target="_blank" rel="external">和 Cee 聊聊如何拿 Google Offer</a></strong><br>翻译组里真是人才辈出啊，前几天 Cee 在群里说了个好消息，他拿到了美国 Google 的 Offer。群友们纷纷表示祝贺并进行了隆重的认哥仪式，将 SwiftGG 诞生以来第一个 GG（哥哥） 称号颁发给我们公认的大哥 Cee。</p>
<p>以上两个音频来自于(ggtalk)[<a href="https://talk.swift.gg/]，也是我最近上下班路上用来消遣的音频节目，墙裂推荐！" target="_blank" rel="external">https://talk.swift.gg/]，也是我最近上下班路上用来消遣的音频节目，墙裂推荐！</a></p>
<p><strong><a href="https://www.bilibili.com/video/av21376839" target="_blank" rel="external">计算机科学速成课</a></strong><br>由<a href="https://twitter.com/missphilbin" target="_blank" rel="external">Carrie Anne Philbin</a>主讲，Carrie Anne Philbin是一名计算机科学教师和作家。她是树莓派基金会的教育主管，也是学校(CAS)多样性和包容组的主席。她为青少年写了电脑书《树莓派历险记》。特意介绍是因为我感觉这个课程因为这个主讲人的个人魅力而趣味十足😄。不管你是不是计算机专业的学生，看过之后应该都能有所收获。</p>
<h2 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h2><h3 id="12306ForMac"><a href="#12306ForMac" class="headerlink" title="12306ForMac"></a><a href="https://github.com/fancymax/12306ForMac" target="_blank" rel="external">12306ForMac</a></h3><p>以前要么开Windows虚拟机，要么使用官方Web，现在可以使用12306ForMac订票助手啦。希望对大家有所帮助！</p>
<h3 id="LongestCocoa"><a href="#LongestCocoa" class="headerlink" title="LongestCocoa"></a><a href="https://github.com/Quotation/LongestCocoa" target="_blank" rel="external">LongestCocoa</a></h3><p>SoWhatIsTheLongestMethodOrConstantNamesInCocoaFramework? （那么，Cocoa框架中最长的方法名或常量名是什么？）答案是：</p>
<ul>
<li><p>outputImageProviderFromBufferWithPixelFormat:pixelsWide:pixelsHigh:baseAddress:bytesPerRow:releaseCallback:releaseContext:colorSpace:shouldColorMatch:</p>
</li>
<li><p>kCMSampleBufferConduitNotificationParameter_UpcomingOutputPTSRangeMayOverlapQueuedOutputPTSRange</p>
</li>
</ul>
<p>这个项目有一定的调侃意味，so what? 我选择swift🤣</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2019/01/01/2018-summary/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="zhangferry">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/zhangferry.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="zhangferry`s blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="zhangferry`s blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/01/01/2018-summary/" itemprop="url">
                  2018年总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-01-01T23:22:25+08:00">
                2019-01-01
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2019/01/01/2018-summary/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/01/01/2018-summary/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2019/01/01/2018-summary/" class="leancloud_visitors" data-flag-title="2018年总结">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">Visitors </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>写的有点晚了，因为一些事情耽搁，本来想干脆不写了。但有股力量不断催促着自己要写下来，于是就有了这篇文章。今年对我是意义重大的一年，从几个方面说吧，工作，生活和2019年的目标。</p>
</blockquote>
<h2 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h2><p><img src="https://user-gold-cdn.xitu.io/2019/1/6/16823bc1cd33e59c?w=1240&amp;h=827&amp;f=jpeg&amp;s=59357" alt="work.jpg"></p>
<p>3月底进了新公司，换工作主要原因是在之前的公司遇到了上升瓶颈，对当时的我来说一直待下去也无法看到清晰的未来。从新公司开始，今年变化了很多，也成长了不少。</p>
<h3 id="开发语言"><a href="#开发语言" class="headerlink" title="开发语言"></a>开发语言</h3><p>首先技术语言从OC转到了Swift，也是首次用Swift进行项目开发，并没有太大障碍。因为是经手新项目，所有也没有太多历史包袱（兼容OC），使用Swift+RxSwift+<a href="https://github.com/sergdort/CleanArchitectureRxSwift" target="_blank" rel="external">Clean architecture</a>的进行开发。我对Swift的感觉还是很好的，值得大家花时间去学去适应，毕竟Swfit代表着未来，是苹果推荐语言。<br>都9102年了，ABI稳定版Swift5.0马上就要来了，没有什么理由不使用它了，不是吗。</p>
<h3 id="开发工具"><a href="#开发工具" class="headerlink" title="开发工具"></a>开发工具</h3><p>一直都是使用MacBook Pro+Xcode的环境进行开发，之后使用fastlane进行打包，每次编译打包都将近40分钟。为了提高开发效率，开始考虑黑苹果方案。配置一台i7处理器+16G内存的台式机，4000左右，开始搞黑苹果。</p>
<p>附送一个教程<a href="https://www.tonymacx86.com/threads/unibeast-install-macos-sierra-on-any-supported-intel-based-pc.200564/" target="_blank" rel="external"><strong>传送门</strong></a>，以下是黑苹果配置：<br><img src="https://user-gold-cdn.xitu.io/2019/1/6/16823bc1cd42588f?w=586&amp;h=335&amp;f=png&amp;s=88723" alt="hackintosh.png"></p>
<p>有两个需要注意的地方：<br>1、显卡无法驱动。<br>使用免驱显卡。<br>当时装的时候Mojave版本还没有正式版，想升级时才发现macOS10.14及之后的版本将不再识别NVIDIA的显卡，除非换成AMD显卡，遂放弃升级。<br>2、网卡问题<br>可以在天猫购买一个支持黑苹果的网卡，收到货之后向店主要个网卡驱动，之后就能正常wifi上网啦。<br><img src="https://user-gold-cdn.xitu.io/2019/1/6/16823bc1cd56e94c?w=1240&amp;h=791&amp;f=png&amp;s=372767" alt="network card"></p>
<p>其他如蓝牙问题因为基本不用，没有搞，也可以使用黑苹果专用外设解决。</p>
<h3 id="博客"><a href="#博客" class="headerlink" title="博客"></a><a href="https://zhangferry.github.io/">博客</a></h3><p>2018年共写了12篇播放，看了下日期，第一篇是从7月份开始写的，也就是说这12篇都是后半年写出来的。</p>
<p>关于写博客这件事，之前是一直有种迷茫的状态，一查就懂的不想写，太复杂的又不愿花时间整理。后来慢慢不知怎么地就又找到了点感觉，其实也没有什么规律，只是写的时候不那么被动了。<br>之前博客都是发的<a href="https://www.jianshu.com/u/5a644cf7cd17" target="_blank" rel="external">简书</a>，后来觉得简书环境不太好了，不光是对程序员不友好了，简书整体也脱离了那种小清新的感觉，不知道从那个版本开始简书客户端UI突变，整个头条风，就不爱了。转到了<a href="https://juejin.im/user/5b0b99e8518825157b615922" target="_blank" rel="external">掘金</a>，不过之前的文章并没有搬运过来。</p>
<p>如果有留意我最近博客的话，可以看到我正在弄一个iOS月报的东西。这个想法的产生是因为，每隔一段时间都会积攒一些知识点，一些学习感悟，因为是零碎的东西，又不便于整合成一篇博客。后来关注到<a href="https://juejin.im/user/5a52075e6fb9a01c9d31b107" target="_blank" rel="external">老司机周报</a>、<a href="https://juejin.im/user/5a9a7c4ef265da239d48c115" target="_blank" rel="external">知识小集</a>、<a href="http://url.cn/5evuc7e" target="_blank" rel="external">阮一峰的网络日志</a>这几个栏目，收到启发，于是整合出iOS开发月报这种形式。毕竟一个月整理一次对我来说是一件可以做到的事。因为是一个人在做，每个月接触的东西也都会不一样，可能形式会有大大小小的差别。配图不好，语言不通顺也请大家多包涵，如果有什么意见或者好的内容可以给我推荐。我会持续努力的，争取做好这个栏目，给大家带来更多有质量的东西。</p>
<h2 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h2><p><img src="https://user-gold-cdn.xitu.io/2019/1/6/16823bc1cd2fb1e9?w=1240&amp;h=827&amp;f=jpeg&amp;s=123211" alt="life style.jpg"></p>
<h3 id="那些经历"><a href="#那些经历" class="headerlink" title="那些经历"></a>那些经历</h3><p>翻了下相册来给过去的一年做下汇总：</p>
<p>在17年的最后一天跟一个团体，参加跨年夜行活动，从奥林匹克公园走到天安门广场，看1月1号的升旗仪式。</p>
<p>1月份在中关村创业大街跟一个高中时的朋友一起去听了哈默的如何成为斜杆青年的讲座。</p>
<p>同样是一月开始追《海贼》，从第一话开始，一直都是看的漫画，到顶上战争知道这将是场精彩的对决，转为动漫，之后就一直是动漫了，目前看到大妈篇打卡二。</p>
<p>一月份还参加了极客公园创新大会，见到了傅盛、王小川、黎万强、李彦宏、罗振宇等一众大佬本人。</p>
<p>3月份裸辞，在家闲置了半个月。<br>跟女朋友从苹果园开始骑行，去了位于门头沟的京西古道。到了地方，视野所见游客不足十人，人家都快下班了，说要关门不推荐我们进去，于是歇了会就原路返回了。</p>
<p>4月份进了新公司。<br>第二次参加北京国际半程马拉松，提前一个月开始准备，期间每天早上两公里，周末五公里。成绩是2小时20分钟。</p>
<p>5月份跟女朋友去了青岛，当时天气还比较冷，只记得吃了两次九龙餐厅的饭，真香。</p>
<p>7月份跟女朋友去了秦皇岛的孤独图书馆，她预约了一个月才预约上。到了之后感觉一般，图书馆很小，书也不多，不让拍照。图书馆旁边是阿那亚教堂，也感觉一般吧，不推荐去。<br>还去了十渡，玩了玻璃栈道和漂流。这个非常推荐。</p>
<p>8月份对我来说是灾难性的，母亲被一场突如其来的疾病夺去了年轻的生命。我无助绝望过，一蹶不振过，也悲观厌世过，好在女朋友陪在身边，给了我足够的陪伴与安慰，才让我重新振作起来，真的非常感谢她。后来我不断的回忆与后悔，为什么没有坚持每年对父母做一个体检，我明明是知道的。<br>所以我也再次郑重建议大家，每年带父母至少体检一次，多陪陪他们，真的这没那么难。</p>
<p>之后的下半年除了跟我爸，我女朋友分别爬了两次香山，基本就没什么活动了。</p>
<h3 id="关于理财"><a href="#关于理财" class="headerlink" title="关于理财"></a>关于理财</h3><p>16年接触基金，17年开始定投，一开始对定投的理解就是分摊风险，比股票稳定，大概率会盈利。18年年初收益率达到15%时，当时定投已经达到我的设定预期。但我却仍坚定的相信，继续持有会获得更大收益。之后经历中美贸易战，股市重挫，之后持续的经济低迷，我都相信会涨回来，直到年末基金亏损达30%。我才意识到，当初自己那盲目的乐观是多么不正确。</p>
<p>后来听了一些大佬对19年经济形势的预测，大概率经济不会转好。所以基金定投这个事也会停止下来，这对我来说是一个教训，以后对理财会更加谨慎。</p>
<h3 id="关于阅读"><a href="#关于阅读" class="headerlink" title="关于阅读"></a>关于阅读</h3><p>今年阅读量比较小，就这几本：<br>《Objective-C高级编程》<br>《Swift面向协议编程》<br>《大话设计模式》<br>《人类群星闪耀时》<br>《巨人的陨落》<br>《精进》<br>《钝感力》<br>《把生命浪费在美好的事物上》<br>《你一定爱的欧洲极简史》</p>
<p>正在看的有：<br>《重构》<br>《未来简史》<br>《iOS逆向与安全》<br>计划要看的是：<br>《代码的未来》<br>《学习之道》<br>《老人与海》<br>《天才在左疯子在右》<br>《解忧杂货铺》<br>《怪诞行为学》<br>《百年孤独》<br>《菊与刀》</p>
<h2 id="2019年OKR"><a href="#2019年OKR" class="headerlink" title="2019年OKR"></a>2019年OKR</h2><p><img src="https://user-gold-cdn.xitu.io/2019/1/6/16823bc1cd5274cc?w=1240&amp;h=827&amp;f=jpeg&amp;s=111890" alt="tomorrow.jpg"></p>
<p>O1:精进技术栈<br>KR1:刷50道LeetCode题，写5篇左右博客总结解题思路。<br>KR2:做3个iOS、mac客户端的逆向。<br>KR3:翻译5篇Swift相关技术文章。<br>KR4:学习前端知识，给博客换个面貌。<br>KR5:开发一款微习惯的APP<br>KR6:博客输出24篇</p>
<p>O2:攒更多的钱<br>KR1:工资外收入达到1000<br>KR2:总收入达到买房需要的首付一半</p>
<p>O3:运动健身<br>KR1:半程马拉松跑到2小时以内<br>KR2:咕咚累积里程达到500公里</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/12/01/ios-monthly-11/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="zhangferry">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/zhangferry.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="zhangferry`s blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="zhangferry`s blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/12/01/ios-monthly-11/" itemprop="url">
                  iOS开发月报#5|201811
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-01T21:28:47+08:00">
                2018-12-01
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2018/12/01/ios-monthly-11/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/12/01/ios-monthly-11/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/12/01/ios-monthly-11/" class="leancloud_visitors" data-flag-title="iOS开发月报#5|201811">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">Visitors </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="大事件"><a href="#大事件" class="headerlink" title="大事件"></a>大事件</h2><p>11月27号，苹果AppStore下架包括拼多多、搜狗地图、讯飞阅读和悦跑圈在内的共718个App。据称下架原因是触发了AppStroe审核指南的2.5.2条例，即使用了热更新技术。去年6月份，苹果层因热更新下架数万款App。<br><img src="https://upload-images.jianshu.io/upload_images/1059465-14aacc2395523d81.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="C6D6A56886BF8346FA56A046C2BEE023.jpg"></p>
<h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><h3 id="图片渲染开销"><a href="#图片渲染开销" class="headerlink" title="图片渲染开销"></a>图片渲染开销</h3><p>我们知道，解压后的图片是由无数像素数据组成。每个像素点通常包括红、绿、蓝和 alpha 数据，每个值都是 8 位（0–255），因此一个像素通常会占用 4 个字节（32 bit per pixel。少数专业的 app 可能会用更大的空间来表示色深，消耗的内存会相应线性增加）。</p>
<p>下面我们来计算一些通常的图片开销：</p>
<p>普通图片大小，如 500 <em> 600 </em> 32bpp = 1MB<br>跟 iPhone X 屏幕一样大的：1125 <em> 2436 </em> 32bpp = 10MB<br>即刻中允许最大的图片，总像素不超过1500w：15000000 * 32bpp = 57MB<br>有了大致的概念，以后看到一张图能简单预估，大概会吃掉多少内存。</p>
<h3 id="关于iOS开发证书在钥匙串没有秘钥的问题"><a href="#关于iOS开发证书在钥匙串没有秘钥的问题" class="headerlink" title="关于iOS开发证书在钥匙串没有秘钥的问题"></a>关于iOS开发证书在钥匙串没有秘钥的问题</h3><p>当前现象<br><img src="https://upload-images.jianshu.io/upload_images/1059465-20f6c5844ca97977.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="D9E4F2DFEAAA7AB5D4CEC1A380A8221E.jpg"></p>
<p>只需要将证书拖到登录，即可生成秘钥<br><img src="https://upload-images.jianshu.io/upload_images/1059465-a0cd997865427e88.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="B91143F5C7B2BEA07FAF8849766D163E.jpg"></p>
<h3 id="APP内切换语言"><a href="#APP内切换语言" class="headerlink" title="APP内切换语言"></a>APP内切换语言</h3><p>APP内切换语言有一种比较简单的实现方式，实现步骤是：<br>1、存储语言状态<br>2、刷新<code>KeyWindow.rootViewController</code><br>3、刷新<code>Bundle</code><br>4、切换语言对应的更新操作<br>实现过程：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1、切换语言，AppleLanguages对应内容是数组，语言符合可以通过Bundle.main.localizations查看</span></div><div class="line"><span class="comment">//切换至繁体中文，存储状态</span></div><div class="line"><span class="type">UserDefaults</span>.standard.<span class="keyword">set</span>([<span class="string">"zh-Hant"</span>], forKey: <span class="string">"AppleLanguages"</span>)</div><div class="line"><span class="comment">//2、刷新keyWindow，createRootViewController为创建rootViewController的方法</span></div><div class="line"><span class="type">UIApplication</span>.shared.keyWindow?.rootViewController = <span class="type">Application</span>.shared.createRootViewController()</div><div class="line"></div><div class="line"><span class="comment">//3、更换bundle</span></div><div class="line"><span class="comment">//在切换语言的时候，我们需要执行一下，Bundle的exchangeBundle方法</span></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Bundle</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">getLocalizedBundle</span><span class="params">()</span></span> -&gt; <span class="type">Bundle</span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> languages = <span class="type">UserDefaults</span>.standard.object(forKey: <span class="string">"AppleLanguages"</span>) <span class="keyword">as</span>? [<span class="type">String</span>],</div><div class="line">                <span class="keyword">let</span> lan = languages.first,</div><div class="line">                <span class="keyword">let</span> path = <span class="type">Bundle</span>.main.path(forResource: lan, ofType: <span class="string">"lproj"</span>),</div><div class="line">                <span class="keyword">let</span> bundle = <span class="type">Bundle</span>.<span class="keyword">init</span>(path: path)&#123;</div><div class="line">                <span class="keyword">return</span> bundle</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="type">Bundle</span>.main</div><div class="line">            &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">exchangeBundle</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//替换Bundle.main为自定义的BundleLocal</span></div><div class="line">        object_setClass(<span class="type">Bundle</span>.main, <span class="type">BundleLocal</span>.<span class="keyword">self</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BundleLocal</span>: <span class="title">Bundle</span> </span>&#123;</div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">localizedString</span><span class="params">(forKey key: String, value: String?, table tableName: String?)</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">Bundle</span>.getLocalizedBundle().localizedString(forKey: key, value: value, table: tableName)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//4、其他更新操作，如接口，UI界面</span></div></pre></td></tr></table></figure></p>
<h3 id="测试内购时长"><a href="#测试内购时长" class="headerlink" title="测试内购时长"></a>测试内购时长</h3><p>当我们测试内购时，需要考虑内购到期的情况。比如我测试购买了一个月的服务，那么购买到期的情况呢，不能傻傻地等一个月时间吧？<br>其实苹果给出了不同内购时长在Debug情况下对应的测试时间。<br><img src="https://upload-images.jianshu.io/upload_images/1059465-259f75d94a813ac2.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="04DF44800E5F07286951E4BE11342A89.jpg"></p>
<h3 id="AVPlayer进入前台自动播放"><a href="#AVPlayer进入前台自动播放" class="headerlink" title="AVPlayer进入前台自动播放"></a>AVPlayer进入前台自动播放</h3><p>在我们不进行任何前后台设置的情况下，AVPlayer进入后台，会自动暂停播放。再次回到前台时，播放器会有一定概率自动恢复播放（多大概率未知，测试得出的结论）。</p>
<p>如果这个恢复播放不是我们需要的，或者我们需要避免这种不确定的情况发生，我们可以手动管理这个过程：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(forName: <span class="type">UIApplication</span>.didEnterBackgroundNotification, object: <span class="keyword">self</span>, queue: <span class="literal">nil</span>) &#123; (notification) <span class="keyword">in</span></div><div class="line">      <span class="keyword">self</span>.player.pause()</div><div class="line">&#125;</div><div class="line">        </div><div class="line"><span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(forName: <span class="type">UIApplication</span>.didEnterBackgroundNotification, object: <span class="keyword">self</span>, queue: <span class="literal">nil</span>) &#123; (notification) <span class="keyword">in</span></div><div class="line">    <span class="comment">//根据需要是否需要恢复播放</span></div><div class="line">    <span class="keyword">if</span> shouleRecoverPlayer &#123;</div><div class="line">        <span class="keyword">self</span>.player.play()</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">self</span>.player.pause()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="iOS12-1关于tabbar的一个bug"><a href="#iOS12-1关于tabbar的一个bug" class="headerlink" title="iOS12.1关于tabbar的一个bug"></a>iOS12.1关于tabbar的一个bug</h3><p><strong>触发条件：</strong></p>
<ul>
<li>使用 <code>UITabBarController</code> + <code>UINavigationController</code> 组合</li>
<li><code>UITabBar</code>带半透明效果，<code>isTranslucent</code> 属性为 true</li>
<li><code>UIViewController</code>的 <code>hidesBottomBarWhenPushed</code> 属性为 true</li>
<li>通过导航栏返回上一页时(导航栏返回按钮 or 屏幕左侧的滑动返回手势)</li>
</ul>
<p><strong>问题现象：</strong><br><img src="https://upload-images.jianshu.io/upload_images/1059465-01da29cdb1811251.gif?imageMogr2/auto-orient/strip" alt="20181112163203240.gif"></p>
<p>经确认是iOS12.1上的一个bug。<br><strong>解决方案：</strong><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//MARK: - fix ios12.1 tabbar bug</span></div><div class="line"><span class="keyword">let</span> tabbar = <span class="type">UITabBar</span>.appearance()</div><div class="line">tabbar.isTranslucent = <span class="literal">false</span></div></pre></td></tr></table></figure></p>
<p>详细内容可以参考：<br><a href="https://blog.csdn.net/ZHFDBK/article/details/83994088" target="_blank" rel="external">修复 iOS12.1 UITabBar 布局位移bug - ZHFDBK的博客 - CSDN博客</a><br><a href="https://stackoverflow.com/questions/53084806/uitabbar-items-jumping-on-back-navigation-on-ios-12-1" target="_blank" rel="external">swift - UITabBar items jumping on back navigation on iOS 12.1 - Stack Overflow</a></p>
<h2 id="推荐内容"><a href="#推荐内容" class="headerlink" title="推荐内容"></a>推荐内容</h2><h3 id="重构Swift中的Identifiers"><a href="#重构Swift中的Identifiers" class="headerlink" title="重构Swift中的Identifiers"></a><a href="https://medium.com/@vatsalrustagi/ios-refactoring-in-swift-identifiers-b14d9fff20c3" target="_blank" rel="external">重构Swift中的Identifiers</a></h3><p>面对越来越多的identifier，改如何优雅地处理？<br>文中讲了一些<code>UITableViewCell</code>、<code>UICollectionViewCell</code>、<code>segues</code>、<code>UIStoryboards</code>、<code>UIViewController</code>中关于identifiers的重构方法。</p>
<h3 id="The-End-Is-Near-for-Mobile-Apps"><a href="#The-End-Is-Near-for-Mobile-Apps" class="headerlink" title="The End Is Near for Mobile Apps"></a><a href="https://medium.com/s/story/mobile-apps-will-disappear-soon-4b4e54f46eb8" target="_blank" rel="external">The End Is Near for Mobile Apps</a></h3><p>移动应用的末日将要来临？<br>Medium科技板块最近比较火的一篇文章，分上下两篇，讲述移动应用的前景和趋势。</p>
<h3 id="Realm学院"><a href="#Realm学院" class="headerlink" title="Realm学院"></a><a href="https://academy.realm.io/cn/" target="_blank" rel="external">Realm学院</a></h3><p>这是Realm建立的一个用于学习编程技术的网站，主要方式是视频，内容配有字幕，并且都全部整理成文章。涵盖范围有<code>Realm</code>, <code>Android</code>, <code>iOS</code>, <code>JavaScript</code>, <code>Architecture</code>等。</p>
<p>文章质量非常高！</p>
<h2 id="开发利器"><a href="#开发利器" class="headerlink" title="开发利器"></a>开发利器</h2><h3 id="KTVHTTPCache"><a href="#KTVHTTPCache" class="headerlink" title="KTVHTTPCache"></a><a href="https://github.com/ChangbaDevs/KTVHTTPCache" target="_blank" rel="external">KTVHTTPCache</a></h3><p>应该是iOS端目前最好的流媒体缓存框架了。</p>
<h3 id="Realm"><a href="#Realm" class="headerlink" title="Realm"></a><a href="https://realm.io/" target="_blank" rel="external">Realm</a></h3><p>Realm是一个开源的对象数据库管理系统，最初用于移动(Android/iOS)，也可用于<code>Xamarin</code>或<code>React Native</code>等平台，等平台，包括桌面应用(Windows)，并获得<code>Apache</code>许可。</p>
<p>对比FMDB，他的使用成本，维护成本都更低。</p>
<h3 id="uTools"><a href="#uTools" class="headerlink" title="uTools"></a><a href="https://u.tools/" target="_blank" rel="external">uTools</a></h3><p>uTools是一个极简、插件化、跨平台的现代化桌面软件。通过自由选配丰富的插件，打造你得心应手的工具集合。<br>通过快捷键（默认alt+space）就可以快速呼出这个搜索框。它相当聪明，可以支持输入、拖拽、自动粘贴等作为输入源，相应的插件也早已准备就绪，统一的设计风格和操作方式，助你高效的得到正确的结果。<br>当你熟悉它后，能够为你节约大量时间，让你可以更加专注的改变世界。</p>
<p>对比Alfred，他的不同就在于免费，使用简单，更符合国人的习惯。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/10/31/201810-monthly/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="zhangferry">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/zhangferry.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="zhangferry`s blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="zhangferry`s blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/10/31/201810-monthly/" itemprop="url">
                  iOS开发月报#4|201810
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-31T16:00:50+08:00">
                2018-10-31
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2018/10/31/201810-monthly/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/10/31/201810-monthly/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/10/31/201810-monthly/" class="leancloud_visitors" data-flag-title="iOS开发月报#4|201810">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">Visitors </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>记录本月开发遇到的知识点，小tips，和bug总结。</p>
<h2 id="大事件"><a href="#大事件" class="headerlink" title="大事件"></a>大事件</h2><hr>
<p>新版iPad Pro、MacBook Air、Mac mini发布，全线涨价，但是真香。。。<br><img src="https://upload-images.jianshu.io/upload_images/1059465-d64ed4ef11a3ee86.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><hr>
<h3 id="适配swift4-2"><a href="#适配swift4-2" class="headerlink" title="适配swift4.2"></a>适配swift4.2</h3><p>1、利用xcode快速迁移<br>升级到Xcode10之后，我们打开项目会出现如下提示，<br><img src="https://upload-images.jianshu.io/upload_images/1059465-ac05882ccd098391.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>点击会有一个版本升级窗口，如果你的的项目包含一些第三方库的话，第三方库的选型也会出现在上面：<br><img src="https://upload-images.jianshu.io/upload_images/1059465-8041b545d62a3095.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>默认勾选第三方库，但是我们适配的时候不应该让Xcode去自动检索第三方库代码。只对我们的app进行代码迁移就够了。<br>适配完后可以在这里查看我们当前的swift版本：<br><img src="https://upload-images.jianshu.io/upload_images/1059465-6e113852a3fb4b35.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>对于第三方库，如果都适配了swift4.2，那么更新到对应版本就行了。如果有没适配的，可以通过制定版本的方式解决冲突，在Podfile文件末尾添加如下代码：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">post_install <span class="keyword">do</span> <span class="params">|installer|</span></div><div class="line">installer.pods_project.targets.each <span class="keyword">do</span> <span class="params">|target|</span></div><div class="line">target.build_configurations.each <span class="keyword">do</span> <span class="params">|config|</span></div><div class="line">config.build_settings[<span class="string">'SWIFT_VERSION'</span>] = <span class="string">'4.0'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="属性访问权限"><a href="#属性访问权限" class="headerlink" title="属性访问权限"></a>属性访问权限</h3><p>swift中提供的访问权限关键词由低到高有以下五种：<br>private &lt; fileprivate &lt; internal &lt; public &lt; open<br>其中internal是Swift中的默认控制级，一下介绍了这几种关键字的区别：</p>
<ul>
<li>private：当前作用域或者当前类中访问。</li>
<li>fileprivate：表示代码可以在当前文件中访问。</li>
<li>internal：在当前target中访问</li>
<li>public：可跨target使用，但不能被集成或者重写。</li>
<li>open：可跨target使用，允许被集成或者重写。</li>
</ul>
<p>对于一个严格的项目来说，精确的最小化访问控制级别对于代码的维护来说是很重要的。能用public的就别用open。</p>
<h3 id="修改文件权限"><a href="#修改文件权限" class="headerlink" title="修改文件权限"></a>修改文件权限</h3><p>当我们执行某些命令行操作，收到如下提示时：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Linking /usr/local/Cellar/the_silver_searcher/2.1.0... </div><div class="line">Error: Could not symlink etc/bash_completion.d/ag.bashcomp.sh</div><div class="line">/usr/local/etc/bash_completion.d is not writable.</div></pre></td></tr></table></figure></p>
<p>就表明我们对需要修改的文件权限不够，我们可以给文件加上修改的权限：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chown -R $(whoami) /usr/local/etc/bash_completion.d</div></pre></td></tr></table></figure></p>
<p>其中<code>-R</code>表示对目前目录下的所有文件与子目录进行相同的拥有者变更(即以递回的方式逐个变更)</p>
<h3 id="默认关键字"><a href="#默认关键字" class="headerlink" title="默认关键字"></a>默认关键字</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static let `default` = ImageCache(name: &quot;default&quot;)</div></pre></td></tr></table></figure>
<p>default是默认关键字，如果使用要加单斜号。</p>
<h3 id="tabbar手动跳转"><a href="#tabbar手动跳转" class="headerlink" title="tabbar手动跳转"></a>tabbar手动跳转</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">func tabBarController(UITabBarController, didSelect: UIViewController)</div></pre></td></tr></table></figure>
<blockquote>
<p>In iOS v3.0 and later, the tab bar controller calls this method regardless of whether the selected view controller changed. In addition, it is called only in response to user taps in the tab bar and is not called when your code changes the tab bar contents programmatically.<br>In versions of iOS prior to version 3.0, this method is called only when the selected view controller actually changes. In other words, it is not called when the same view controller is selected. In addition, the method was called for both programmatic and user-initiated changes to the selected view controller.</p>
</blockquote>
<p>tabbar的didSelect代理方法，只有在手动点击的时候才会触发。通过代码跳转是不会触发的。</p>
<h3 id="自定义tabbar动画"><a href="#自定义tabbar动画" class="headerlink" title="自定义tabbar动画"></a>自定义tabbar动画</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 当点击tabBar的时候,自动执行该代理方法(不需要手动设置代理)  </span></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tabBar</span><span class="params">(<span class="number">_</span> tabBar: UITabBar, didSelect item: UITabBarItem)</span></span> &#123;  </div><div class="line"><span class="keyword">for</span> view <span class="keyword">in</span> tabBar.subviews &#123;</div><div class="line"><span class="comment">//控制view实现各种动画效果</span></div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="NS-ASSUME-NONNULL-BEGIN-和-NS-ASSUME-NONNULL-END"><a href="#NS-ASSUME-NONNULL-BEGIN-和-NS-ASSUME-NONNULL-END" class="headerlink" title="NS_ASSUME_NONNULL_BEGIN 和 NS_ASSUME_NONNULL_END"></a>NS_ASSUME_NONNULL_BEGIN 和 NS_ASSUME_NONNULL_END</h3><p>从xcode6.3开始，为了能让OC也能表示swift的?(optional)和!功能，增加了对对象的可选指定。指定属性是否可选，可以：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@property (nonatomic, copy, nonnull) NSString * tickets;</div><div class="line">//或者</div><div class="line">@property (nonatomic, copy) NSString * __nonnull tickets;</div></pre></td></tr></table></figure></p>
<p>如果属性多了，每一个都这么写会很麻烦，苹果增加了一对新的宏命令，就是<code>NS_ASSUME_NONNULL_BEGIN</code>和<code>NS_ASSUME_NONNULL_END</code>。放在里面的对象就相当于都增加了<code>nonnull</code>命令，<code>nonull</code>为默认值。</p>
<h3 id="一个自定义collectionView布局的bug"><a href="#一个自定义collectionView布局的bug" class="headerlink" title="一个自定义collectionView布局的bug"></a>一个自定义collectionView布局的bug</h3><p><strong>bug描述：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">NSInternalInconsistencyException</div><div class="line"></div><div class="line">UICollectionView received layout attributes for a cell with an index path that does not exist: &lt;NSIndexPath: 0x280d2b200&gt; &#123;length = 2, path = 1 - 5&#125;</div></pre></td></tr></table></figure></p>
<p><strong>原因：</strong><br><code>layoutAttributesForElementsInRect</code>返回的<code>UICollectionViewLayoutAttributes</code>数组有<code>indexPath</code>没有被 <code>[NSIndexPath indexPathForRow:numberOfSection]</code>覆盖。<br>当数据量增加时不会出问题，当数量减少时出现。有人反映这是iOS10的bug，但实际上，我拿iOS10模拟器跑并没有问题，反而是在崩溃后台看到是iOS12的用户上报的。那究竟什么原因不详，附stackoverflow(<a href="https://stackoverflow.com/questions/39867325/ios-10-bug-uicollectionview-received-layout-attributes-for-a-cell-with-an-index" target="_blank" rel="external">iOS 10 bug: UICollectionView received layout attributes for a cell with an index path that does not exist - Stack Overflow</a>]地址。<br><strong>解决方案：</strong><br>当我们自定义layout时，需要清除UICollectionViewLayoutAttributes的缓存<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//方案一： 在自定义layout的类里</span></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">prepare</span><span class="params">()</span></span> &#123;</div><div class="line"><span class="keyword">super</span>.prepare()</div><div class="line">attributesArr.removeAll()</div><div class="line">&#125;</div><div class="line"><span class="comment">//方案二：在collectionview刷新出</span></div><div class="line">collectionView.reloaData()</div><div class="line">collectionView.collectionViewLayout.invalidateLayout()</div></pre></td></tr></table></figure></p>
<h3 id="配置git-SSH"><a href="#配置git-SSH" class="headerlink" title="配置git SSH"></a>配置git SSH</h3><p>1、设置git的user name和email<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git config --global user.name &quot;username&quot;</div><div class="line">$ git config --global user.email &quot;username@gmail.com&quot;</div></pre></td></tr></table></figure></p>
<p>2、生成秘钥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh-keygen -t rsa -C &quot;username@gmail.com&quot;</div></pre></td></tr></table></figure></p>
<p>如果不需要设置密码，连按三个回车。最后得到了两个文件：<code>id_rsa</code>和<code>id_rsa.pub</code>。<br>3、添加秘钥到ssh-agent中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh-add ~/.ssh/id_rsa</div></pre></td></tr></table></figure></p>
<p>4、登录git仓库（github或者bitbucket），添加ssh<br>将<code>id_rsa.pub</code>文件的内容复制到对应的地方。</p>
<h3 id="Apple-Watch开发注意事项"><a href="#Apple-Watch开发注意事项" class="headerlink" title="Apple Watch开发注意事项"></a>Apple Watch开发注意事项</h3><p>1、watch没有UIKit，对于UI的操作只能通过<code>storyboard</code>进行<br>2、watch只支持帧动画，我们只能通过png序列来实现动画效果。<code>WKInterfaceGroup</code> 和 <code>WKInterfaceImage</code>均可以实现帧动画。<br>3、开发的watch应用内存被限定为80M，太多帧的动画会不支持<br>4、提交应用watch也需要配置市场截图。<br>5、watch分为两个target。当新建一个Target为WatchDemo，xcode会自动生成一个WatchDemo Extension。前者负责UI，后者负责逻辑。引用cocoapods可以这么写：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">target &apos;WatchDemo Extension&apos; do</div><div class="line">platform :watchos, &apos;3.0&apos;</div><div class="line">use_frameworks!</div><div class="line">pod &apos;Alamofire&apos;</div><div class="line">end</div></pre></td></tr></table></figure></p>
<p>6、Always Embed Swift Standard Libraries<br>在Build Settings里面，这两个target，需要将WatchDemo Extension中设置为Yes，另一个设置为No</p>
<h2 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h2><hr>
<p><a href="https://github.com/marcosgriselli/Sizes" target="_blank" rel="external">Sizes</a><br>可以在一个界面，显示各个屏幕尺寸。这样我们就不用每个模拟器跑一遍看效果了。方便调试。</p>
<p><a href="https://github.com/iGhibli/iOS-DeviceSupport" target="_blank" rel="external">iOS-DeviceSupport</a><br>当手机升级，而xcode未升级时，我们会遇到Device Support的弹框，此时要么升级xcode，要么需要导入对应的Device Support文件。这个库就是提供这种文件的。</p>
<p><a href="https://github.com/johnno1962/InjectionIII" target="_blank" rel="external">InjectionIII</a><br>用于解决烦人的UI调试问题。当修改了一些UI属性之后，在xcode中我们只能运行程序才能看到效果，如果是处理大量的UI问题，这个过程是很烦人的。好在InjectionIII帮我们解决了这个问题，一起了解一下吧！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/09/30/monthly-201809/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="zhangferry">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/zhangferry.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="zhangferry`s blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="zhangferry`s blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/09/30/monthly-201809/" itemprop="url">
                  iOS开发月报#3|201809
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-30T18:48:02+08:00">
                2018-09-30
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2018/09/30/monthly-201809/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/09/30/monthly-201809/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/09/30/monthly-201809/" class="leancloud_visitors" data-flag-title="iOS开发月报#3|201809">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">Visitors </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://upload-images.jianshu.io/upload_images/1059465-2711b521a2b371fc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iPhoneX R"><br>新机发布，你中意XS Max还是XR？</p>
<h2 id="iOS-Tips"><a href="#iOS-Tips" class="headerlink" title="iOS Tips"></a>iOS Tips</h2><hr>
<h3 id="在label中插入图片"><a href="#在label中插入图片" class="headerlink" title="在label中插入图片"></a>在label中插入图片</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> label = <span class="type">UILabel</span>()</div><div class="line"><span class="keyword">let</span> attribute = <span class="type">NSMutableAttributedString</span>(string: <span class="string">"Title"</span>)</div><div class="line"></div><div class="line"><span class="keyword">let</span> imgAttch = <span class="type">NSTextAttachment</span>()</div><div class="line">imgAttch.image = image</div><div class="line"><span class="comment">//设置图片大小</span></div><div class="line">imgAttch.bounds = <span class="type">CGRect</span>.<span class="keyword">init</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">18</span>, height: <span class="number">15</span>)</div><div class="line"><span class="keyword">let</span> imageAttribute = <span class="type">NSAttributedString</span>(attachment: imgAttch)</div><div class="line"><span class="comment">//图片插入位置</span></div><div class="line">attribute.insert(imageAttribute, at: <span class="number">0</span>)</div><div class="line">label.attributedText = attribute</div></pre></td></tr></table></figure>
<h3 id="CollectionCell阴影-圆角的优雅处理方式"><a href="#CollectionCell阴影-圆角的优雅处理方式" class="headerlink" title="CollectionCell阴影+圆角的优雅处理方式"></a>CollectionCell阴影+圆角的优雅处理方式</h3><p>只针对类似App Store的整体圆角阴影的效果。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//设置父视图阴影效果</span></div><div class="line"><span class="comment">//CollectionView.swift</span></div><div class="line"><span class="keyword">self</span>.layer.shadowOffset = offset</div><div class="line"><span class="keyword">self</span>.layer.shadowColor = color.cgColor</div><div class="line"><span class="keyword">self</span>.layer.shadowRadius = radius</div><div class="line"><span class="keyword">self</span>.layer.shadowOpacity = opacity</div><div class="line">contentView.layer.cornerRadius = radius</div><div class="line"><span class="comment">//如果切割圆角带imageView才需要添加下面</span></div><div class="line">contentView.layer.masksToBounds = <span class="literal">true</span></div></pre></td></tr></table></figure></p>
<h3 id="处理tableView点击时label背景色消失问题"><a href="#处理tableView点击时label背景色消失问题" class="headerlink" title="处理tableView点击时label背景色消失问题"></a>处理tableView点击时label背景色消失问题</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//第一种方式，UITableViewCell.swift</span></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">setHighlighted</span><span class="params">(<span class="number">_</span> highlighted: Bool, animated: Bool)</span></span> &#123;</div><div class="line"><span class="keyword">let</span> color = <span class="keyword">self</span>.indexLabel.backgroundColor</div><div class="line"><span class="keyword">super</span>.setHighlighted(highlighted, animated: animated)</div><div class="line"><span class="keyword">self</span>.indexLabel.backgroundColor = color</div><div class="line">&#125;</div><div class="line"><span class="comment">//第二种方式</span></div><div class="line">cell.textLabel.backgroundColor = <span class="type">UIColor</span>.clear</div><div class="line">cell.textLabel.layer.backgroundColor = <span class="type">UIColor</span>.red</div></pre></td></tr></table></figure>
<h3 id="调整UILabel文字的内边距"><a href="#调整UILabel文字的内边距" class="headerlink" title="调整UILabel文字的内边距"></a>调整UILabel文字的内边距</h3><p>自定义<code>UILabel</code>，然后重写<code>drawText:</code>方法<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">drawText</span><span class="params">(<span class="keyword">in</span> rect: CGRect)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> insets = <span class="type">UIEdgeInsets</span>.<span class="keyword">init</span>(top: <span class="number">20</span>, <span class="keyword">left</span>: <span class="number">20</span>, bottom: <span class="number">20</span>, <span class="keyword">right</span>: <span class="number">20</span>)</div><div class="line">    <span class="keyword">super</span>.drawText(<span class="keyword">in</span>: <span class="type">UIEdgeInsetsInsetRect</span>(rect, insets))</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="swift-浮点数取整"><a href="#swift-浮点数取整" class="headerlink" title="swift 浮点数取整"></a>swift 浮点数取整</h3><p>ceil(x)返回不小于x的最小整数值。<br>floor(x)返回不大于x的最大整数值。<br>round(x)返回x的四舍五入整数值。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> number1 = <span class="number">12.456</span></div><div class="line"><span class="comment">// ceil(number1) = 13.0, floor(number1) = 12.0, round(number1) = 12.0</span></div><div class="line"><span class="keyword">let</span> number2 = <span class="number">12.756</span></div><div class="line"><span class="comment">// ceil(number2) = 13.0, floor(number2) = 12.0, round(number2) = 13.0</span></div></pre></td></tr></table></figure></p>
<h3 id="跳过非store下载的应用检查"><a href="#跳过非store下载的应用检查" class="headerlink" title="跳过非store下载的应用检查"></a>跳过非store下载的应用检查</h3><p>xattr -d com.apple.quarantine app所在路径</p>
<h3 id="加载大图导致内存暴涨"><a href="#加载大图导致内存暴涨" class="headerlink" title="加载大图导致内存暴涨"></a>加载大图导致内存暴涨</h3><p><code>large_leaves_70mp.jpg</code>图片是7033x10110(占用磁盘大小8.3MB)，分辨率 = 7033 x 10110 x 4（ARGB）,对应位图占用大小 = 分辨率 x 1024 x 1024 ( = 271MB)，解压会把图片转成位图，也就意味着会占用271MB内存，所以解压过程内存会瞬间消耗很大,等转成NSData后位图的内存就会被回收掉，内存就降下来，这时候NSData占用的大小即是图片的实际大小，该过程中由于会转成位图，而位图的大小是比图片的实际的大小大很多的，内存暴增的点就在位图。位图的内存大小计算是根据图片的分辨率而来（分辨率(width x heigth) x 1024 x 1024  x 4 (ARGB)），所以一般来说图片分辨率越高转成的位图占用的内存空间越大。</p>
<h3 id="新版iphone尺寸"><a href="#新版iphone尺寸" class="headerlink" title="新版iphone尺寸"></a>新版iphone尺寸</h3><table>
<thead>
<tr>
<th>设备</th>
<th>逻辑分辨率</th>
<th style="text-align:center">比例因子</th>
<th>对角线</th>
<th style="text-align:center">分辨率</th>
</tr>
</thead>
<tbody>
<tr>
<td>iPhone XS Max</td>
<td>414×896</td>
<td style="text-align:center">@3x</td>
<td>6.5inch</td>
<td style="text-align:center">1242px × 2688px</td>
</tr>
<tr>
<td>iPhone XS</td>
<td>375×812</td>
<td style="text-align:center">@3x</td>
<td>5.8inch</td>
<td style="text-align:center">1125px × 2436px</td>
</tr>
<tr>
<td>iPhone XR</td>
<td>414×896</td>
<td style="text-align:center">@2x</td>
<td>6.1inch</td>
<td style="text-align:center">828px × 1792px</td>
</tr>
<tr>
<td>iPhone X</td>
<td>375×812</td>
<td style="text-align:center">@3x</td>
<td>5.8inch</td>
<td style="text-align:center">1125px × 2436px</td>
</tr>
<tr>
<td>iPhone 8 Plus</td>
<td>414×736</td>
<td style="text-align:center">@3x</td>
<td>5.5inch</td>
<td style="text-align:center">1242px × 2208px</td>
</tr>
<tr>
<td>iPhone 8</td>
<td>375×667</td>
<td style="text-align:center">@3x</td>
<td>4.7inch</td>
<td style="text-align:center">750px × 1334px</td>
</tr>
<tr>
<td>iPhone SE</td>
<td>320×568</td>
<td style="text-align:center">@2x</td>
<td>4inch</td>
<td style="text-align:center">640px × 1136px</td>
</tr>
<tr>
<td>iPhone 4</td>
<td>320×480</td>
<td style="text-align:center">@2x</td>
<td>3.5inch</td>
<td style="text-align:center">640px × 960px</td>
</tr>
</tbody>
</table>
<h3 id="带透明度的渐变"><a href="#带透明度的渐变" class="headerlink" title="带透明度的渐变"></a>带透明度的渐变</h3><p>使用CAGradientLayer进行渐变的时候，如果我们需要由一个颜色渐变至透明，当我们将透明色写成<code>UIColor.clear</code>或者其他通过<code>RGBA</code>设置的颜色，改变透明度为0时，会发现实际效果跟预期有出入，会带点黑色：<br><img src="https://upload-images.jianshu.io/upload_images/1059465-5bf477719013367f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Transparent gradient.png"></p>
<p>这是因为clearColor会有一个透明度为0的黑色通道。所以应该这样设置透明色：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UIColor(white: 1, alpha: 0).cgColor</div></pre></td></tr></table></figure></p>
<h3 id="指定tableView，collectionView的header高度0"><a href="#指定tableView，collectionView的header高度0" class="headerlink" title="指定tableView，collectionView的header高度0"></a>指定tableView，collectionView的header高度0</h3><p>如果我们想隐藏<code>headerView</code>可能会直接在其高度的代理方法，做如下设置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">func tableView(_ tableView: UITableView, heightForHeaderInSection section: Int) -&gt; CGFloat &#123;</div><div class="line">return 0</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>当实际上这并不会生效，会返回一个默认高度。也就是说这个高度只有设置成一个非0的正数才是有效的。<br>有些人会写成0.01，表面上看是解决问题了，但0.01的偏移会造成像素不对齐（Color Misaligned Images），加重CPU计算负荷。完美的解决方案是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">func tableView(_ tableView: UITableView, heightForHeaderInSection section: Int) -&gt; CGFloat &#123;</div><div class="line">return CGFloat.leastNonzeroMagnitude</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>CGFloat.leastNonzeroMagnitude</code>表示CGFloat支持的最小正数值，不会引起像素偏移。</p>
<h3 id="保持屏幕常亮"><a href="#保持屏幕常亮" class="headerlink" title="保持屏幕常亮"></a>保持屏幕常亮</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//保持屏幕常亮</span></div><div class="line"><span class="type">UIApplication</span>.shared.isIdleTimerDisabled = <span class="literal">true</span></div><div class="line"><span class="comment">//关闭屏幕常亮</span></div><div class="line"><span class="type">UIApplication</span>.shared.isIdleTimerDisabled = <span class="literal">false</span></div></pre></td></tr></table></figure>
<p>注意：不要滥用屏幕常亮属性（苹果会因为这打回你的app），如果只在某些特殊场合需要屏幕常亮，应该在之后将该值恢复成默认值<code>false</code>。</p>
<h2 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h2><hr>
<h3 id="MMKV"><a href="#MMKV" class="headerlink" title="MMKV"></a><a href="https://github.com/Tencent/MMKV" target="_blank" rel="external">MMKV</a></h3><p>MMKV 是基于 mmap 内存映射的 key-value 组件，底层序列化/反序列化使用 protobuf 实现，性能高，稳定性强。从 2015 年中至今，在 iOS 微信上使用已有近 3 年，其性能和稳定性经过了时间的验证。近期也已移植到 Android 平台，一并开源。<br>替代<code>UserDefaults</code>的绝佳方案。</p>
<h3 id="Lottie"><a href="#Lottie" class="headerlink" title="Lottie"></a><a href="https://github.com/airbnb/lottie-ios" target="_blank" rel="external">Lottie</a></h3><p>Lottie是一个面向Android和iOS的移动库，它能够解析由AE在bodymovin导出为json的效果动画，并在移动端渲染矢量动画!<br>一些复杂的UI可以完全交给设计师了，哈哈哈。</p>
<h3 id="RSSHud"><a href="#RSSHud" class="headerlink" title="RSSHud"></a><a href="https://github.com/DIYgod/RSSHub" target="_blank" rel="external">RSSHud</a></h3><p>RSSHub 是一个轻量、易于扩展的 RSS 生成器，可以给任何奇奇怪怪的内容生成 RSS 订阅源。<br>结合<a href="https://itunes.apple.com/us/app/reeder-3/id697846300?mt=8" target="_blank" rel="external">Reeder</a>不要太爽哦。😆</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/09/19/git-baisc-command/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="zhangferry">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/zhangferry.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="zhangferry`s blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="zhangferry`s blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/09/19/git-baisc-command/" itemprop="url">
                  Git基本操作回顾
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-19T17:14:55+08:00">
                2018-09-19
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2018/09/19/git-baisc-command/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/09/19/git-baisc-command/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/09/19/git-baisc-command/" class="leancloud_visitors" data-flag-title="Git基本操作回顾">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">Visitors </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>作为git最常用的几个命令<code>git status</code>、<code>git add</code>、<code>git commit</code>，我们每天可能都会写个数十遍。但是越是这种我们熟悉的操作，越容易存在一些我们忽略的细节。这篇文章就是用来记录下这些细节，记录我们常用命令中不常用的操作。</p>
<p>在git中编辑过某些文件之后，由于自上次提交后你对它们做了修改，git 将它们标记为已修改文件。 我们逐步将这些修改过的文件放入暂存区，然后提交所有暂存了的修改，如此反复。所以使用 git 时文件的生命周期如下：<br><img src="https://upload-images.jianshu.io/upload_images/1059465-6aee09f81493701f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="lifecycle.png"></p>
<p>回顾完就进入正题</p>
<h2 id="git-status"><a href="#git-status" class="headerlink" title="git status"></a>git status</h2><p>git status会有以下几种状态<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ Changes to be committed:</div><div class="line">$ (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</div></pre></td></tr></table></figure></p>
<p>表示已经在暂存区，等待添加到工作区。使用<code>git reset</code>命令可以将暂存区的内容移除。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ Changes not staged for commit: </div><div class="line">$ (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</div><div class="line">$ (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</div></pre></td></tr></table></figure></p>
<p>有修改, 但是没有被添加到暂存区。使用<code>git add</code>命令可以将文件添加到暂存区，使用<code>git checkout</code>命令可以撤销文件修改。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ Untracked files:</div><div class="line">$ (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</div></pre></td></tr></table></figure></p>
<p>含有未跟踪文件, 即未纳入版本管理的文件。使用<code>git add</code>可以将文件放入暂存区。</p>
<hr>
<h2 id="git-add"><a href="#git-add" class="headerlink" title="git add"></a>git add</h2><p>添加文件到暂存区<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git add file</div></pre></td></tr></table></figure></p>
<p>添加多个文件到暂存区，空格隔开<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git add file1 file2</div></pre></td></tr></table></figure></p>
<p>使用通配符批量添加documentation目录下的所有txt后缀文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git add documentation/*.txt</div></pre></td></tr></table></figure></p>
<p>添加当前目录下的所有git-开头的shell文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git add git-*.sh</div></pre></td></tr></table></figure></p>
<p>将修改和以删除的文件添加到暂存区，不包括未被跟踪文件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git add -u file</div></pre></td></tr></table></figure></p>
<h3 id="git-add-和git-add-A-即git-add-–all-区别"><a href="#git-add-和git-add-A-即git-add-–all-区别" class="headerlink" title="git add .和git add -A(即git add –all)区别"></a>git add .和git add -A(即git add –all)区别</h3><p>一.版本导致的差别：<br>1.x版本：<br>（1）.git add -A可以提交未跟踪、修改和删除文件。<br>（2）.git add .可以提交未跟踪和修改文件，但是不处理删除文件。<br>2.x版本：<br>两者功能在提交类型方面是相同的。</p>
<p>二.所在目录不同导致的差异：<br>（1）.git add -A无论在哪个目录执行都会提交相应文件。<br>（2）.git add .只能够提交当前目录或者它后代目录下相应文件。</p>
<hr>
<h2 id="git-commit"><a href="#git-commit" class="headerlink" title="git commit"></a>git commit</h2><p>当我们执行<code>git add</code>命令将文件放到暂存区之后，还需要提交这些暂存到工作区（仓库区），从暂存区-&gt;工作区，的工作就是<code>git commmit</code>来做的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># 提交暂存区到仓库区，message为提交信息</div><div class="line">git commit -m [message]</div><div class="line"># 提交可以指定文件</div><div class="line">git commit [file1] [file2] ... -m [message]</div></pre></td></tr></table></figure></p>
<p>常用的commit扩展命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># 提交时显示所有diff信息</div><div class="line">git commit -v</div><div class="line"># 使用一次新的commit，替代上一次提交，如果代码没有任何新变化，则用来改写上一次commit的提交信息</div><div class="line">git commit --amend</div><div class="line"># 重做上一次commit，并包括指定文件的新变化</div><div class="line">git commit --amend [file1] [file2]</div></pre></td></tr></table></figure></p>
<p>以上三条如果不带-m [message]将会在vim的编辑器中添加提交信息。</p>
<p>如果你感觉没有<code>git add</code>,<code>git commit</code>有点麻烦，想直接将修改到工作区，可以用另外一个命令。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 会将上次commit之后的变化，直接添加到工作区</div><div class="line">git commit -a -m [message]</div></pre></td></tr></table></figure></p>
<hr>
<h2 id="git-rm"><a href="#git-rm" class="headerlink" title="git rm"></a>git rm</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rm file</div></pre></td></tr></table></figure>
<p><strong>删除位置</strong>：相当于手动右击点删除，只删除了工作区的文件。<br><strong>git status</strong>：<code>Changes not staged for commit:</code><br><strong>恢复</strong>：直接用git checkout – file就可以。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git rm file</div></pre></td></tr></table></figure></p>
<p>它等价于<code>rm file + git add file</code><br><strong>删除位置</strong>：相当于不仅删除了文件，而且还添加到了暂存区。<br><strong>git status</strong>：<code>Changes to be committed:</code>。<br><strong>恢复</strong>：先git reset，去掉暂存区修改，然后再git checkout – file，恢复文件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git rm --cached file</div></pre></td></tr></table></figure></p>
<p><strong>删除位置</strong>：从暂存区移除，不删除文件。<br><strong>git status</strong>：<code>Changes to be committed:</code>，<code>Untracked files:</code><br><strong>恢复</strong>：git add file</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/09/04/git-stash/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="zhangferry">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/zhangferry.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="zhangferry`s blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="zhangferry`s blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/09/04/git-stash/" itemprop="url">
                  使用git stash储存和恢复进度
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-04T14:53:34+08:00">
                2018-09-04
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2018/09/04/git-stash/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/09/04/git-stash/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/09/04/git-stash/" class="leancloud_visitors" data-flag-title="使用git stash储存和恢复进度">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">Visitors </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>当我们正在当前项目处理一些事情时，有一个需求插进来，使得我们要在别的分支做一些工作。切换分支之前当前任务是需要保存的，但我们并没有完成一个完整的任务，直接<code>commit</code>显得不合适，这时就可以使用<code>git stash</code>命令。stash是储藏的意思，该命令的作用也可以理解为先将当前的修改储藏起来，等我们在其他分支做完必要工作之后可以再回到储藏时的状态。</p>
<p><code>git stash</code>大致可以分为储存和恢复这两步。</p>
<h2 id="储存"><a href="#储存" class="headerlink" title="储存"></a>储存</h2><p>储藏当前进度有两条命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git stash</div></pre></td></tr></table></figure></p>
<p>保存当前工作进度，会把暂存区和工作区的改动都保存起来，再次运行<code>git status</code>会发现当前工作区是干净的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git stash save &quot;commit message&quot;</div></pre></td></tr></table></figure></p>
<p>是<code>git stash</code>的完整描述，可以为本次保存添加说明。</p>
<h2 id="恢复"><a href="#恢复" class="headerlink" title="恢复"></a>恢复</h2><figure class="highlight zsh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git stash list</div></pre></td></tr></table></figure>
<p>查看当前保存进度，进度保存可以有多个。<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git stash apply</div></pre></td></tr></table></figure></p>
<p>恢复最近保存的进度，不会删除stash内容<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git stash apply stash@&#123;0&#125;</div></pre></td></tr></table></figure></p>
<p>如果有多个stash，恢复某一个，按时间倒叙排列<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git stash pop</div></pre></td></tr></table></figure></p>
<p>会恢复最新保存的工作进度，并将恢复的工作进度从存储的工作进度列表中清除。<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git stash drop [stash_id]</div></pre></td></tr></table></figure></p>
<p>删除某一个存储的进度<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git stash clear <span class="comment">#删除所有储存进度</span></div></pre></td></tr></table></figure></p>
<p>删除所有存储进度</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/09/03/201808开发月报/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="zhangferry">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/zhangferry.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="zhangferry`s blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="zhangferry`s blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/09/03/201808开发月报/" itemprop="url">
                  iOS开发月报#2|201808
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-03T11:39:34+08:00">
                2018-09-03
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2018/09/03/201808开发月报/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/09/03/201808开发月报/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/09/03/201808开发月报/" class="leancloud_visitors" data-flag-title="iOS开发月报#2|201808">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">Visitors </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="数据库用完要close"><a href="#数据库用完要close" class="headerlink" title="数据库用完要close"></a>数据库用完要close</h2><p>当我们向下面这样执行完一次数据可查询时，要记得将数据库关闭，否则，如果此时想往同一数据库写东西的话会因为数据正在锁定收到这样的提示<code>database is locked</code>。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//获取下载完成的文件信息</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">isExistdWith</span><span class="params">(<span class="number">_</span> id: String)</span></span> -&gt; <span class="type">Bool</span>&#123;</div><div class="line"><span class="keyword">guard</span> db.open() <span class="keyword">else</span> &#123;</div><div class="line"><span class="keyword">return</span> <span class="literal">false</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">do</span> &#123;</div><div class="line"><span class="keyword">let</span> resultSet = <span class="keyword">try</span> db.executeQuery(<span class="string">"select * from tableName where id = ?"</span>, values: [id])</div><div class="line"><span class="keyword">if</span> resultSet.next() &#123;</div><div class="line"></div><div class="line"><span class="keyword">let</span> isCompleted = resultSet.bool(forColumn: <span class="keyword">self</span>.isCompleted)</div><div class="line">db.close()<span class="comment">//return之前要close数据库</span></div><div class="line"><span class="keyword">return</span> isCompleted</div><div class="line">&#125;</div><div class="line">&#125; <span class="keyword">catch</span> &#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line">db.close()<span class="comment">//return之前要close数据库</span></div><div class="line"><span class="keyword">return</span> <span class="literal">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="UIDatePicker的时间格式"><a href="#UIDatePicker的时间格式" class="headerlink" title="UIDatePicker的时间格式"></a>UIDatePicker的时间格式</h2><p>当我们用UIDatePicker做选择时间的控件时，DatePicker会根据手机时间的设置自动选择是12小时制还是24小时制，如果我们需要强制控制DatePicker是显示12小时制还是24小时制可以这么做：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">datePicker.datePickerMode = .time</div><div class="line">datePicker.locale = <span class="type">Locale</span>.<span class="keyword">init</span>(identifier: <span class="string">"en_GB"</span>)<span class="comment">//for 24 Hrs</span></div><div class="line">datePicker.locale = <span class="type">Locale</span>.<span class="keyword">init</span>(identifier: <span class="string">"en_US"</span>)<span class="comment">//for 12 Hrs</span></div></pre></td></tr></table></figure></p>
<h2 id="iOS-skill-map"><a href="#iOS-skill-map" class="headerlink" title="iOS skill map"></a>iOS skill map</h2><p><img src="http://upload-images.jianshu.io/upload_images/1059465-3576096c29667cf8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS技能图谱"></p>
<h2 id="变量对外只读，对内可读写"><a href="#变量对外只读，对内可读写" class="headerlink" title="变量对外只读，对内可读写"></a>变量对外只读，对内可读写</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span> </span>&#123;</div><div class="line"><span class="keyword">private</span>(<span class="keyword">set</span>) <span class="keyword">var</span> name : <span class="type">String</span>!</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="设置UITableViewCell分割线对齐"><a href="#设置UITableViewCell分割线对齐" class="headerlink" title="设置UITableViewCell分割线对齐"></a>设置UITableViewCell分割线对齐</h2><p>默认的cell分割线都是偏向右边多一些的，如果我们想让分割线对齐的话，正确的做法是：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tableView.separatorInset = <span class="type">UIEdgeInsets</span>.<span class="keyword">init</span>(top: <span class="number">0</span>, <span class="keyword">left</span>: <span class="number">40</span>, bottom: <span class="number">0</span>, <span class="keyword">right</span>: <span class="number">40</span>)</div></pre></td></tr></table></figure></p>
<p>设置左右边距都是40<br>但是使用这种方法会带来一个问题就是默认的textLabel会跟着右移。为了保持label的居中我们可以再加一句：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tableView.separatorInset = <span class="type">UIEdgeInsets</span>.<span class="keyword">init</span>(top: <span class="number">0</span>, <span class="keyword">left</span>: <span class="number">40</span>, bottom: <span class="number">0</span>, <span class="keyword">right</span>: <span class="number">40</span>)</div><div class="line">tableView.layoutMargins = <span class="type">UIEdgeInsets</span>.<span class="keyword">init</span>(top: <span class="number">0</span>, <span class="keyword">left</span>: <span class="number">40</span>, bottom: <span class="number">0</span>, <span class="keyword">right</span>: <span class="number">40</span>)</div></pre></td></tr></table></figure></p>
<h2 id="富文本显示图片元素"><a href="#富文本显示图片元素" class="headerlink" title="富文本显示图片元素"></a>富文本显示图片元素</h2><p>如果我们需要文字中插入图片元素时，可以使用富文本处理：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> attch = <span class="type">NSTextAttachment</span>()</div><div class="line">attch.image = <span class="type">UIImage</span>.(named:<span class="string">"logo"</span>)</div><div class="line">attch.bounds = <span class="type">CGRect</span>.<span class="keyword">init</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">18</span>, height: <span class="number">18</span>)</div><div class="line"><span class="keyword">let</span> imageAttribute = <span class="type">NSAttributedString</span>(attachment: attch)</div><div class="line">titleLabel.attributedText = attributed</div></pre></td></tr></table></figure></p>
<h2 id="添加spotlight搜索索引"><a href="#添加spotlight搜索索引" class="headerlink" title="添加spotlight搜索索引"></a>添加spotlight搜索索引</h2><p>首先导入<code>CoreSpotlight</code>和<code>MobileCoreServices</code>框架，然后加入以下代码：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> searchableItems = [<span class="type">CSSearchableItem</span>]()</div><div class="line"><span class="comment">//索引项</span></div><div class="line"><span class="keyword">let</span> attributeSet = <span class="type">CSSearchableItemAttributeSet</span>(itemContentType: kUTTypeData <span class="keyword">as</span> <span class="type">String</span>)</div><div class="line"><span class="comment">//title</span></div><div class="line">attributeSet.title = <span class="string">"Item Title"</span></div><div class="line"><span class="comment">//desription</span></div><div class="line">attributeSet.contentDescription = <span class="string">"match.description"</span></div><div class="line"><span class="comment">//thumb</span></div><div class="line">attributeSet.thumbnailData = <span class="keyword">try</span>? <span class="type">Data</span>.<span class="keyword">init</span>(contentsOf: <span class="type">URL</span>(string: url)!)</div><div class="line"><span class="comment">//keywords</span></div><div class="line">attributeSet.keywords = [<span class="string">"Love"</span>, <span class="string">"Peace"</span>]</div><div class="line"><span class="keyword">let</span> searchableItem = <span class="type">CSSearchableItem</span>(uniqueIdentifier: <span class="string">"app_keywords"</span>, domainIdentifier: <span class="string">"com.company.app"</span>, attributeSet: attributeSet)</div><div class="line">searchableItems.append(searchableItem)</div><div class="line"><span class="comment">//建立索引            </span></div><div class="line"><span class="type">CSSearchableIndex</span>.<span class="keyword">default</span>().indexSearchableItems(searchableItems) &#123; (error) -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line"><span class="keyword">if</span> error != <span class="literal">nil</span> &#123;</div><div class="line"><span class="built_in">print</span>(error?.localizedDescription ?? <span class="string">"Error"</span>)</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Hexo编译问题"><a href="#Hexo编译问题" class="headerlink" title="Hexo编译问题"></a>Hexo编译问题</h2><p>在执行<code>hexo g</code>编译markdown文件时莫名报错：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TypeError: Cannot set property &apos;lastIndex&apos; of undefined</div></pre></td></tr></table></figure></p>
<p>解决方案是在_config.yml中将<code>auto_detect</code>设为<code>false</code></p>
<h2 id="Podfile用法"><a href="#Podfile用法" class="headerlink" title="Podfile用法"></a>Podfile用法</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 下面两行是指明依赖库的来源地址</span></div><div class="line">source <span class="string">'https://github.com/CocoaPods/Specs.git'</span></div><div class="line">source <span class="string">'https://github.com/Artsy/Specs.git'</span></div><div class="line"></div><div class="line"><span class="comment"># 说明平台是ios，版本是8.0</span></div><div class="line">platform <span class="symbol">:ios</span>, <span class="string">'8.0'</span></div><div class="line"></div><div class="line"><span class="comment"># 忽略引入库的所有警告（强迫症者的福音啊）</span></div><div class="line">inhibit_all_warnings!</div><div class="line"></div><div class="line"><span class="comment"># 生成的是framework而不是静态库</span></div><div class="line">use_frameworks!</div><div class="line"></div><div class="line"><span class="comment"># 针对MyApp target引入AFNetworking</span></div><div class="line"><span class="comment"># 针对MyAppTests target引入OCMock，</span></div><div class="line">target <span class="string">'MyApp'</span> <span class="keyword">do</span> </div><div class="line">pod <span class="string">'AFNetworking'</span>, <span class="string">'~&gt; 3.0'</span> </div><div class="line">target <span class="string">'MyAppTests'</span> <span class="keyword">do</span></div><div class="line">inherit! <span class="symbol">:search_paths</span> </div><div class="line">pod <span class="string">'OCMock'</span>, <span class="string">'~&gt; 2.0.1'</span> </div><div class="line"><span class="keyword">end</span></div><div class="line">pod <span class="string">'JSONKit'</span>, <span class="symbol">:podspec</span> =&gt; <span class="string">'https://example.com/JSONKit.podspec'</span></div><div class="line"><span class="comment"># 引入内部库</span></div><div class="line">pod <span class="string">'ABTest'</span>, <span class="symbol">:git</span> =&gt; <span class="string">'https://bitbucket.org/sealcn/remoteabtest.git'</span></div><div class="line">pod <span class="string">'ABTest'</span>, <span class="symbol">:git</span> =&gt; <span class="string">'https://bitbucket.org/sealcn/remoteabtest.git'</span>, <span class="symbol">:tag=&gt;</span> <span class="string">'0.0.6'</span></div><div class="line">pod <span class="string">'ABTest'</span>, <span class="symbol">:git</span> =&gt; <span class="string">'https://bitbucket.org/sealcn/remoteabtest.git'</span>, <span class="symbol">:commit=&gt;</span> <span class="string">'082f8319af'</span></div><div class="line"><span class="comment"># 编译配置，指定仅在Debug模式下启用</span></div><div class="line">pod <span class="string">'Reveal-SDK'</span>, <span class="symbol">:configurations</span> =&gt; [<span class="string">'Debug'</span>]</div><div class="line"><span class="comment"># 使用本地文件</span></div><div class="line">pod <span class="string">'AFNetworking'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'~/Documents/AFNetworking'</span></div><div class="line"><span class="comment"># 指定版本号0.1.3到0.2，不包括0.2</span></div><div class="line">pod <span class="string">'CHIPageControl'</span>, <span class="string">'~&gt; 0.1.3'</span></div><div class="line"><span class="comment"># 仅安装QueryKit下的Attribute和QuerySet模块</span></div><div class="line">pod <span class="string">'QueryKit'</span>, <span class="symbol">:subspecs</span> =&gt; [<span class="string">'Attribute'</span>, <span class="string">'QuerySet'</span>]</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="comment"># 这个是cocoapods的一些配置,官网并没有太详细的说明,一般采取默认就好了,也就是不写.</span></div><div class="line">post_install <span class="keyword">do</span> <span class="params">|installer|</span>       </div><div class="line">installer.pods_project.targets.each <span class="keyword">do</span> <span class="params">|target|</span> </div><div class="line">puts target.name </div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/zhangferry.png"
               alt="zhangferry" />
          <p class="site-author-name" itemprop="name">zhangferry</p>
          <p class="site-description motion-element" itemprop="description">只有频率相同的人，才能看见彼此内心深处不为人知的优雅。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">21</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">categories</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/zhangferry" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/2947186387/profile?topnav=1&wvr=6&is_all=1" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhangferry</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"zhangferry"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("DuOwsJ3GAgOVpEsgoXwPefXF-gzGzoHsz", "e7aUnrStHzmE0hGJXLsLxHpk");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


</body>
</html>
