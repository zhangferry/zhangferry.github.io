<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=6.7.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.7.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.ico?v=6.7.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.7.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.7.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.7.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
<meta property="og:type" content="website">
<meta property="og:title" content="zhangferry">
<meta property="og:url" content="http://zhangferry.github.io/page/2/index.html">
<meta property="og:site_name" content="zhangferry">
<meta property="og:description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="zhangferry">
<meta name="twitter:description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">



  <link rel="alternate" href="/atom.xml" title="zhangferry" type="application/atom+xml">




  <link rel="canonical" href="http://zhangferry.github.io/page/2/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>zhangferry</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?afe60f79e35ee3c65b92d9a2ff459653";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zhangferry</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">10</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">31</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/09/19/git_command/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhangferry">
      <meta itemprop="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhangferry">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/09/19/git_command/" class="post-title-link" itemprop="url">Git基本操作回顾</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-09-19 17:14:55" itemprop="dateCreated datePublished" datetime="2018-09-19T17:14:55+08:00">2018-09-19</time>
            

            
          </span>

          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">2.1k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">2 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>作为git最常用的几个命令<code>git status</code>、<code>git add</code>、<code>git commit</code>，我们每天可能都会写个数十遍。但是越是这种我们熟悉的操作，越容易存在一些我们忽略的细节。这篇文章就是用来记录下这些细节，记录我们常用命令中不常用的操作。</p>
<p>在git中编辑过某些文件之后，由于自上次提交后你对它们做了修改，git 将它们标记为已修改文件。 我们逐步将这些修改过的文件放入暂存区，然后提交所有暂存了的修改，如此反复。所以使用 git 时文件的生命周期如下：<br><img src="https://upload-images.jianshu.io/upload_images/1059465-6aee09f81493701f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="lifecycle.png"></p>
<p>回顾完就进入正题<br>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/09/19/git_command/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </p></div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/09/04/git_stash/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhangferry">
      <meta itemprop="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhangferry">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/09/04/git_stash/" class="post-title-link" itemprop="url">使用git stash储存和恢复进度</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-09-04 14:53:34" itemprop="dateCreated datePublished" datetime="2018-09-04T14:53:34+08:00">2018-09-04</time>
            

            
          </span>

          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">609</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">1 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>当我们正在当前项目处理一些事情时，有一个需求插进来，使得我们要在别的分支做一些工作。切换分支之前当前任务是需要保存的，但我们并没有完成一个完整的任务，直接<code>commit</code>显得不合适，这时就可以使用<code>git stash</code>命令。stash是储藏的意思，该命令的作用也可以理解为先将当前的修改储藏起来，等我们在其他分支做完必要工作之后可以再回到储藏时的状态。</p>
<p><code>git stash</code>大致可以分为储存和恢复这两步。<br>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/09/04/git_stash/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </p></div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/09/03/monthly_2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhangferry">
      <meta itemprop="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhangferry">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/09/03/monthly_2/" class="post-title-link" itemprop="url">iOS开发月报#2|201808</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-09-03 11:39:34" itemprop="dateCreated datePublished" datetime="2018-09-03T11:39:34+08:00">2018-09-03</time>
            

            
          </span>

          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">3.8k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">3 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="数据库用完要close"><a href="#数据库用完要close" class="headerlink" title="数据库用完要close"></a>数据库用完要close</h2><p>当我们向下面这样执行完一次数据可查询时，要记得将数据库关闭，否则，如果此时想往同一数据库写东西的话会因为数据正在锁定收到这样的提示<code>database is locked</code>。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取下载完成的文件信息</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isExistdWith</span><span class="params">(<span class="number">_</span> id: String)</span></span> -&gt; <span class="type">Bool</span>&#123;</span><br><span class="line"><span class="keyword">guard</span> db.<span class="keyword">open</span>() <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line"><span class="keyword">let</span> resultSet = <span class="keyword">try</span> db.executeQuery(<span class="string">"select * from tableName where id = ?"</span>, values: [id])</span><br><span class="line"><span class="keyword">if</span> resultSet.next() &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> isCompleted = resultSet.bool(forColumn: <span class="keyword">self</span>.isCompleted)</span><br><span class="line">db.close()<span class="comment">//return之前要close数据库</span></span><br><span class="line"><span class="keyword">return</span> isCompleted</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">db.close()<span class="comment">//return之前要close数据库</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/09/03/monthly_2/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/09/02/jingjin-read-summary/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhangferry">
      <meta itemprop="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhangferry">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/09/02/jingjin-read-summary/" class="post-title-link" itemprop="url">《精进》阅后总结</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-09-02 23:20:33" itemprop="dateCreated datePublished" datetime="2018-09-02T23:20:33+08:00">2018-09-02</time>
            

            
          </span>

          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">2.4k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">2 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><img src="https://upload-images.jianshu.io/upload_images/1059465-6b6566e95596f8a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="精进.png"></p>
<p>最近刚看完采铜的这本《精进-如何成为一个很厉害的人》，一本很值得推荐的书。这种讲述如何学习，如何自我提升的书很容易一不小心写成空洞的心灵鸡汤。然而我在实际阅读中根本没有这种想法，因为它专业性很强，我感受到的是作者的博学和诚意，还有经常性的好像被点拨了一下的惊喜。没有深入的思考和深厚的学术功底是写不出这种书，推荐大家有机会也仔细地读一读。<br>阅读过程中画了很多自己受启发的观点，也可以说是我读到的这本书中的精华部分，摘录了下来。全书分七个章节，逐一讲述如何成为一个很厉害的人：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1059465-53a1ff8e7834d421.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/09/02/jingjin-read-summary/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </p></div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/08/30/private-Cocoapods/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhangferry">
      <meta itemprop="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhangferry">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/08/30/private-Cocoapods/" class="post-title-link" itemprop="url">使用Cocoapods管理私有库组件</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-08-30 14:47:34" itemprop="dateCreated datePublished" datetime="2018-08-30T14:47:34+08:00">2018-08-30</time>
            

            
          </span>

          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">8.2k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">7 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><img src="https://upload-images.jianshu.io/upload_images/1059465-ab8debcc283dcc57.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="cocoapods.png"></p>
<p>CocoaPods是OS X和iOS下的一个第三方开源类库管理工具，通过CocoaPods工具我们可以为项目添加依赖库（这些类库必须是CocoaPods本身所支持的），并且可以轻松管理其版本。它是目前iOS开发中使用最广泛的开源库管理工具，如果我们内部协作的组件化能够使用这种方式管理的话，那将是很便利的。<br>在通过Cocoapods建立内部私有库之前，我们需要再熟悉下Cocoapods的工作流程，我们创建内部私有库时也会依照这个流程来。<br>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/08/30/private-Cocoapods/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </p></div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/08/09/skill-map/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhangferry">
      <meta itemprop="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhangferry">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/08/09/skill-map/" class="post-title-link" itemprop="url">iOS技能图谱</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-08-09 14:47:34" itemprop="dateCreated datePublished" datetime="2018-08-09T14:47:34+08:00">2018-08-09</time>
            

            
          </span>

          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">50</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">1 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>结合目前遇到过的一些技术点和唐巧的<a href="https://gist.github.com/tangqiaoboy/5fadd9ba398277680b87" target="_blank" rel="noopener">iOS技能图谱</a>产出的这个综合版的iOS技能图谱，供大家参考交流：<br><img src="https://ws1.sinaimg.cn/large/0069RVTdgy1fu22z7y8dzj31kw29le2m.jpg" alt="iOS技能图谱"></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/08/06/201807-summary/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhangferry">
      <meta itemprop="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhangferry">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/08/06/201807-summary/" class="post-title-link" itemprop="url">2018年七月</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-08-06 11:28:09" itemprop="dateCreated datePublished" datetime="2018-08-06T11:28:09+08:00">2018-08-06</time>
            

            
          </span>

          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">1.4k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">1 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><img src="https://upload-images.jianshu.io/upload_images/1059465-64df1811bbc768eb.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="十渡"></p>
<p>虽然一直都有想要保持写日记的习惯，但是对于我这种上班时间不稳定切偏晚，经常11点12点才能离开公司的人，就更难了。但如果不写点什么，总感觉这段时间就丢失了，往会看的时候会产生一种失落感。于是找到一种折中的方案，索性把时间跨度拉大一点，一个月写一篇总结。东西就放在简书上，会和博客同步。不管产出的东西多少，希望这个习惯能尽可能长的保持下去。<br>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/08/06/201807-summary/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </p></div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/08/02/monthly_1/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhangferry">
      <meta itemprop="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhangferry">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/08/02/monthly_1/" class="post-title-link" itemprop="url">iOS开发月报#1|201807</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-08-02 14:22:32" itemprop="dateCreated datePublished" datetime="2018-08-02T14:22:32+08:00">2018-08-02</time>
            

            
          </span>

          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">3.6k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">3 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="关闭隐式动画"><a href="#关闭隐式动画" class="headerlink" title="关闭隐式动画"></a>关闭隐式动画</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">CATransaction</span>.begin()</span><br><span class="line"><span class="type">CATransaction</span>.setDisableActions(<span class="literal">true</span>)</span><br><span class="line"><span class="keyword">self</span>.layer.frame = <span class="keyword">self</span>.bounds</span><br><span class="line"><span class="type">CATransaction</span>.commit()</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/08/02/monthly_1/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2018/07/17/UIButton-detail/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhangferry">
      <meta itemprop="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhangferry">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/07/17/UIButton-detail/" class="post-title-link" itemprop="url">可能被忽略的UIButton细节</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-17 10:55:35" itemprop="dateCreated datePublished" datetime="2018-07-17T10:55:35+08:00">2018-07-17</time>
            

            
          </span>

          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">2.5k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">2 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="关于System-Button"><a href="#关于System-Button" class="headerlink" title="关于System Button"></a>关于System Button</h2><hr>
<p>看一个简单的例子：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">button.setTitle(<span class="string">"Title"</span>, <span class="keyword">for</span>: .normal)</span><br><span class="line">button.setImage(<span class="type">UIImage</span>(named: <span class="string">"icon"</span>), <span class="keyword">for</span>: .normal)</span><br></pre></td></tr></table></figure></p>
<p>buttonType分别设置为system和custom，仅做如上设置，显示效果对比（上面的custom，下面的是system）</p>
<p><div align="center"><br><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1ftcrof65cij305x00xa9u.jpg" alt="button_normal"><br><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1ftcrokww28j305x010q2r.jpg" alt="button_system"><br></div><br>system Button显示出蓝色其实是tintColor的效果，关于tintColor的说法是：<br>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/07/17/UIButton-detail/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </p></div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhangferry.github.io/2017/08/25/avplayer-detail-1/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhangferry">
      <meta itemprop="description" content="只有频率相同的人，才能看见彼此内心深处不为人知的优雅。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhangferry">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/08/25/avplayer-detail-1/" class="post-title-link" itemprop="url">AVPlayer详解系列（一）参数设置</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-08-25 16:27:50" itemprop="dateCreated datePublished" datetime="2017-08-25T16:27:50+08:00">2017-08-25</time>
            

            
          </span>

          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">7.8k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">7 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>最近工作内容基本都是围绕视频播放展开的，从AVPlayer到IJKPlayer，期间遇到挺多问题，趟了很多bug，也总结了一些心得。对AVPlayer了解的更多一些，因为涉及点比较多，所以打算做一个系列详尽的写一下这部分内容。希望大家多多支持，有问题的地方欢迎指正。</p>
</blockquote>
<p>##思维导图<br>先来一张思维导图，作为这篇文章的目录索引：<br><img src="http://upload-images.jianshu.io/upload_images/1059465-d8f55f8bd9368182.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="AVPlayer.png"></p>
<h2 id="为什么使用AVPlayer："><a href="#为什么使用AVPlayer：" class="headerlink" title="为什么使用AVPlayer："></a>为什么使用AVPlayer：</h2><p>首先在iOS平台使用播放视频，可用的选项一般有这四个，他们各自的作用和功能如下：</p>
<table>
<thead>
<tr>
<th></th>
<th>使用环境</th>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody>
<tr>
<td>MPMoviePlayerController</td>
<td>MediaPlayer</td>
<td>简单易用</td>
<td>不可定制</td>
</tr>
<tr>
<td>AVPlayerViewController</td>
<td>AVKit</td>
<td>简单易用</td>
<td>不可定制</td>
</tr>
<tr>
<td>AVPlayer</td>
<td>AVFoundation</td>
<td>可定制度高，功能强大</td>
<td>不支持流媒体</td>
</tr>
<tr>
<td>IJKPlayer</td>
<td>IJKMediaFramework</td>
<td>定制度高，支持流媒体播放</td>
<td>使用稍复杂</td>
</tr>
</tbody>
</table>
<p>由此可以看出，如果我们不做直播功能<a href="https://developer.apple.com/documentation/avfoundation/avplayer" target="_blank" rel="noopener">AVPlayer</a>就是一个最优的选择。</p>
<p>另外AVPlayer是一个可以播放任何格式的全功能影音播放器<br><del>支持视频格式： WMV，AVI，MKV，RMVB，RM，XVID，MP4，3GP，MPG等。</del><br><del>支持音频格式：MP3，WMA，RM，ACC，OGG，APE，FLAC，FLV等。</del><br>支持视频格式： MP4，MOV，M4V，3GP，AVI等。<br>支持音频格式：MP3，AAC，WAV，AMR，M4A等。<br>详见<a href="https://www.jianshu.com/p/7373f07f1cbf" target="_blank" rel="noopener">AVPlayer支持的视频格式</a></p>
<p>##如何使用<br>AVPlayer存在于AVFoundation框架，我们使用时需要导入：<br><code>#import &lt;AVFoundation/AVFoundation.h&gt;</code></p>
<p>###几个播放相关的参数<br>在创建一个播放器之前我们需要先了解一些播放器相关的类</p>
<ul>
<li>AVPlayer：控制播放器的播放，暂停，播放速度</li>
<li>AVURLAsset : AVAsset 的一个子类，使用 URL 进行实例化，实例化对象包换 URL 对应视频资源的所有信息。</li>
<li>AVPlayerItem：管理资源对象，提供播放数据源</li>
<li>AVPlayerLayer：负责显示视频，如果没有添加该类，只有声音没有画面</li>
</ul>
<p>我们这片文章就围绕这几个参数展开，光说这些你可能还有点不明白，那我们就围绕一个最简单的播放器做起，一点点扩展功能，在具体讲解这几个参数的作用。</p>
<p>###最简单的播放器<br>根据上面描述，我们知道<code>AVPlayer</code>是播放的必要条件，所以我们可以构建的极简播放器就是：</p>
<pre><code>NSURL *playUrl = [NSURL URLWithString:@&quot;http://baobab.wdjcdn.com/14573563182394.mp4&quot;];
self.player = [[AVPlayer alloc] initWithURL:playUrl];
[self.player play];
</code></pre><p>是不是很简单，只有三行代码！<br>但是它太简单了，仅可以完成音频的播放，连画面都没有。回看上面播放相关类的介绍，是因为缺少<code>AVPlayerLayer</code>；作为一个播放器，我不能只播放一条视频啊，我还想根据需要切换视频，那我们就得把<code>AVPlayerItem</code>也加上。<br>加上这两个属性之后的播放器是这样的：</p>
<pre><code>NSURL *playUrl = [NSURL URLWithString:@&quot;http://baobab.wdjcdn.com/14573563182394.mp4&quot;];
self.playerItem = [AVPlayerItem playerItemWithURL:playUrl];
//如果要切换视频需要调AVPlayer的replaceCurrentItemWithPlayerItem:方法
self.player = [AVPlayer playerWithPlayerItem:_playerItem];
self.playerLayer = [AVPlayerLayer playerLayerWithPlayer:self.player];
self.playerLayer.frame = _videoView.bounds;
//放置播放器的视图
[self.videoView.layer addSublayer:self.playerLayer];
[_player play];
</code></pre><p>现在的播放器稍微完整了一些，我们在自己创建的容器里可以看到画面了！</p>
<p>##更多功能<br>但是它作为一个视频播放器，还是有很多不能让人满意的地方。例如：没有暂停、快进快退、倍速播放等，另外如果遇到url错误是不是还要有播放失败的提示，还有播放完成的相关提示。<br>为完成这些，我们需要对<code>AVPlayerItem</code>和<code>AVPlayerLayer</code>进一步了解一下。</p>
<p>###一、AVPlayer的控制<br>前面讲过该类是控制视频播放行为的，他的使用比较简单。<br>播放视频：</p>
<pre><code>[self.player play];
</code></pre><p>暂停视频：</p>
<pre><code>[self.player pause];
</code></pre><p>更改速度：</p>
<pre><code>self.player.rate = 1.5;//注意更改播放速度要在视频开始播放之后才会生效
</code></pre><p>还有一下其他的控制，我们可以调转到系统API进行查看</p>
<p>###二、AVPlayerItem的控制<br>AVPlayerItem作为资源管理对象，它控制着视频从创建到销毁的诸多状态。</p>
<h4 id="1、播放状态-status"><a href="#1、播放状态-status" class="headerlink" title="1、播放状态 status"></a>1、播放状态 status</h4><pre><code>typedef NS_ENUM(NSInteger, AVPlayerItemStatus) {
    AVPlayerItemStatusUnknown,//未知
    AVPlayerItemStatusReadyToPlay,//准备播放
    AVPlayerItemStatusFailed//播放失败
};
</code></pre><p>我们使用KVO监测playItem.status，可以获取播放状态的变化</p>
<pre><code>[self.playerItem addObserver:self forKeyPath:@&quot;status&quot; options:NSKeyValueObservingOptionNew context:nil];
</code></pre><p>在监听回调中：</p>
<pre><code>- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context{

if ([object isKindOfClass:[AVPlayerItem class]]) {
    if ([keyPath isEqualToString:@&quot;status&quot;]) {
        switch (_playerItem.status) {
            case AVPlayerItemStatusReadyToPlay:
                //推荐将视频播放放在这里
                [self play];
                break;

            case AVPlayerItemStatusUnknown:
                NSLog(@&quot;AVPlayerItemStatusUnknown&quot;);
                break;

            case AVPlayerItemStatusFailed:
                NSLog(@&quot;AVPlayerItemStatusFailed&quot;)
                break;

            default:
                break;
        }

    }
}
</code></pre><p>虽然设置完播放配置我们可以直接调用<code>[self.player play];</code>进行播放，但是更稳妥的方法是在回调收到<code>AVPlayerItemStatusReadyToPlay</code>时进行播放</p>
<p>####2、视频的时间信息<br>在AVPlayer中时间的表示有一个专门的结构体CMTime</p>
<pre><code>typedef struct{
    CMTimeValue    value;     // 帧数
    CMTimeScale    timescale;  // 帧率（影片每秒有几帧）
    CMTimeFlags    flags;        
    CMTimeEpoch    epoch;    
} CMTime;
</code></pre><p>CMTime是以分数的形式表示时间，value表示分子，timescale表示分母，flags是位掩码，表示时间的指定状态。</p>
<p>获取当前播放时间，可以用value/timescale的方式：</p>
<pre><code>float currentTime = self.playItem.currentTime.value/item.currentTime.timescale;
</code></pre><p>还有一种利用系统提供的方法，我们用它获取视频总时间：</p>
<pre><code>float totalTime   = CMTimeGetSeconds(item.duration);
</code></pre><p>如果我们想要添加一个计时的标签不断更新当前的播放进度，有一个系统的方法：</p>
<pre><code>- (id)addPeriodicTimeObserverForInterval:(CMTime)interval queue:(nullable dispatch_queue_t)queue usingBlock:(void (^)(CMTime time))block;
</code></pre><p>方法名如其意， “添加周期时间观察者” ，参数1 interal 为CMTime 类型的，参数2 queue为串行队列，如果传入NULL就是默认主线程，参数3 为CMTime 的block类型。<br>简而言之就是，每隔一段时间后执行 block。<br>比如：我们把interval设置成CMTimeMake(1, 10)，在block里面刷新label，就是一秒钟刷新10次。</p>
<p>正常观察播放进度一秒钟一次就行了，所以可以这么写：</p>
<pre><code>[self.player addPeriodicTimeObserverForInterval:CMTimeMake(1, 1) queue:nil usingBlock:^(CMTime time) {

    AVPlayerItem *item = WeakSelf.playerItem;
    NSInteger currentTime = item.currentTime.value/item.currentTime.timescale;
    NSLog(@&quot;当前播放时间：%ld&quot;,currentTime);
}];
</code></pre><p>####3、loadedTimeRange  缓存时间<br>获取视频的缓存情况我们需要监听playerItem的loadedTimeRanges属性</p>
<pre><code>[self.playerItem addObserver:self forKeyPath:@&quot;loadedTimeRanges&quot; options:NSKeyValueObservingOptionNew context:nil];
</code></pre><p>在KVO的回调里:</p>
<pre><code>if ([keyPath isEqualToString:@&quot;loadedTimeRanges&quot;]){
    NSArray *array = _playerItem.loadedTimeRanges;
    CMTimeRange timeRange = [array.firstObject CMTimeRangeValue];//本次缓冲时间范围
    float startSeconds = CMTimeGetSeconds(timeRange.start);
    float durationSeconds = CMTimeGetSeconds(timeRange.duration);
    NSTimeInterval totalBuffer = startSeconds + durationSeconds;//缓冲总长度
    NSLog(@&quot;当前缓冲时间：%f&quot;,totalBuffer);
}
</code></pre><p>####4、playbackBufferEmpty<br>监听<code>playbackBufferEmpty</code>我们可以获取当缓存不够，视频加载不出来的情况：</p>
<pre><code>[self.playerItem addObserver:self forKeyPath:@&quot;playbackBufferEmpty&quot; options:NSKeyValueObservingOptionNew context:nil]; 
</code></pre><p>在KVO回调里：</p>
<pre><code>if ([keyPath isEqualToString:@&quot;playbackBufferEmpty&quot;]) {

    //some code show loading   
}
</code></pre><p>####5、playbackLikelyToKeepUp<br><code>playbackLikelyToKeepUp</code>和<code>playbackBufferEmpty</code>是一对，用于监听缓存足够播放的状态</p>
<pre><code>[self.playerItem addObserver:self forKeyPath:@&quot;playbackLikelyToKeepUp&quot; options:NSKeyValueObservingOptionNew context:nil];
/* ... */
if([keyPath isEqualToString:@&quot;playbackLikelyToKeepUp&quot;]) {    
    //由于 AVPlayer 缓存不足就会自动暂停，所以缓存充足了需要手动播放，才能继续播放  
    [_player play];      
}
</code></pre><p>###AVURLAsset<br>播放视频只需一个url就能进行这样太不安全了，别人可以轻易的抓包盗链，为此我们需要为视频链接做一个请求头的认证，这个功能可以借助AVURLAsset完成。</p>
<p><code>AVPlayerItem</code>除了可以用URL初始化，还可以用<code>AVAsset</code>初始化，而<code>AVAsset</code>不能直接使用，我们看下<code>AVURLAsset</code>的一个初始化方法：</p>
<pre><code>/*!
@param        URL
            An instance of NSURL that references a media resource.
@param        options
            An instance of NSDictionary that contains keys for specifying options for the initialization of the AVURLAsset. See AVURLAssetPreferPreciseDurationAndTimingKey and AVURLAssetReferenceRestrictionsKey above.
*/
+ (instancetype)URLAssetWithURL:(NSURL *)URL options:(nullable NSDictionary&lt;NSString *, id&gt; *)options;
</code></pre><p><code>AVURLAssetPreferPreciseDurationAndTimingKey.</code>这个key对应的value是一个布尔值, 用来表明资源是否需要为时长的精确展示,以及随机时间内容的读取进行提前准备。</p>
<p>除了这个苹果官方介绍的功能外，他还可以设置请求头，这个算是隐藏功能了，因为苹果并没有明说这个功能，我是费了很大劲找到的。</p>
<pre><code>NSMutableDictionary * headers = [NSMutableDictionary dictionary];
[headers setObject:@&quot;yourHeader&quot;forKey:@&quot;User-Agent&quot;];
self.urlAsset = [AVURLAsset   URLAssetWithURL:self.videoURL options:@{@&quot;AVURLAssetHTTPHeaderFieldsKey&quot; : headers}];
// 初始化playerItem
self.playerItem = [AVPlayerItem playerItemWithAsset:self.urlAsset];
</code></pre><p>补充：后来得知这个参数是非公开的API，但是经多人测试项目上线不受影响。</p>
<p>###播放相关通知</p>
<p>####1、声音类：</p>
<pre><code>//声音被打断的通知（电话打来）
AVAudioSessionInterruptionNotification
//耳机插入和拔出的通知
AVAudioSessionRouteChangeNotification
</code></pre><p>根据userInfo判断具体状态</p>
<p>####2、播放类</p>
<pre><code>//播放完成
AVPlayerItemDidPlayToEndTimeNotification
//播放失败
AVPlayerItemFailedToPlayToEndTimeNotification
//异常中断
AVPlayerItemPlaybackStalledNotification
</code></pre><p>对于播放完成的通知我们可以这么写：</p>
<pre><code>[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(playerMovieFinish:) name:AVPlayerItemDidPlayToEndTimeNotification object:[self.player currentItem]];
</code></pre><p>####3、系统状态<br>    //进入后台<br>    UIApplicationWillResignActiveNotification<br>    //返回前台<br>    UIApplicationDidBecomeActiveNotification<br><strong>提示：所有通知和KVO的使用我们都要记得在不用时remove掉。</strong></p>
<p>##小结</p>
<p>视频播放相关的知识比较多，细节的方面需要一点一点去扣。暂且写这么多吧，以后有需要会及时补充。<br><strong>参考：</strong><br><a href="https://github.com/renzifeng/ZFPlayer" target="_blank" rel="noopener">ZFPlayer</a><br><a href="http://liunan.me/2017/01/30/avplayer" target="_blank" rel="noopener">AVPlayer那些坑</a><br>如果还有什么不理解的可以简书私信问我，或者查看我写的<a href="https://github.com/zhangferry/FYPlayer" target="_blank" rel="noopener">Demo</a>，欢迎star- ( ゜- ゜)つロ乾杯~</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="zhangferry">
            
              <p class="site-author-name" itemprop="name">zhangferry</p>
              <p class="site-description motion-element" itemprop="description">只有频率相同的人，才能看见彼此内心深处不为人知的优雅。</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">31</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">4</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">10</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/zhangferry" title="GitHub &rarr; https://github.com/zhangferry" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://weibo.com/2947186387/profile" title="Weibo &rarr; https://weibo.com/2947186387/profile" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhangferry</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="站点总字数">134k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="站点阅读时长">2:02</span>
  
</div>









        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=6.7.0"></script>

  <script src="/js/src/motion.js?v=6.7.0"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=6.7.0"></script>




  

  


  <script src="/js/src/bootstrap.js?v=6.7.0"></script>



  



  





  

  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  

  

  

  

  

  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function(i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap');
      $(e).after($wrap);
      $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
        var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
          return $(e).text();
        }).toArray().join('\n');
        var ta = document.createElement('textarea');
        var range = document.createRange(); //For Chrome
        var sel = window.getSelection(); //For Chrome
        var yPosition = window.pageYOffset || document.documentElement.scrollTop;
        ta.style.top = yPosition + 'px'; //Prevent page scroll
        ta.style.position = 'absolute';
        ta.style.opacity = '0';
        ta.value = code;
        ta.textContent = code; //For FireFox
        ta.contentEditable = true;
        ta.readOnly = false;
        document.body.appendChild(ta);
        range.selectNode(ta);
        sel.removeAllRanges();
        sel.addRange(range);
        ta.setSelectionRange(0, code.length);
        var result = document.execCommand('copy');
        
          if (result) $(this).text('复制成功');
          else $(this).text('复制失败');
        
        ta.blur(); //For iOS
        $(this).blur();
      })).on('mouseleave', function(e) {
        var $b = $(this).find('.copy-btn');
        setTimeout(function() {
          $b.text('复制');
        }, 300);
      }).append(e);
    })
  </script>


  

</body>
</html>
